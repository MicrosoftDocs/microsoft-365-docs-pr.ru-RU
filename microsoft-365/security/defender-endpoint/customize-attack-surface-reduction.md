---
title: Настройка правил сокращения направлений атак
description: Индивидуально устанавливайте правила в режимах аудита, блокировки или отключения, добавляйте файлы и папки, которые следует исключить из правил уменьшения поверхности атаки
keywords: Уменьшение поверхности атаки, бедра, система предотвращения вторжения на хост, правила защиты, антиэкспозиция, антиэкспплойт, эксплойт, профилактика инфекции, настройка, настройка, исключение
search.product: eADQiWindows 10XVcnh
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
localization_priority: Normal
audience: ITPro
author: denisebmsft
ms.author: deniseb
ms.reviewer: ''
manager: dansimp
ms.technology: mde
ms.topic: article
ms.openlocfilehash: 6b9814180df2cad2553c4565ebb65891b5cf9bf5
ms.sourcegitcommit: 34c06715e036255faa75c66ebf95c12a85f8ef42
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2021
ms.locfileid: "52985424"
---
# <a name="customize-attack-surface-reduction-rules"></a>Настройка правил сокращения направлений атак

**Область применения:**

- [Microsoft Defender для конечной точки](https://go.microsoft.com/fwlink/p/?linkid=2154037)
- [Microsoft 365 Defender](https://go.microsoft.com/fwlink/?linkid=2118804)

>Хотите испытать Defender для конечной точки? [Зарегистрився для бесплатной пробной.](https://www.microsoft.com/microsoft-365/windows/microsoft-defender-atp?ocid=docs-wdatp-assignaccess-abovefoldlink)

> [!IMPORTANT]
> Некоторые сведения относятся к предварительным выпускам продуктов, которые могут быть существенно изменены до коммерческого выпуска. Корпорация Майкрософт не дает никаких гарантий, явных или подразумеваемых, относительно предоставленных здесь сведений.

[Правила уменьшения поверхности атаки](enable-attack-surface-reduction.md) помогают предотвратить поведение программного обеспечения, которое часто используется для компрометации устройства или сети. Например, злоумышленник может попытаться запустить неподписавший сценарий с USB-диска или иметь макрос в документе, Office сделать вызовы непосредственно в API Win32. Правила уменьшения поверхности атаки могут ограничить такие рискованные действия и улучшить защитную позицию организации.

Узнайте, как настроить правила уменьшения [](#exclude-files-and-folders) поверхности атаки, [](#customize-the-notification) исключив файлы и папки или добавив настраиваемый текст в оповещение, которое отображается на компьютере пользователя.

Вы можете установить правила уменьшения поверхности атаки для устройств, работающих с любыми из следующих выпусков и версий Windows:

- Windows 10 Pro версии [1709](/windows/whats-new/whats-new-windows-10-version-1709) или более поздней версии
- Windows 10 Корпоративная версии [1709](/windows/whats-new/whats-new-windows-10-version-1709) или более поздней версии
- Windows Сервер, [версия 1803 (полугодовой канал)](/windows-server/get-started/whats-new-in-windows-server-1803) или более поздний
- [Windows Server 2019](/windows-server/get-started-19/whats-new-19) Для настройки этих параметров можно использовать поставщики услуг групповой политики, PowerShell и Службы управления мобильными устройствами (MDM).

## <a name="exclude-files-and-folders"></a>Исключение файлов и папок

Вы можете исключить оценку файлов и папок правилами уменьшения поверхности атаки. При исключении файл не будет заблокирован, даже если правило уменьшения поверхности атаки обнаруживает, что файл содержит вредоносное поведение.

Например, рассмотрим правило вымогателей:

Правило вымогателей предназначено для того, чтобы помочь корпоративным клиентам снизить риски атак вымогателей, обеспечивая непрерывность бизнеса. По умолчанию ошибки правила вымогателей на стороне осторожности и защиты от файлов, которые еще не достигли достаточной репутации и доверия. Чтобы вновь скомфицировать, правило вымогателей запускает только файлы, которые не получили достаточно положительной репутации и распространенности, на основе показателей использования миллионов наших клиентов. Обычно блоки решаются самостоятельно, так как значения "репутации и доверия" каждого файла постепенно обновляются по мере увеличения использования без проблем.

В случаях, когда блоки не решаются своевременно, клиенты  могут на свой собственный риск использовать либо механизм самообслужировки, либо возможность "разрешить список" на основе индикатора компрометации (МОК) для разблокирования самих файлов.  

> [!WARNING]
> Исключение или разблокировка файлов или папок потенциально может позволить небезопасным файлам запускать и заражать устройства. Исключение файлов или папок может значительно снизить защиту, предоставляемую правилами сокращения направлений атак. Файлы, заблокированные правилом, будут разрешены к запуску, и отчет или событие не будут записываться.

Исключение применяется ко всем правилам, допускающим эти исключения. Можно указать отдельный файл, путь папки или полное доменное имя для ресурса. Однако нельзя ограничить исключение определенным правилом.

Исключение применяется только при старте исключенного приложения или службы. Например, если добавлено исключение для уже запущенной службы обновления, служба обновления будет продолжать запускать события до тех пор, пока служба не будет остановлена и перезапущена.

Уменьшение поверхности атаки поддерживает переменные среды и подкарды. Сведения об использовании поддиальдов см. в материалах использования подкардов в списке имен файлов и папок [или списках исключений расширения.](configure-extension-file-exclusions-microsoft-defender-antivirus.md#use-wildcards-in-the-file-name-and-folder-path-or-extension-exclusion-lists)
Если возникают проблемы с обнаружением файлов правил, которые, по вашим мнению, не следует обнаруживать, используйте режим аудита для [проверки правила.](evaluate-attack-surface-reduction.md)

| Описание правила | GUID |
|:----|:----|
| Блокировка всех Office приложений от создания детских процессов | `D4F940AB-401B-4EFC-AADC-AD5F3C50688A` |
| Блокировка выполнения потенциально запутаных скриптов | `5BEB7EFE-FD9A-4556-801D-275E5FFC04CC` |
| Блоки вызовов API Win32 Office макроса | `92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B` |
| Блокировка Office приложений от создания исполняемого контента | `3B576869-A4EC-4529-8536-B80A7769E899` |
| Блокировка Office приложений от внесения кода в другие процессы | `75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84` |
| Блокировка JavaScript или VBScript от запуска загружаемого исполняемого контента | `D3E037E1-3EB8-44C8-A917-57927947596D` |
| Блокировка исполняемого контента из клиента электронной почты и веб-почты | `BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550` |
| Блокировать выполнение файлов, если они не соответствуют критериям распространенности, возраста или доверенного списка | `01443614-cd74-433a-b99e-2ecdc07bfc25` |
| Используйте расширенные средства защиты от программ-вымогателей | `c1db55ab-c21a-4637-bb3f-a12568109d35` |
| Блокировка кражи учетных данных из Windows локальной подсистемы органов безопасности (lsass.exe) | `9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2` |
| Блокировка создания процессов, происходящих из команд PSExec и WMI | `d1e49aac-8f56-4280-b9ba-993a6d77406c` |
| Блокировка ненарушимых и неподписаных процессов, которые запускают из USB | `b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4` |
| Блокировка Office приложений связи от создания детских процессов | `26190899-1602-49e8-8b27-eb1d0a1ce869` |
| Блокировка Adobe Reader от создания детских процессов | `7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c` |
| Блокировка сохраняемости с помощью подписки на события WMI | `e6db77e5-3df2-4cf1-b95a-636979351e5b` |

Подробные [сведения](attack-surface-reduction.md) о каждом правиле см. в разделе уменьшение поверхности атаки.

### <a name="use-group-policy-to-exclude-files-and-folders"></a>Использование групповой политики для исключения файлов и папок

1. Для этого на компьютере, управляющем групповыми политиками, откройте [Консоль управления групповой политикой](https://technet.microsoft.com/library/cc731212.aspx), щелкните правой кнопкой мыши нужный объект групповой политики и выберите **Изменить**.

2. В **редакторе управления групповой политикой** перейдите к **конфигурации компьютера** и щелкните **административные шаблоны**.

3. Расширь **дерево, Windows компоненты антивирусная программа в Microsoft Defender** Защитник Windows с уменьшением поверхности  >    >  **exploit**  >  **Guard Attack.**

4. Дважды нажмите кнопку **Исключить файлы и пути** из параметра Правила уменьшения поверхности атаки и установите параметр **Включено**. Выберите **Показать и** ввести каждый файл или папку в столбце Имя **значения.** Введите **0** в **столбце Значение** для каждого элемента.

> [!WARNING]
> Не используйте кавычка, так как они не поддерживаются ни для столбца **value name,** ни для **столбца Value.**

### <a name="use-powershell-to-exclude-files-and-folders"></a>Использование PowerShell для исключения файлов и папок

1. Введите **powershell** в меню , щелкните правой кнопкой **мыши Windows PowerShell** выберите Выполнить в **качестве администратора**
2. Введите следующий cmdlet:

    ```PowerShell
    Add-MpPreference -AttackSurfaceReductionOnlyExclusions "<fully qualified path or resource>"
    ```

Продолжайте использовать `Add-MpPreference -AttackSurfaceReductionOnlyExclusions` для добавления дополнительных папок в список.

> [!IMPORTANT]
> Используйте `Add-MpPreference` для добавления или добавления приложений в список. С помощью `Set-MpPreference` этого комлета будет переописывать существующий список.

### <a name="use-mdm-csps-to-exclude-files-and-folders"></a>Использование CSPs MDM для исключения файлов и папок

Для добавления исключений используйте поставщика служб конфигурации [./Vendor/MSFT/Policy/Config/Defender/AttackSurfaceReductionOnlyExclusions.](/windows/client-management/mdm/policy-csp-defender#defender-attacksurfacereductiononlyexclusions)

## <a name="customize-the-notification"></a>Настройка уведомления

Вы можете настроить уведомление о срабатывке правила и блокировке приложения или файла. См. [статью Безопасность Windows.](/windows/security/threat-protection/windows-defender-security-center/windows-defender-security-center#customize-notifications-from-the-windows-defender-security-center)

## <a name="related-topics"></a>Статьи по теме

- [Уменьшение поверхностей атаки с помощью правил уменьшения поверхности атаки](attack-surface-reduction.md)
- [Включить правила сокращения направлений атак](enable-attack-surface-reduction.md)
- [Оценка правил сокращения направлений атак](evaluate-attack-surface-reduction.md)
- [Сокращение направлений атак: вопросы и ответы](attack-surface-reduction.md)
