---
title: Устранение проблем с правилами уменьшения поверхности атаки
description: Ресурсы и пример кода для устранения неполадок с правилами уменьшения поверхности атаки в Microsoft Defender для конечной точки.
keywords: устранение неполадок, ошибка, исправление, защитник Windows, например, asr, правила, бедра, устранение неполадок, аудит, исключение, ложное срабатывательство, нарушение, блокировка, защитник Майкрософт для конечной точки, защита от угроз microsoft defender
search.product: eADQiWindows 10XVcnh
ms.pagetype: security
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
localization_priority: Normal
audience: ITPro
author: denisebmsft
ms.author: deniseb
ms.date: 03/27/2019
ms.reviewer: ''
manager: dansimp
ms.custom: asr
ms.technology: mde
ms.topic: how-to
ms.openlocfilehash: d483c098f221e2d4d2e61a10393154b8f5d1498d
ms.sourcegitcommit: dcb97fbfdae52960ae62b6faa707a05358193ed5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2021
ms.locfileid: "51198745"
---
# <a name="troubleshoot-attack-surface-reduction-rules"></a>Правила устранения неполадок в области уменьшения поверхности атаки

[!INCLUDE [Microsoft 365 Defender rebranding](../../includes/microsoft-defender.md)]


**Область применения:**
- [Microsoft Defender для конечной точки](https://go.microsoft.com/fwlink/p/?linkid=2154037)
- [Microsoft 365 Defender](https://go.microsoft.com/fwlink/?linkid=2118804)

> Хотите испытать Defender для конечной точки? [Зарегистрився для бесплатной пробной.](https://www.microsoft.com/microsoft-365/windows/microsoft-defender-atp?ocid=docs-wdatp-pullalerts-abovefoldlink) 


При использовании [правил уменьшения поверхности](attack-surface-reduction.md) атаки могут возникнуть проблемы, такие как:

- Правило блокирует файл, обработку или выполняет другие действия, которые не должны выполняться (ложное срабатыва-

- Правило не работает так, как описано, или не блокирует файл или процесс, который он должен (ложный отрицательный)

Для устранения этих проблем необходимо четыре шага:

1. [Подтверждение необходимых условий](#confirm-prerequisites)

2. [Чтобы проверить правило, используйте режим аудита](#use-audit-mode-to-test-the-rule)

3. [Добавление исключений для указанного правила](#add-exclusions-for-a-false-positive) (для ложных срабатыва-

4. [Отправка журналов поддержки](#collect-diagnostic-data-for-file-submissions)

## <a name="confirm-prerequisites"></a>Подтверждение необходимых условий

Правила уменьшения поверхности атаки будут работать только на устройствах со следующими условиями:

- Конечные точки работают в Windows 10 Enterprise версии 1709 (также известной как Fall Creators Update).

- Конечные точки используют антивирус Microsoft Defender в качестве единственного приложения для защиты от антивирусов. [Использование любого другого антивирусного приложения приведет к](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-antivirus/microsoft-defender-antivirus-compatibility)отключению microsoft Defender AV.

- [Включена защита в](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-antivirus/configure-real-time-protection-microsoft-defender-antivirus) режиме реального времени.

- Режим аудита не включен. Используйте групповую политику, чтобы установить правило **Отключено** (значение: **0),** как описано в правилах уменьшения поверхности [атаки.](enable-attack-surface-reduction.md)

Если все эти необходимые условия выполнены, переступим к следующему шагу, чтобы проверить правило в режиме аудита.

## <a name="use-audit-mode-to-test-the-rule"></a>Чтобы проверить правило, используйте режим аудита

Вы можете посетить веб-сайт Защитник Windows test ground в [demo.wd.microsoft.com,](https://demo.wd.microsoft.com?ocid=cx-wddocs-testground) чтобы подтвердить, что правила уменьшения поверхности атаки обычно работают для предварительно настроенных сценариев и процессов на устройстве, или вы можете использовать режим аудита, который включает правила только для отчетности.

Следуйте этим инструкциям в с помощью средства [демонстрации,](evaluate-attack-surface-reduction.md) чтобы узнать, как работают правила уменьшения поверхности атаки для проверки конкретного правила, с которым вы столкнулись.

1. Включить режим аудита для определенного правила, которое необходимо протестировать. Используйте групповую политику, чтобы установить правило в **режиме аудита** (значение: **2),** как описано в правилах уменьшения поверхности [атаки.](enable-attack-surface-reduction.md) Режим аудита позволяет правилу сообщать о файле или процессе, но все равно позволяет ему работать.

2. Выполните действия, которые вызывают проблему (например, откройте или выполните файл или процесс, который должен быть заблокирован, но разрешен).

3. [Просмотрите журналы](attack-surface-reduction.md) событий событий правила уменьшения поверхности атаки, чтобы узнать, заблокировало ли правило файл или процесс, если бы правило было за установлено для **включения.**

Если правило не блокирует файл или процесс, который следует заблокировать, сначала проверьте, включен ли режим аудита.

Режим аудита мог быть включен для тестирования другой функции или с помощью автоматического сценария PowerShell и не был отключен после завершения тестов.

Если вы протестировали правило с помощью средства демонстрации и в режиме аудита, а правила уменьшения поверхности атаки работают над заранее настроенными сценариями, но это правило не работает, переехав в любой из следующих разделов в зависимости от ситуации:

1. Если правило уменьшения поверхности атаки блокирует то, что не должно блокировать (также известное как ложное срабатыважение), сначала можно добавить исключение правила уменьшения поверхности [атаки.](#add-exclusions-for-a-false-positive)

2. Если правило уменьшения поверхности атаки не блокирует то, что оно должно блокировать (также известное как ложный отрицательный), вы можете немедленно перейти к последнему шагу, собирая диагностические данные и сообщая нам о [проблеме.](#collect-diagnostic-data-for-file-submissions)

## <a name="add-exclusions-for-a-false-positive"></a>Добавление исключений для ложного срабатыва

Если правило уменьшения поверхности атаки блокирует то, что не должно блокировать (также известное как ложное срабатывание), можно добавить исключения, чтобы предотвратить оценку исключенных файлов или папок правилами уменьшения поверхности атаки.

Чтобы добавить исключение, см. [в статью Настройка уменьшения поверхности attack.](customize-attack-surface-reduction.md)

>[!IMPORTANT]
>Можно указать отдельные файлы и папки, которые следует исключить, но нельзя указать отдельные правила.
>Это означает, что все файлы или папки, которые исключены, будут исключены из всех правил ASR.

## <a name="report-a-false-positive-or-false-negative"></a>Сообщение о ложном срабатыве или ложном отрицательном

Чтобы [сообщить о ложном отрицательном](https://www.microsoft.com/wdsi/filesubmission) или ложном срабатывии для защиты сети, используйте веб-форму отправки Защитник Windows Security Intelligence. С подпиской на Windows E5 вы также можете предоставить ссылку на любое [связанное оповещение.](alerts-queue.md)

## <a name="collect-diagnostic-data-for-file-submissions"></a>Сбор диагностических данных для отправки файлов

Когда вы сообщаете о проблеме с правилами уменьшения поверхности атаки, вам будет предложено собирать и отправлять диагностические данные, которые могут использоваться группами поддержки Майкрософт и инженерными группами для устранения неполадок.

1. Откройте повышенную командную подсказку и измените каталог Защитник Windows:

   ```console
   cd "c:\program files\windows defender"
   ```

2. Запустите эту команду для создания диагностических журналов:

   ```console
   mpcmdrun -getfiles
   ```

3. По умолчанию они сохраняются до `C:\ProgramData\Microsoft\Windows Defender\Support\MpSupportFiles.cab` . Прикрепить файл к форме отправки.

## <a name="related-articles"></a>Статьи по теме

- [Правила сокращения направлений атак](attack-surface-reduction.md)

- [Включить правила уменьшения поверхности атаки](enable-attack-surface-reduction.md)

- [Оценка правил уменьшения поверхности атаки](evaluate-attack-surface-reduction.md)
