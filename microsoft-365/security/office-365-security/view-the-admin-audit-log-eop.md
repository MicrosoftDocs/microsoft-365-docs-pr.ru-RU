---
title: Просмотр журнала аудита администратора в автономном EOP
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
ms.service: O365-seccomp
localization_priority: Normal
ms.assetid: 003d7a74-3e16-4453-ae0c-9dbae51f66d1
description: Администраторы могут узнать, как просматривать и искать журнал аудита действий администратора в автономной службе Exchange Online Protection (EOP).
ms.openlocfilehash: 9fe2c742083cde1ca36f6a04cd357a473a10aeac
ms.sourcegitcommit: c083602dda3cdcb5b58cb8aa070d77019075f765
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/22/2020
ms.locfileid: "48196547"
---
# <a name="view-the-admin-audit-log-in-standalone-eop"></a>Просмотр журнала аудита администратора в автономном EOP

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


В автономных организациях Exchange Online Protection (EOP) без почтовых ящиков Exchange Online можно использовать центр администрирования Exchange или изолированный EOP PowerShell для поиска и просмотра записей в журнале аудита действий администратора.

Журнал аудита действий администратора записывает определенные действия на основе отдельных командлетов EOP PowerShell, выполняемых администраторами и пользователями, которым были назначены права администратора. Записи в журнале аудита действий администратора предоставляют сведения о выполняемом командлете, об используемых параметрах, о том, кто выполнил командлет, а также о том, какие объекты были затронуты.

> [!NOTE]
>
> - Ведение журнала аудита администратора включено по умолчанию, и его невозможно отключить.
>
> - Журнал аудита действий администратора не записывает действия на основе командлетов, начинающихся с глаголов **Get**, **Search**или **Test**.
>
> - Записи журнала аудита хранятся в течение 90 дней. Если запись старше 90 дней, она удаляется

## <a name="what-do-you-need-to-know-before-you-begin"></a>Что нужно знать перед началом работы

- Чтобы открыть центр администрирования Exchange, обратитесь к [центру администрирования Exchange в автономной EOP](exchange-admin-center-in-exchange-online-protection-eop.md).

- Чтобы подключиться к автономному EOP PowerShell, см. раздел [Подключение к PowerShell Exchange Online Protection](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).

- Чтобы вы могли выполнить эти процедуры, вам должны быть назначены соответствующие разрешения. В частности, необходимы журналы аудита или роль только для просмотра журналов аудита, которые назначаются группам ролей Комплианцеманажемент, Организатионманажемент (глобальные администраторы) и Секуритядминистратор по умолчанию. Дополнительные сведения см. [в разделе разрешения в автономных EOP](feature-permissions-in-eop.md) и используйте центр администрирования Exchange для [изменения списка участников в группах ролей](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups).

- Дополнительные сведения о сочетаниях клавиш, которые могут применяться к процедурам, описанным в этой статье, приведены в статье [сочетания клавиш для центра администрирования Exchange в Exchange Online](https://docs.microsoft.com/Exchange/accessibility/keyboard-shortcuts-in-admin-center).

> [!TIP]
> Возникли проблемы? Обратитесь за помощью на форум по [Exchange Online Protection](https://go.microsoft.com/fwlink/p/?linkId=285351).

## <a name="use-the-eac-to-view-the-admin-audit-log"></a>Просмотр журнала аудита действий администратора с помощью центра администрирования Exchange

1. В центре администрирования Exchange перейдите к разделу аудит **управления соответствием требованиям** \> **Auditing**, а затем выберите команду **запустить отчет журнала аудита действий администратора**.

2. На открывшейся странице **Поиск изменений в группах ролей администраторов** выберите **начальную** и **конечную даты** (диапазон по умолчанию — последние две недели), а затем нажмите кнопку **Поиск**. Все изменения конфигурации, внесенные в указанный период времени, отображаются и могут быть отсортированы с использованием следующих сведений:

   - **Дата**: Дата и время изменения конфигурации. Дата и время хранятся в формате времени UTC.

   - **Командлет**: имя командлета, который использовался для внесения изменений в конфигурацию.

   - **Пользователь**: имя учетной записи пользователя, который внес изменения в конфигурацию.

     На нескольких страницах отображается до 5000 записей. Укажите меньший диапазон дат, чтобы сократить число результатов. Если выбрать отдельный результат, в области сведений отображаются следующие сведения.

   - **Измененный объект**: объект, который был изменен командлетом.

   - **Parameters (параметр: значение)**: используемые параметры командлета и любое значение, указанное с помощью параметра.

3. Если вы хотите напечатать определенную запись журнала, нажмите кнопку **Печать** в области сведений.

## <a name="use-standalone-eop-powershell-to-view-the-admin-audit-log"></a>Просмотр журнала аудита действий администратора с помощью изолированной EOP PowerShell

Для поиска записей журнала аудита, соответствующих заданным условиям, можно использовать автономный EOP PowerShell. Используйте указанный ниже синтаксис.

```PowerShell
Search-AdminAuditLog [-Cmdlets <Cmdlet1,Cmdlet2,...CmdletN>] [-Parameters <Parameter1,Parameter2,...ParameterN>] [-StartDate <UTCDateTime>] [-EndDate <UTCDateTime>] [-UserIds <"User1","User2",..."UserN">] [-ObjectIds <"Object1","Object2",..."ObjectN">] [-IsSuccess <$true | $false>]
```

**Примечания.**

- Параметр _Parameters_ можно использовать только вместе с параметром _командлетов_ .

- Параметр _ObjectIds_ фильтрует результаты по объекту, который был изменен командлетом. Допустимое значение зависит от того, как объект представлен в журнале аудита. Например:

  - Имя
  - Каноническое имя (например, contoso.com/Users/Akia Al-Zuhairi)

  В этом командлете, скорее всего, потребуется использовать другие параметры фильтрации для сужения результатов поиска и определения требуемых типов объектов.

- Параметр _UserID_ фильтрует результаты по пользователю, который внес изменения (кто выполнил командлет).

- Для параметров _StartDate_ и _EndDate_ при указании значения даты и времени без часового пояса значение указывается в формате UTC. Чтобы указать значение даты или времени для этого параметра, воспользуйтесь одним из следующих вариантов:

  - Укажите значение даты / времени в формате UTC: например, «2016-05-06 14: 30: 00z».

  - Укажите значение даты и времени в виде формулы, преобразующей дату и время в местном часовом поясе в UTC: например, `(Get-Date "5/6/2016 9:30 AM").ToUniversalTime()` . Для получения дополнительной информации см. [Get-Date](https://docs.microsoft.com/powershell/module/microsoft.powershell.utility/get-date).

- По умолчанию командлет возвращает максимум 1 000 записей журнала. Используйте параметр _ResultSize_ , чтобы указать до 250 000 записей журнала. Или используйте значение, `Unlimited` чтобы возвратить все записи.

В этом примере выполняется поиск всех записей журнала аудита со следующими критериями:

- **Дата начала**: 4 августа 2019 г.
- **Дата окончания**: 3 октября 2019 г.
- **Командлеты**: Update — RoleGroupMember

```PowerShell
Search-AdminAuditLog -Cmdlets Update-RoleGroupMember -StartDate (Get-Date "08/04/2019").ToUniversalTime() -EndDate (Get-Date "10/03/2019").ToUniversalTime()
```

Дополнительные сведения о синтаксисе и параметрах см. в разделе [Search-AdminAuditLog](https://docs.microsoft.com/powershell/module/exchange/search-adminauditlog).

### <a name="view-details-of-audit-log-entries"></a>Просмотр подробных сведений о записях журнала аудита

Командлет **Search – AdminAuditLog** возвращает поля, описанные в разделе [содержимое журнала аудита](#audit-log-contents) далее в этой статье. Из полей, возвращаемых командлетом, два поля, **CmdletParameters** и **ModifiedProperties**, содержат дополнительные сведения, которые не возвращаются по умолчанию.

Чтобы просмотреть содержимое полей **CmdletParameters** и **ModifiedProperties**, выполните указанные ниже действия.

1. Определите критерии поиска, запустите командлет **Search-AdminAuditLog** и сохраните результаты в переменной с помощью следующей команды.

    ```PowerShell
    $Results = Search-AdminAuditLog <search criteria>
    ```

2. Каждая запись журнала аудита хранится в виде элемента массива в переменной `$Results` . Чтобы выбрать элемент массива, укажите его индекс. Индексы элементов массива начинаются с 0 для первого элемента массива. Например, чтобы получить пятый элемент массива с индексом 4, используйте следующую команду.

    ```PowerShell
    $Results[4]
    ```

3. Предыдущая команда возвращает запись журнала, хранящуюся в элементе массива 4. Чтобы просмотреть содержимое полей **CmdletParameters** и **ModifiedProperties** для этой записи журнала, используйте следующие команды.

    ```PowerShell
    $Results[4].CmdletParameters
    $Results[4].ModifiedProperties
    ```

4. Чтобы просмотреть содержимое полей **CmdletParameters** и **ModifiedParameters** в другой записи журнала, измените индекс элемента массива.

## <a name="audit-log-contents"></a>Содержимое журнала аудита

Каждая запись журнала аудита содержит сведения, описанные в приведенной ниже таблице. Журнал аудита содержит одну или несколько записей.

****

|Поле|Описание|
|---|---|
|`RunspaceId`|Это поле используется внутренним приложением по EOP.|
|`ObjectModified`|В этом поле содержится объект, измененный командлетом, указанным в `CmdletName` поле.|
|`CmdletName`|В этом поле содержится имя командлета, запущенного пользователем в `Caller` поле.|
|`CmdletParameters`|В этом поле содержатся параметры, которые были указаны при запуске командлета в `CmdletName` поле. В этом поле, при наличии, также хранится, но не отображается в выходных данных по умолчанию, значение, указанное с помощью параметра.|
|`ModifiedProperties`|В этом поле содержатся свойства, которые были изменены для объекта в `ObjectModified` поле. В этом поле также хранятся значения свойств  как старые, так и новые (сохраненные).|
|`Caller`|В этом поле содержится учетная запись пользователя, запустившего командлет в `CmdletName` поле.|
|`ExternalAccess`|Это поле используется внутренним приложением по EOP.|
|`Succeeded`|В этом поле указывается, успешно ли выполнена работа командлета в `CmdletName` поле. Значение может быть `True` или `False` .|
|`Error`|В этом поле содержится сообщение об ошибке, созданное при `CmdletName` неудачном завершении командлета в поле.|
|`RunDate`|В этом поле содержатся дата и время выполнения командлета в `CmdletName` поле. Дата и время хранятся в формате времени UTC.|
|`OriginatingServer`|В этом поле указывается сервер, на котором был выполнен командлет, указанный в `CmdletName` поле.|
|`ClientIP`|Это поле используется внутренним приложением по EOP.|
|`SessionId`|Это поле используется внутренним приложением по EOP.|
|`AppId`|Это поле используется внутренним приложением по EOP.|
|`ClientAppId`|Это поле используется внутренним приложением по EOP.|
|`Identity`|Это поле используется внутренним приложением по EOP.|
|`IsValid`|Это поле используется внутренним приложением по EOP.|
|`ObjectState`|Это поле используется внутренним приложением по EOP.|
|
