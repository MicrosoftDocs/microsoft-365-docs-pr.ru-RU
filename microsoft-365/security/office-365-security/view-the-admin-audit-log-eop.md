---
title: Просмотр журнала аудита администратора в автономной службе EOP
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
localization_priority: Normal
ms.assetid: 003d7a74-3e16-4453-ae0c-9dbae51f66d1
description: Администраторы могут узнать, как просматривать и искать журнал аудита администратора в автономных exchange Online Protection (EOP).
ms.technology: mdo
ms.prod: m365-security
ms.openlocfilehash: ab6bf0a2739a88a075b636b990539b24006f3e63
ms.sourcegitcommit: 786f90a163d34c02b8451d09aa1efb1e1d5f543c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/18/2021
ms.locfileid: "50286481"
---
# <a name="view-the-admin-audit-log-in-standalone-eop"></a>Просмотр журнала аудита администратора в автономной службе EOP

**Область применения**
- [Автономный exchange Online Protection](exchange-online-protection-overview.md)

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


В автономных организациях Exchange Online Protection (EOP) без почтовых ящиков Exchange Online можно использовать Центр администрирования Exchange (EAC) или автономный EOP PowerShell для поиска и просмотра записей в журнале аудита администратора.

В журнал аудита действий администратора записываются определенные действия, основанные на автономных cmdlets EOP PowerShell, которые делают администраторы и пользователи, которым были назначены права администратора. Записи в журнале аудита администратора предоставляют сведения о том, какой был запуск, какие параметры использовались, кто запустил этот и какие объекты были затронуты.

> [!NOTE]
>
> - Ведение журнала аудита администратора включено по умолчанию, и его нельзя отключить.
>
> - В журнал аудита действий администратора не записываются действия, основанные на действиях, которые начинаются с глаголов **Get,** **Search** или **Test.**
>
> - Записи журнала аудита хранятся в течение 90 дней. Если возраст записи превышает 90 дней, она удаляется

## <a name="what-do-you-need-to-know-before-you-begin"></a>Что нужно знать перед началом работы

- Чтобы открыть Центр администрирования Exchange, см. центр [администрирования Exchange в режиме автономных EOP.](exchange-admin-center-in-exchange-online-protection-eop.md)

- Чтобы подключиться к автономному EOP PowerShell, см. раздел [Подключение к PowerShell Exchange Online Protection](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).

- Для работы с процедурами, которые данная статья, вам должны быть назначены разрешения в Exchange Online Protection. В частности, вам  потребуется роль  "Журналы аудита" или "Только просмотр журналов аудита", которые по умолчанию назначены группам ролей "Управление организацией", "Управление соответствием требованиям" и "Администратор безопасности".    Дополнительные сведения см. в сведениях о разрешениях в автономных [EOP](feature-permissions-in-eop.md) и использовании EAC для изменения списка участников [в группах ролей.](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups)

- Сведения о сочетаниях клавиш, которые могут применяться к процедурам в этой статье, см. в статье "Сочетания клавиш" для Центра администрирования [Exchange в Exchange Online.](https://docs.microsoft.com/Exchange/accessibility/keyboard-shortcuts-in-admin-center)

> [!TIP]
> Возникли проблемы? Обратитесь за помощью на форум по [Exchange Online Protection](https://social.technet.microsoft.com/Forums/forefront/home?forum=FOPE).

## <a name="use-the-eac-to-view-the-admin-audit-log"></a>Просмотр журнала аудита администратора с помощью EAC

1. В EAC перейдите  к аудиту управления соответствием и выберите "Запуск отчета журнала \>  **аудита администратора".**

2. На **открываемой** странице "Поиск изменений в  группах ролей администраторов" выберите дату начала и окончания **(диапазон** по умолчанию — последние две недели), а затем выберите **"Поиск".** Отображаются все изменения конфигурации, внесенные в указанный период времени, и их можно отсортировать, используя следующие сведения:

   - **Дата**: дата и время изменения конфигурации. Дата и время хранятся в формате времени UTC.

   - **Cmdlet**: имя cmdlet, который использовался для изменения конфигурации.

   - **Пользователь**: имя учетной записи пользователя, который внося изменения в конфигурацию.

     На нескольких страницах отображается до 5000 записей. Укажите меньший диапазон дат, чтобы сократить число результатов. Если выбрать отдельный результат, в области сведений отображаются следующие сведения.

   - **Измененный** объект: объект, измененный с помощью cmdlet.

   - **Параметры (параметр:значение):** использованные параметры и любое значение, указанное с помощью параметра.

3. Если вы хотите напечатать определенную запись журнала, нажмите кнопку **Печать** в области сведений.

## <a name="use-standalone-eop-powershell-to-view-the-admin-audit-log"></a>Просмотр журнала аудита администратора с помощью автономных EOP PowerShell

Вы можете использовать автономный EOP PowerShell для поиска записей журнала аудита, которые соответствуют занижаемой вами критерии. Используйте указанный ниже синтаксис.

```PowerShell
Search-AdminAuditLog [-Cmdlets <Cmdlet1,Cmdlet2,...CmdletN>] [-Parameters <Parameter1,Parameter2,...ParameterN>] [-StartDate <UTCDateTime>] [-EndDate <UTCDateTime>] [-UserIds <"User1","User2",..."UserN">] [-ObjectIds <"Object1","Object2",..."ObjectN">] [-IsSuccess <$true | $false>]
```

**Примечания**.

- Параметр _Parameters_ можно использовать только вместе с параметром _Cmdlets._

- Параметр _ObjectIds_ фильтрует результаты по объекту, который был изменен с помощью этого параметра. Допустимые значения зависят от того, как объект представлен в журнале аудита. Например,

  - Имя
  - Каноническое различается имя (например, contoso.com/Users/Akia Al-Zuhairi)

  Скорее всего, вам потребуется использовать другие параметры фильтрации в этом cmdlet, чтобы сузить результаты и определить интересующие вас типы объектов.

- Параметр _UserIds_ фильтрует результаты по пользователю, внося изменения (который запустил этот cmdlet).

- Для _параметров StartDate_ и _EndDate,_ если указать значение даты и времени без часовой пояс, значение будет указано в UTC. Чтобы указать значение даты или времени для этого параметра, воспользуйтесь одним из следующих вариантов:

  - Укажите значение даты / времени в формате UTC: например, «2016-05-06 14: 30: 00z».

  - Укажите значение даты и времени в качестве формулы, которая преобразует дату и время в локальном часовом поясе в UTC: `(Get-Date "5/6/2016 9:30 AM").ToUniversalTime()` например. Для получения дополнительной информации см. [Get-Date](https://docs.microsoft.com/powershell/module/microsoft.powershell.utility/get-date).

- По умолчанию он возвращает не более 1000 записей журнала. Используйте параметр _ResultSize,_ чтобы указать до 250 000 записей журнала. Или используйте значение для `Unlimited` возврата всех записей.

В этом примере выполняется поиск всех записей журнала аудита со следующими критериями:

- **Дата начала:** 4 августа 2019 г.
- **Дата окончания:** 3 октября 2019 г.
- **Cmdlets**: Update-RoleGroupMember

```PowerShell
Search-AdminAuditLog -Cmdlets Update-RoleGroupMember -StartDate (Get-Date "08/04/2019").ToUniversalTime() -EndDate (Get-Date "10/03/2019").ToUniversalTime()
```

Дополнительные сведения о синтаксисе и параметрах см. в разделе [Search-AdminAuditLog](https://docs.microsoft.com/powershell/module/exchange/search-adminauditlog).

### <a name="view-details-of-audit-log-entries"></a>Просмотр подробных сведений о записях журнала аудита

The **Search-AdminAuditLog cmdlet** returns the fields described in the [Audit log contents](#audit-log-contents) section later in this article. Два поля, **CmdletParameters** и **ModifiedProperties,** возвращают дополнительные сведения, которые не возвращаются по умолчанию.

Чтобы просмотреть содержимое полей **CmdletParameters** и **ModifiedProperties**, выполните указанные ниже действия.

1. Определите критерии поиска, запустите командлет **Search-AdminAuditLog** и сохраните результаты в переменной с помощью следующей команды.

    ```PowerShell
    $Results = Search-AdminAuditLog <search criteria>
    ```

2. Каждая запись журнала аудита хранится в переменной как элемент `$Results` массива. Чтобы выбрать элемент массива, укажите его индекс. Индексы элементов массива начинаются с 0 для первого элемента массива. Например, чтобы получить пятый элемент массива с индексом 4, используйте следующую команду.

    ```PowerShell
    $Results[4]
    ```

3. Предыдущая команда возвращает запись журнала, хранящуюся в элементе массива 4. Чтобы просмотреть содержимое полей **CmdletParameters** и **ModifiedProperties** для этой записи журнала, используйте следующие команды.

    ```PowerShell
    $Results[4].CmdletParameters
    $Results[4].ModifiedProperties
    ```

4. Чтобы просмотреть содержимое полей **CmdletParameters** и **ModifiedParameters** в другой записи журнала, измените индекс элемента массива.

## <a name="audit-log-contents"></a>Содержимое журнала аудита

Каждая запись журнала аудита содержит сведения, описанные в приведенной ниже таблице. Журнал аудита содержит одну или несколько записей.

****

|Поле|Описание|
|---|---|
|`RunspaceId`|Это поле используется внутри EOP.|
|`ObjectModified`|Это поле содержит объект, измененный с помощью указанного в поле `CmdletName` cmdlet.|
|`CmdletName`|В этом поле содержится имя запускаемого пользователем в поле `Caller` cmdlet.|
|`CmdletParameters`|Это поле содержит параметры, которые были заданы при запуске в `CmdletName` поле. В этом поле, при наличии, также хранится, но не отображается в выходных данных по умолчанию, значение, указанное с помощью параметра.|
|`ModifiedProperties`|Это поле содержит свойства, которые были изменены для объекта в `ObjectModified` поле. В этом поле также хранятся значения свойств  как старые, так и новые (сохраненные).|
|`Caller`|В этом поле содержится учетная запись пользователя, выдавшего в поле этот `CmdletName` код.|
|`ExternalAccess`|Это поле используется внутри EOP.|
|`Succeeded`|В этом поле указывается, успешно ли выполнился указанный в `CmdletName` поле. Значением является либо `True` `False` .|
|`Error`|В этом поле содержится сообщение об ошибке, которое создается, если не удалось выполнить его `CmdletName` успешно.|
|`RunDate`|Это поле содержит дату и время запуска этого `CmdletName` поля. Дата и время хранятся в формате времени UTC.|
|`OriginatingServer`|Это поле указывает сервер, на котором был запускаться указанный в `CmdletName` поле.|
|`ClientIP`|Это поле используется внутри EOP.|
|`SessionId`|Это поле используется внутри EOP.|
|`AppId`|Это поле используется внутри EOP.|
|`ClientAppId`|Это поле используется внутри EOP.|
|`Identity`|Это поле используется внутри EOP.|
|`IsValid`|Это поле используется внутри EOP.|
|`ObjectState`|Это поле используется внутри EOP.|
|
