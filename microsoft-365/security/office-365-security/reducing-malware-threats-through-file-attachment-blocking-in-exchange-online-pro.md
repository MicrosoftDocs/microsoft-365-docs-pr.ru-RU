---
title: Использование правил для обработки почтового ящика для блокирования сообщений с исполняемыми вложениями
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: Администраторы могут узнать, как создавать правила для поток обработки почты (правила транспорта), чтобы заблокировать сообщения, содержащие исполняемые файлы.
ms.openlocfilehash: e579b4ac6daf9a537f5210071c71089a7536ab4e
ms.sourcegitcommit: 73b2426001dc5a3f4b857366ef51e877db549098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "44617378"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a>Используйте правила потока почты для блокировки сообщений с исполняемыми вложениями в EOP

В организациях Microsoft 365 с почтовыми ящиками в организациях Exchange Online или Exchange Online Protection (EOP) без почтовых ящиков Exchange Online, EOP использует политики защиты от вредоносных программ для блокирования вредоносных сообщений, включая сообщения с исполняемыми вложениями. Дополнительные сведения см. [в статье Защита от вредоносных программ в EOP](anti-malware-protection.md).

Чтобы улучшить защиту, вы можете использовать правила для управления потоками обработки почты (также называемые правилами транспорта), чтобы определять и блокировать сообщения, содержащие исполняемые вложения, как описано в этой статье.

Например, после эпидемии вредоносных программ компания может применить это правило с предельным пределом времени, чтобы затронутые пользователи могли вернуться к отправке вложений через заданный период времени.

## <a name="what-do-you-need-to-know-before-you-begin"></a>Что нужно знать перед началом работы

- Прежде чем выполнять следующие процедуры, необходимо назначить разрешения.

  - В Exchange Online вы найдете запись "почтовый ящик" в разделе "Управление [разрешениями" функции в Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/feature-permissions).
  
  - В автономном EOP вам потребуются роли правил транспорта, которые назначаются ролям Организатионманажемент, Комплианцеманажемент и RecordsManagement по умолчанию. Дополнительные сведения см. [в разделе разрешения в автономных EOP](feature-permissions-in-eop.md) и используйте центр администрирования Exchange для [изменения списка участников в группах ролей](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups).

- Чтобы открыть центр администрирования Exchange в Exchange Online, обратитесь к [центру администрирования Exchange в Exchange Online](https://docs.microsoft.com/Exchange/exchange-admin-center). Чтобы открыть центр администрирования Exchange в автономном EOP, обратитесь к разделу [центр администрирования Exchange в отдельном EOP](exchange-admin-center-in-exchange-online-protection-eop.md).

- Сведения о том, как подключиться к Exchange Online PowerShell, см. в статье [Подключение к Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell). Чтобы подключиться к автономному EOP PowerShell, см. раздел [Подключение к PowerShell Exchange Online Protection](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).

- Дополнительные сведения о правилах обработки почтового ящика в Exchange Online и отдельном EOP содержатся в следующих разделах:

  - [Правила потока обработки почты (правила транспорта) в Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [Условия и исключения правила для обработки почтового процесса (предикаты) в Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [Действия правил обработки почты в Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Использование центра администрирования Exchange для создания правила, блокирующего сообщения с исполняемыми вложениями

1. В Центре администрирования Exchange перейдите в раздел **Поток обработки почты** \> **Правила**.

2. Щелкните **Добавить** ![ значок Добавить ](../../media/ITPro-EAC-AddIcon.png) , а затем выберите **создать новое правило**.

3. На открывшейся странице **Новое правило** настройте следующие параметры:

   - **Name**: введите уникальное описательное имя правила.

   - Нажмите кнопку **Дополнительные параметры**.

   - **Применять это правило, если**: выберите **любое вложение** \> **с исполняемым содержимым**.

   - **Выполните следующие**действия: выберите **блокировать сообщение** , а затем выберите нужное действие:

     - **Отклонить сообщение и включить объяснение**: в открывшемся диалоговом окне **Указание причины отклонения** введите текст, который должен отображаться в отчете о недоставке (также называемом сообщением о недоставке или сообщении Bounce). Расширенный код состояния, который используется по умолчанию: 5.7.1.

     - **Отклонить сообщение с расширенным кодом состояния**: в появившемся диалоговом окне **Ввод расширенного кода** состояния введите расширенный код состояния, который будет отображаться в отчете о недоставке. Допустимые значения: 5.7.1 или значение от от 5.7.900 до 5.7.999. Текст отклонения по умолчанию: Доставка не разрешена, сообщение отклонено.

     - **отклонить сообщение, не уведомляя кого**

4. Выполнив необходимые действия, нажмите кнопку **Сохранить**. Теперь правило блокирования вложений вступило в силу.

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Использование PowerShell для создания правила, блокирующего сообщения с исполняемыми вложениями

Используйте следующий синтаксис, чтобы создать правило для блокирования сообщений, содержащих исполняемые вложения:

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

**Примечания**:

- При использовании параметра _RejectMessageEnhancedStatusCode_ без параметра _RejectMessageReasonText_ текст по умолчанию: Доставка не разрешена, сообщение отклонено.

- Если параметр _RejectMessageReasonText_ используется без параметра _RejectMessageEnhancedStatusCode_ , то по умолчанию используется код 5.7.1.

В этом примере создается новое правило с именем блокировать исполняемые вложения, которое удаляет сообщения, содержащие исполняемые файлы, без уведомления.

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

Дополнительные сведения о синтаксисе и параметрах см. в статье [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/new-transportrule).

## <a name="how-do-you-know-this-worked"></a>Как убедиться, что все получилось?

Чтобы убедиться, что вы успешно создали правило для обработки почтового ящика, чтобы заблокировать сообщения, содержащие исполняемые файлы, выполните одно из указанных ниже действий.

- В центре администрирования Exchange перейдите к разделу правила для обработки **почтового ящика** , \> **Rules** \> выберите правило \> щелкните **изменить** ![ значок редактирования ](../../media/ITPro-EAC-EditIcon.png) и проверьте параметры.

- В PowerShell выполните следующую команду, чтобы проверить параметры:

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```
