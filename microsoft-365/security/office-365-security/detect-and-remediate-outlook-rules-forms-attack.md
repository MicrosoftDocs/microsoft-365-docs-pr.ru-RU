---
title: Обнаружение и исправление атак с введением в правила Outlook и пользовательские формы.
f1.keywords:
- NOCSH
ms.author: tracyp
author: MSFTTracyp
manager: dansimp
ms.date: 04/23/2018
audience: ITPro
ms.topic: article
ms.collection:
- o365_security_incident_response
- M365-security-compliance
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
description: Узнайте, как распознавать и устранять атаки с введением в правила Outlook и настраиваемые формы в Office 365
ms.custom: seo-marvel-apr2020
ms.openlocfilehash: cbdc41315d64d341248d6900147aabc5a0b9877c
ms.sourcegitcommit: 47de4402174c263ae8d70c910ca068a7581d04ae
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "49663647"
---
# <a name="detect-and-remediate-outlook-rules-and-custom-forms-injections-attacks"></a><span data-ttu-id="0d7cc-103">Обнаружение и устранение атак с правилами Outlook и пользовательскими формами</span><span class="sxs-lookup"><span data-stu-id="0d7cc-103">Detect and Remediate Outlook Rules and Custom Forms Injections Attacks</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


<span data-ttu-id="0d7cc-104">**Сводка** Узнайте, как распознавать и устранять атаки с правилами Outlook и пользовательскими формами в Office 365.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-104">**Summary** Learn how to recognize and remediate the Outlook rules and custom Forms injections attacks in Office 365.</span></span>

## <a name="what-is-the-outlook-rules-and-custom-forms-injection-attack"></a><span data-ttu-id="0d7cc-105">What is the Outlook Rules and Custom Forms injection attack?</span><span class="sxs-lookup"><span data-stu-id="0d7cc-105">What is the Outlook Rules and Custom Forms injection attack?</span></span>

<span data-ttu-id="0d7cc-106">После того как злоумышленник взломает учетную запись в вашем аренде и вошел в нее, он попытается установить способ оставаться в системе или вернуться после обнаружения и удаления.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-106">After an attacker has breached an account in your tenancy and gets in, they're are going to try and establish a way to stay in or a way to get back in after they are discovered and removed.</span></span> <span data-ttu-id="0d7cc-107">Это называется созданием механизма сохраняемости.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-107">This is called establishing a persistence mechanism.</span></span> <span data-ttu-id="0d7cc-108">Два способа сделать это — использовать правила Outlook или внедрять настраиваемые формы в Outlook.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-108">Two ways that they can do this are by exploiting Outlook rules or by injecting custom forms into Outlook.</span></span>
<span data-ttu-id="0d7cc-109">В обоих случаях правило или форма синхронизируются из облачной службы вниз с классическим клиентом, поэтому полный формат и повторное установка клиентского программного обеспечения не устраняют механизм встраивания.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-109">In both cases, the rule or form is synced from the cloud service down to the desktop client, so a full format and re-install of the client software doesn't eliminate the injection mechanism.</span></span> <span data-ttu-id="0d7cc-110">Это происходит потому, что при повторном подсоединение клиентского программного обеспечения Outlook к почтовому ящику в облаке оно повторно скачивает правила и формы из облака.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-110">This is because when the Outlook client software reconnects to the mailbox in the cloud it will re-download the rules and forms from the cloud.</span></span> <span data-ttu-id="0d7cc-111">После установки правил и форм злоумышленник использует их для выполнения удаленного или пользовательского кода, как правило, для установки вредоносных программ на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-111">Once the rules and forms are in place, the attacker uses them to execute remote or custom code, usually to install malware on the local machine.</span></span> <span data-ttu-id="0d7cc-112">Затем вредоносная программа повторно похищает учетные данные или выполняет другие незаконные действия.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-112">The malware then re-steals credentials or performs other illicit activity.</span></span>
<span data-ttu-id="0d7cc-113">В этом случае мы будем уверены, что если клиенты будут исправлены до последней версии, вы не будете уязвимыми к угрозе, так как текущие клиентские настройки Outlook по умолчанию блокируют оба механизма.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-113">The good news here is that if you keep your clients patched to the latest version, you are not vulnerable to the threat as current Outlook client defaults block both mechanisms.</span></span>

<span data-ttu-id="0d7cc-114">Атаки обычно следуют следующим шаблонам:</span><span class="sxs-lookup"><span data-stu-id="0d7cc-114">The attacks typically follow these patterns:</span></span>

<span data-ttu-id="0d7cc-115">**Эксплойт правил:**</span><span class="sxs-lookup"><span data-stu-id="0d7cc-115">**The Rules Exploit**:</span></span>

1. <span data-ttu-id="0d7cc-116">Злоумышленник похищает имя пользователя и пароль одного из ваших пользователей.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-116">The attacker steals the username and password of one of your users.</span></span>

2. <span data-ttu-id="0d7cc-117">Затем злоумышленник войтывает в почтовый ящик Exchange пользователей.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-117">The attacker then signs in to that users Exchange mailbox.</span></span> <span data-ttu-id="0d7cc-118">Почтовый ящик может быть либо в Exchange Online, либо в локальной exchange.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-118">The mailbox can either be in Exchange online or in Exchange on-premises.</span></span>

3. <span data-ttu-id="0d7cc-119">Затем злоумышленник создает правило пересылки в почтовом ящике, которое запускается, когда почтовый ящик получает сообщение электронной почты, которое соответствует условиям правила.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-119">The attacker then creates a forwarding rule in the mailbox that is triggered when the mailbox receives an email that matches the criteria of the rule.</span></span> <span data-ttu-id="0d7cc-120">Критерии правила и содержимое триггера электронной почты адаптированы друг для друга.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-120">The criteria of rule and the contents of the trigger email are tailor-made for each other.</span></span>

4. <span data-ttu-id="0d7cc-121">Злоумышленник отправляет сообщение с триггером пользователю, который обычно использует свой почтовый ящик.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-121">The attacker sends the trigger email to the user who is using their mailbox normally.</span></span>

5. <span data-ttu-id="0d7cc-122">При получении сообщения электронной почты запускается правило.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-122">When the email is received, the rule is triggered.</span></span> <span data-ttu-id="0d7cc-123">Обычно правило запускает приложение на удаленном сервере WebDAV.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-123">The action of the rule is usually to launch an application on a remote (WebDAV) server.</span></span>

6. <span data-ttu-id="0d7cc-124">Как правило, приложение устанавливает вредоносное ПО, например [Powershell Вайл,](https://www.powershellempire.com/)локально на компьютере пользователя.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-124">The application typically installs malware, such as [Powershell Empire](https://www.powershellempire.com/), locally on the user's machine.</span></span>

7. <span data-ttu-id="0d7cc-125">Вредоносная программа позволяет злоумышленнику повторно украсть имя пользователя и пароль или другие учетные данные с локального компьютера и выполнять другие вредоносные действия.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-125">The malware allows the attacker to re-steal the user's username and password or other credentials from local machine and perform other malicious activities.</span></span>

<span data-ttu-id="0d7cc-126">**Эксплойт форм:**</span><span class="sxs-lookup"><span data-stu-id="0d7cc-126">**The Forms Exploit**:</span></span>

1. <span data-ttu-id="0d7cc-127">Злоумышленник похищает имя пользователя и пароль одного из ваших пользователей.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-127">The attacker steals the username and password of one of your users.</span></span>

2. <span data-ttu-id="0d7cc-128">Затем злоумышленник должен войти в этот почтовый ящик Exchange.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-128">The attacker then sign in to that users Exchange mailbox.</span></span> <span data-ttu-id="0d7cc-129">Почтовый ящик может быть либо в Exchange Online, либо в локальной exchange.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-129">The mailbox can either be in Exchange online or in Exchange on-premises.</span></span>

3. <span data-ttu-id="0d7cc-130">Затем злоумышленник создает настраиваемый шаблон формы почты и вставляет его в почтовый ящик пользователя.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-130">The attacker then creates a custom mail form template and inserts it into the user's mailbox.</span></span> <span data-ttu-id="0d7cc-131">Настраиваемая форма запускается, когда почтовый ящик получает сообщение электронной почты, в которое необходимо загрузить настраиваемую форму.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-131">The custom form is triggered when the mailbox receives an email that requires the mailbox to load the custom form.</span></span> <span data-ttu-id="0d7cc-132">Настраиваемая форма и формат электронной почты адаптированы друг для друга.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-132">The custom form and the format of email are tailor-made for each other.</span></span>
4. <span data-ttu-id="0d7cc-133">Злоумышленник отправляет сообщение с триггером пользователю, который обычно использует свой почтовый ящик.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-133">The attacker sends the trigger email to the user, who is using their mailbox normally.</span></span>

5. <span data-ttu-id="0d7cc-134">При получении электронного письма форма загружается.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-134">When the email is received, the form is loaded.</span></span> <span data-ttu-id="0d7cc-135">Форма запускает приложение на удаленном сервере WebDAV.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-135">The form launches an application on a remote (WebDAV) server.</span></span>

6. <span data-ttu-id="0d7cc-136">Как правило, приложение устанавливает вредоносные программы, такие как [Powershell Вайл,](https://www.powershellempire.com/)локально на компьютере пользователя.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-136">The application typically installs malware, such as [Powershell Empire](https://www.powershellempire.com/), locally on the user's machine.</span></span>

7. <span data-ttu-id="0d7cc-137">Вредоносная программа позволяет злоумышленнику повторно украсть имя пользователя и пароль или другие учетные данные с локального компьютера и выполнять другие вредоносные действия.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-137">The malware allows the attacker to re-steal the user's username and password or other credentials from local machine and perform other malicious activities.</span></span>

## <a name="what-a-rules-and-custom-forms-injection-attack-might-look-like-office-365"></a><span data-ttu-id="0d7cc-138">Как может выглядеть атака с правилами и пользовательскими формами в Office 365?</span><span class="sxs-lookup"><span data-stu-id="0d7cc-138">What a Rules and Custom Forms Injection attack might look like Office 365?</span></span>

<span data-ttu-id="0d7cc-139">Эти механизмы сохраняемости вряд ли будут замечены вашими пользователями и в некоторых случаях даже невидимы для них.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-139">These persistence mechanisms are unlikely to be noticed by your users and may in some cases even be invisible to them.</span></span> <span data-ttu-id="0d7cc-140">В этой статье рассказывается, как искать любые из семи признаков ("Индикаторы компрометации"), перечисленных ниже.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-140">This article tells you how to look for any of the seven signs (Indicators of Compromise) listed below.</span></span> <span data-ttu-id="0d7cc-141">При их поиске необходимо предпринять действия по исправлению.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-141">If you find any of these, you need to take remediation steps.</span></span>

- <span data-ttu-id="0d7cc-142">Индикаторы компрометации правил:</span><span class="sxs-lookup"><span data-stu-id="0d7cc-142">Indicators of the Rules compromise:</span></span>

  - <span data-ttu-id="0d7cc-143">Действие правила — запуск приложения.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-143">Rule Action is to start an application.</span></span>

  - <span data-ttu-id="0d7cc-144">Правило ссылается на EXE-адрес, ZIP-адрес или URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-144">Rule References an EXE, ZIP, or URL.</span></span>

  - <span data-ttu-id="0d7cc-145">На локальном компьютере найди новый процесс, который начинается из PID Outlook.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-145">On the local machine, look for new process starts that originate from the Outlook PID.</span></span>

- <span data-ttu-id="0d7cc-146">Индикаторы компрометации настраиваемой формы:</span><span class="sxs-lookup"><span data-stu-id="0d7cc-146">Indicators of the Custom forms compromise:</span></span>

  - <span data-ttu-id="0d7cc-147">Настраиваемая форма, сохраненная как собственный класс сообщения.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-147">Custom form present saved as their own message class.</span></span>

  - <span data-ttu-id="0d7cc-148">Класс сообщения содержит исполняемый код.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-148">Message class contains executable code.</span></span>

  - <span data-ttu-id="0d7cc-149">Обычно хранится в библиотеке личных форм или папках "Входящие".</span><span class="sxs-lookup"><span data-stu-id="0d7cc-149">Usually stored in Personal Forms Library or Inbox folders.</span></span>

  - <span data-ttu-id="0d7cc-150">Форма называется IPM. Примечание. [пользовательское имя].</span><span class="sxs-lookup"><span data-stu-id="0d7cc-150">Form is named IPM.Note.[custom name].</span></span>

## <a name="steps-for-finding-signs-of-this-attack-and-confirming-it"></a><span data-ttu-id="0d7cc-151">Действия по обнаружению признаков этой атаки и ее подтверждению</span><span class="sxs-lookup"><span data-stu-id="0d7cc-151">Steps for finding signs of this attack and confirming it</span></span>

<span data-ttu-id="0d7cc-152">Для подтверждения атаки можно использовать любой из этих двух методов:</span><span class="sxs-lookup"><span data-stu-id="0d7cc-152">You can use either of these two methods to confirm the attack:</span></span>

- <span data-ttu-id="0d7cc-153">Вручную проверьте правила и формы для каждого почтового ящика с помощью клиента Outlook.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-153">Manually examine the rules and forms for each mailbox using the Outlook client.</span></span> <span data-ttu-id="0d7cc-154">Этот метод является тщательным, но вы можете проверять пользователя почтового ящика только за один раз, что может быть очень трудоемким, если у вас много пользователей для проверки.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-154">This method is thorough, but you can only check mailbox user at a time which can be very time consuming if you have many users to check.</span></span> <span data-ttu-id="0d7cc-155">Это также может привести к нарушению безопасности компьютера, с который вы проводите проверку.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-155">It can also result in a breach of the computer that you are running the check from.</span></span>

- <span data-ttu-id="0d7cc-156">Используйте [ сценарийGet-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell, чтобы автоматически дамп всех правил пересылки почты и настраиваемые формы для всех пользователей в вашем аренде.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-156">Use the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script to automatically dump all the mail forwarding rules and custom forms for all the users in your tenancy.</span></span> <span data-ttu-id="0d7cc-157">Это самый быстрый и безопасный метод с наименьшим объемом накладных расходов.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-157">This is the fastest and safest method with the least amount of overhead.</span></span>

### <a name="confirm-the-rules-attack-using-the-outlook-client"></a><span data-ttu-id="0d7cc-158">Подтверждение атаки правил с помощью клиента Outlook</span><span class="sxs-lookup"><span data-stu-id="0d7cc-158">Confirm the Rules Attack Using the Outlook client</span></span>

1. <span data-ttu-id="0d7cc-159">Откройте клиент Outlook пользователей в качестве пользователя.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-159">Open the users Outlook client as the user.</span></span> <span data-ttu-id="0d7cc-160">Пользователю может потребоваться ваша помощь при проверке правил в его почтовом ящике.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-160">The user may need your help in examining the rules on their mailbox.</span></span>

2. <span data-ttu-id="0d7cc-161">Процедуры [открытия интерфейса](https://support.microsoft.com/office/c24f5dea-9465-4df4-ad17-a50704d66c59) правил в Outlook можно найти в статье "Управление сообщениями электронной почты с помощью правил".</span><span class="sxs-lookup"><span data-stu-id="0d7cc-161">Refer to [Manage email messages by using rules](https://support.microsoft.com/office/c24f5dea-9465-4df4-ad17-a50704d66c59) article for the procedures on how to open the rules interface in Outlook.</span></span>

3. <span data-ttu-id="0d7cc-162">Найди правила, которые пользователь не создал, или непредвиденные правила или правила с подозрительными именами.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-162">Look for rules that the user did not create, or any unexpected rules or rules with suspicious names.</span></span>

4. <span data-ttu-id="0d7cc-163">Посмотрите в описании правила действия правила, которые запускают и приложения или ссылаются на . EXE, . ZIP-файл или запуск URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-163">Look in the rule description for rule actions that start and application or refer to an .EXE, .ZIP file or to launching a URL.</span></span>

5. <span data-ttu-id="0d7cc-164">Найди новые процессы, которые начинают использовать ИД процесса Outlook.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-164">Look for any new processes that start using the Outlook process ID.</span></span> <span data-ttu-id="0d7cc-165">Ссылка на [поиск ИД процесса.](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id)</span><span class="sxs-lookup"><span data-stu-id="0d7cc-165">Refer to [Find the Process ID](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id).</span></span>

### <a name="steps-to-confirm-the-forms-attack-using-the-outlook-client"></a><span data-ttu-id="0d7cc-166">Действия для подтверждения атаки на forms с помощью клиента Outlook</span><span class="sxs-lookup"><span data-stu-id="0d7cc-166">Steps to confirm the Forms attack using the Outlook client</span></span>

1. <span data-ttu-id="0d7cc-167">Откройте клиент Outlook в качестве пользователя.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-167">Open the user Outlook client as the user.</span></span>

2. <span data-ttu-id="0d7cc-168">Выполните действия, которые необходимо предпринять, [на вкладке "Разработчик"](https://support.microsoft.com/office/e1192344-5e56-4d45-931b-e5fd9bea2d45) для пользователей версии Outlook.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-168">Follow the steps in, [Show the Developer tab](https://support.microsoft.com/office/e1192344-5e56-4d45-931b-e5fd9bea2d45) for the users version of Outlook.</span></span>

3. <span data-ttu-id="0d7cc-169">Откройте теперь видимую вкладку разработчика в Outlook и **щелкните "Создать форму".**</span><span class="sxs-lookup"><span data-stu-id="0d7cc-169">Open the now visible developer tab in Outlook and click **design a form**.</span></span>

4. <span data-ttu-id="0d7cc-170">Выберите **"Входящие"** в **списке "Просмотр".**</span><span class="sxs-lookup"><span data-stu-id="0d7cc-170">Select the **Inbox** from the **Look In** list.</span></span> <span data-ttu-id="0d7cc-171">Найми все настраиваемые формы.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-171">Look for any custom forms.</span></span> <span data-ttu-id="0d7cc-172">Настраиваемые формы встречаются достаточно редко, поэтому если у вас есть какие-либо настраиваемые формы, стоит более глубокий вид.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-172">Custom forms are rare enough that if you have any custom forms at all, it is worth a deeper look.</span></span>

5. <span data-ttu-id="0d7cc-173">Изучите все настраиваемые формы, особенно те, которые помечены как скрытые.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-173">Investigate any custom forms, especially those marked as hidden.</span></span>

6. <span data-ttu-id="0d7cc-174">Откройте все настраиваемые формы и в группе **форм** щелкните "Просмотреть **код",** чтобы увидеть, что выполняется при загрузке формы.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-174">Open any custom forms and in the **Form** group click **View Code** to see what runs when the form is loaded.</span></span>

### <a name="steps-to-confirm-the-rules-and-forms-attack-using-powershell"></a><span data-ttu-id="0d7cc-175">Действия для подтверждения атаки на правила и формы с помощью PowerShell</span><span class="sxs-lookup"><span data-stu-id="0d7cc-175">Steps to confirm the Rules and Forms attack using PowerShell</span></span>

<span data-ttu-id="0d7cc-176">Самый простой способ проверить правила или настраиваемую атаку на формы — запустить [ сценарий ](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1)Get-AllTenantRulesAndForms.ps1PowerShell.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-176">The simplest way to verify a rules or custom forms attack is to run the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script.</span></span> <span data-ttu-id="0d7cc-177">Этот сценарий подключается к каждому почтовому ящику в клиенте и создает дампа всех правил и форм в два CSV-файла.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-177">This script connects to every mailbox in your tenant and dumps all the rules and forms into two .csv files.</span></span>

#### <a name="pre-requisites"></a><span data-ttu-id="0d7cc-178">Необходимые условия</span><span class="sxs-lookup"><span data-stu-id="0d7cc-178">Pre-requisites</span></span>

<span data-ttu-id="0d7cc-179">Для запуска сценария необходимы права глобального администратора, так как сценарий подключается к каждому почтовому ящику в аренде для чтения правил и форм.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-179">You will need to have a global administrator rights to run the script because the script connects to every mailbox in the tenancy to read the rules and forms.</span></span>

1. <span data-ttu-id="0d7cc-180">Во sign in to the machine that you will run the script from with with local administrator rights.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-180">Sign in to the machine that you will run the script from with local administrator rights.</span></span>

2. <span data-ttu-id="0d7cc-181">Скачайте или скопируйте Get-AllTenantRulesAndForms.ps1 из GitHub в папку, из которой вы будете его запускать.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-181">Download or copy the Get-AllTenantRulesAndForms.ps1 script from GitHub to a folder from which you will run it.</span></span> <span data-ttu-id="0d7cc-182">Сценарий создаст в этой папке два файла с отметкой даты, MailboxFormsExport-yyyy-mm-dd.csv и MailboxRulesExport-yyyy-mm-dd.csv.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-182">The script will create two date stamped files to this folder, MailboxFormsExport-yyyy-mm-dd.csv, and MailboxRulesExport-yyyy-mm-dd.csv.</span></span>

3. <span data-ttu-id="0d7cc-183">Откройте экземпляр PowerShell от учетной записи администратора и откройте папку, в которая сохранен сценарий.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-183">Open a PowerShell instance as an administrator and open the folder you saved the script to.</span></span>

4. <span data-ttu-id="0d7cc-184">Запустите эту командную строку PowerShell, как по.\Get-AllTenantRulesAndForms.ps1 `.\Get-AllTenantRulesAndForms.ps1`</span><span class="sxs-lookup"><span data-stu-id="0d7cc-184">Run this PowerShell command line as follows `.\Get-AllTenantRulesAndForms.ps1`.\Get-AllTenantRulesAndForms.ps1</span></span>

#### <a name="interpreting-the-output"></a><span data-ttu-id="0d7cc-185">Интерпретация выходных данных</span><span class="sxs-lookup"><span data-stu-id="0d7cc-185">Interpreting the output</span></span>

- <span data-ttu-id="0d7cc-186">**MailboxRulesExport-*yyyy-mm-dd*.csv**: проверьте правила (по одному на строку) на условия действий, которые включают приложения или исполняемые исполняемые приложения:</span><span class="sxs-lookup"><span data-stu-id="0d7cc-186">**MailboxRulesExport-*yyyy-mm-dd*.csv**: Examine the rules (one per row) for action conditions that include applications or executables:</span></span>

  - <span data-ttu-id="0d7cc-187">**ActionType (столбец A).** Если вы видите значение "ID_ACTION_CUSTOM", правило, скорее всего, является вредоносным.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-187">**ActionType (column A)**: If you see the value "ID_ACTION_CUSTOM", the rule is likely malicious.</span></span>

  - <span data-ttu-id="0d7cc-188">**IsPotentiallyMalicious (столбец D)**: если это значение имеет значение TRUE, правило, скорее всего, является вредоносным.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-188">**IsPotentiallyMalicious (column D)**: If this value is "TRUE", the rule is likely malicious.</span></span>

  - <span data-ttu-id="0d7cc-189">**ActionCommand (столбец G)**: если в этом списке перечислены приложение или любой файл с РАСШИРЕНИЕм ZIP или записью, которая ссылается на URL-адрес, который не должен там быть, правило, скорее всего, является вредоносным.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-189">**ActionCommand (column G)**: If this lists an application or any file with a .exe, .zip extension or an entry that refers to a URL, that is not supposed to be there, the rule is likely malicious.</span></span>

- <span data-ttu-id="0d7cc-190">**MailboxFormsExport-*yyy-mm-dd*.csv**: как правило, использование настраиваемой формы очень редко.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-190">**MailboxFormsExport-*yyyy-mm-dd*.csv**: In general, the use of custom forms is very rare.</span></span> <span data-ttu-id="0d7cc-191">Если в этой книге есть такая книга, вы открываете почтовый ящик этого пользователя и проверяете форму.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-191">If you find any in this workbook, you open that user's mailbox and examine the form itself.</span></span> <span data-ttu-id="0d7cc-192">Если ваша организация намеренно не поместила ее в нее, скорее всего, она является вредоносной.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-192">If your organization did not put it there intentionally, it is likely malicious.</span></span>

## <a name="how-to-stop-and-remediate-the-outlook-rules-and-forms-attack"></a><span data-ttu-id="0d7cc-193">Остановка и устранение атак с правилами и формами Outlook</span><span class="sxs-lookup"><span data-stu-id="0d7cc-193">How to stop and remediate the Outlook Rules and Forms attack</span></span>

<span data-ttu-id="0d7cc-194">Если вы найдете какие-либо признаки какой-либо из этих атак, исправление будет простым, просто удалите правило или форму из почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-194">If you find any evidence of either of these attacks, remediation is simple, just delete the rule or form from the mailbox.</span></span> <span data-ttu-id="0d7cc-195">Это можно сделать с помощью клиента Outlook или удаленной powerShell для удаления правил.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-195">You can do this with the Outlook client or using remote PowerShell to remove rules.</span></span>

### <a name="using-outlook"></a><span data-ttu-id="0d7cc-196">Использование Outlook</span><span class="sxs-lookup"><span data-stu-id="0d7cc-196">Using Outlook</span></span>

1. <span data-ttu-id="0d7cc-197">Определите все устройства, которые пользователь использовал с Outlook.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-197">Identify all the devices that the user has used with Outlook.</span></span> <span data-ttu-id="0d7cc-198">Все они должны быть очищены от потенциальной вредоносной программы.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-198">They will all need to be cleaned of potential malware.</span></span> <span data-ttu-id="0d7cc-199">Не разрешайте пользователю вошел и мог использовать электронную почту, пока не будут очищены все устройства.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-199">Do not allow the user to sign on and use email until all the devices are cleaned.</span></span>

2. <span data-ttu-id="0d7cc-200">Выполните действия, которые необходимо [предпринять при удалении правила](https://support.microsoft.com/office/2f0e7139-f696-4422-8498-44846db9067f) для каждого устройства.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-200">Follow the steps in [Delete a rule](https://support.microsoft.com/office/2f0e7139-f696-4422-8498-44846db9067f) for each device.</span></span>

3. <span data-ttu-id="0d7cc-201">Если вы не уверены в наличии других вредоносных программ, вы можете отформатировать и повторно установить все программное обеспечение на устройстве.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-201">If you are unsure about the presence of other malware, you can format and re-install all the software on the device.</span></span> <span data-ttu-id="0d7cc-202">Для мобильных устройств можно следовать шагам изготовителей, чтобы сбросить устройство до заводского образа.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-202">For mobile devices you can follow the manufacturers steps to reset the device to the factory image.</span></span>

4. <span data-ttu-id="0d7cc-203">Установите самые последние версии Outlook.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-203">Install the most up-to-date versions of Outlook.</span></span> <span data-ttu-id="0d7cc-204">Помните, что текущая версия Outlook по умолчанию блокирует оба типа этой атаки.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-204">Remember that the current version of Outlook blocks both types of this attack by default.</span></span>

5. <span data-ttu-id="0d7cc-205">После удаления всех автономных копий почтового ящика сбросйте пароль пользователя (используйте высококачественный) и [](https://docs.microsoft.com/microsoft-365/admin/security-and-compliance/set-up-multi-factor-authentication) следуйте шагам в настройке многофакторной проверки подлинности для пользователей, если многофакторная проверка подлинности еще не включена.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-205">Once all offline copies of the mailbox have been removed, reset the user's password (use a high-quality one) and follow the steps in [Setup multi-factor authentication for users](https://docs.microsoft.com/microsoft-365/admin/security-and-compliance/set-up-multi-factor-authentication) if MFA has not already been enabled.</span></span> <span data-ttu-id="0d7cc-206">Это гарантирует, что учетные данные пользователя не будут выводиться другими способами (например, фишингом или повторно использовать пароль).</span><span class="sxs-lookup"><span data-stu-id="0d7cc-206">This ensures that the user's credentials are not exposed via other means (such as phishing or password re-use).</span></span>

### <a name="using-powershell"></a><span data-ttu-id="0d7cc-207">Использование PowerShell</span><span class="sxs-lookup"><span data-stu-id="0d7cc-207">Using PowerShell</span></span>

<span data-ttu-id="0d7cc-208">Существует два удаленных cmdlets PowerShell, которые можно использовать для удаления или отключения опасных правил.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-208">There are two remote PowerShell cmdlets you can use to remove or disable dangerous rules.</span></span> <span data-ttu-id="0d7cc-209">Просто следуйте этим шагам.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-209">Just follow the steps.</span></span>

#### <a name="steps-for-mailboxes-that-are-on-an-exchange-server"></a><span data-ttu-id="0d7cc-210">Действия для почтовых ящиков, которые находятся на сервере Exchange Server</span><span class="sxs-lookup"><span data-stu-id="0d7cc-210">Steps for mailboxes that are on an Exchange server</span></span>

1. <span data-ttu-id="0d7cc-211">Подключите сервер Exchange Server с помощью удаленной powerShell.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-211">Connect to the Exchange server using remote PowerShell.</span></span> <span data-ttu-id="0d7cc-212">Выполните действия, которые необходимо предпринять при [подключении к серверам Exchange с помощью удаленной powerShell.](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-servers-using-remote-powershell)</span><span class="sxs-lookup"><span data-stu-id="0d7cc-212">Follow the steps in [Connect to Exchange servers using remote PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-servers-using-remote-powershell).</span></span>

2. <span data-ttu-id="0d7cc-213">Если вы хотите полностью удалить одно правило, несколько правил или все [](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule) правила из почтового ящика, используйте его.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-213">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-InboxRule](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule) cmdlet.</span></span>

3. <span data-ttu-id="0d7cc-214">Если вы хотите сохранить правило и его содержимое для дальнейшего исследования, используйте для этого cmdlet [Disable-InboxRule.](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule)</span><span class="sxs-lookup"><span data-stu-id="0d7cc-214">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule) cmdlet.</span></span>

#### <a name="steps-for-mailboxes-in-exchange-online"></a><span data-ttu-id="0d7cc-215">Действия для почтовых ящиков в Exchange Online</span><span class="sxs-lookup"><span data-stu-id="0d7cc-215">Steps for mailboxes in Exchange Online</span></span>

1. <span data-ttu-id="0d7cc-216">Выполните действия, которые необходимо предпринять при [подключении к Exchange Online с помощью PowerShell.](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell)</span><span class="sxs-lookup"><span data-stu-id="0d7cc-216">Follow the steps in [Connect to Exchange Online using PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).</span></span>

2. <span data-ttu-id="0d7cc-217">Если вы хотите полностью удалить одно правило, несколько правил или все правила из почтового ящика, используйте его с помощью [cmdlet Remove-Inbox Rule.](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule)</span><span class="sxs-lookup"><span data-stu-id="0d7cc-217">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-Inbox Rule](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule) cmdlet.</span></span>

3. <span data-ttu-id="0d7cc-218">Если вы хотите сохранить правило и его содержимое для дальнейшего исследования, используйте для этого cmdlet [Disable-InboxRule.](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule)</span><span class="sxs-lookup"><span data-stu-id="0d7cc-218">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule) cmdlet.</span></span>

## <a name="how-to-minimize-future-attacks"></a><span data-ttu-id="0d7cc-219">Как свести к минимуму будущие атаки</span><span class="sxs-lookup"><span data-stu-id="0d7cc-219">How to minimize future attacks</span></span>

### <a name="first-protect-your-accounts"></a><span data-ttu-id="0d7cc-220">Во-первых: защитите свои учетные записи</span><span class="sxs-lookup"><span data-stu-id="0d7cc-220">First: protect your accounts</span></span>

<span data-ttu-id="0d7cc-221">Эксплойт правил и форм используется злоумышленником только после кражи или взлома одной из учетных записей пользователя.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-221">The Rules and Forms exploits are only used by an attacker after they have stolen or breached one of your user's accounts.</span></span> <span data-ttu-id="0d7cc-222">Поэтому первым шагом по предотвращению использования этих эксплойтов в организации является защита учетных записей пользователей.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-222">So, your first step to preventing the use of these exploits against your organization is to aggressively protect your user accounts.</span></span> <span data-ttu-id="0d7cc-223">Некоторые из наиболее распространенных способов взлома учетных записей — фишинговые атаки или [распыление](https://www.dabcc.com/microsoft-defending-against-password-spray-attacks/) паролей.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-223">Some of the most common ways that accounts are breached are through phishing or [password spraying](https://www.dabcc.com/microsoft-defending-against-password-spray-attacks/) attacks.</span></span>

<span data-ttu-id="0d7cc-224">Лучший способ защитить учетные записи пользователей, особенно учетные записи администраторов, — настроить многофакторную проверку [подлинности для пользователей.](https://docs.microsoft.com/microsoft-365/admin/security-and-compliance/set-up-multi-factor-authentication)</span><span class="sxs-lookup"><span data-stu-id="0d7cc-224">The best way to protect your user accounts, and especially your administrator accounts, is to [set up multi-factor authentication for users](https://docs.microsoft.com/microsoft-365/admin/security-and-compliance/set-up-multi-factor-authentication).</span></span> <span data-ttu-id="0d7cc-225">Кроме того, вам следует:</span><span class="sxs-lookup"><span data-stu-id="0d7cc-225">You should also:</span></span>

- <span data-ttu-id="0d7cc-226">Отслеживайте доступ к учетным записям пользователей [и их использования.](https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports)</span><span class="sxs-lookup"><span data-stu-id="0d7cc-226">Monitor how your user accounts are [accessed and used](https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports).</span></span> <span data-ttu-id="0d7cc-227">Начальное нарушение не может быть предотвращено, но его продолжительность и влияние будут сокращены за счет более скорого обнаружения.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-227">You may not prevent the initial breach, but you will shorten the duration and the impact of the breach by detecting it sooner.</span></span> <span data-ttu-id="0d7cc-228">Вы можете использовать эти политики [Office 365 Cloud App Security](https://docs.microsoft.com/cloud-app-security/what-is-cloud-app-security) для отслеживания учетных записей и оповещения о необычных действиях:</span><span class="sxs-lookup"><span data-stu-id="0d7cc-228">You can use these [Office 365 Cloud App Security policies](https://docs.microsoft.com/cloud-app-security/what-is-cloud-app-security) to monitor you accounts and alert on unusual activity:</span></span>

  - <span data-ttu-id="0d7cc-229">Несколько неудачных попыток **входа:** эта политика профилирует среду и вызывает оповещения, когда пользователи выполняют несколько неудачных действий входа в одном сеансе по отношению к заданной базовой оценке, что может указывать на попытку взлома.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-229">**Multiple failed login attempts**: This policy profiles your environment and triggers alerts when users perform multiple failed login activities in a single session with respect to the learned baseline, which could indicate an attempted breach.</span></span>

  - <span data-ttu-id="0d7cc-230">Невозможные перемещения: эта политика профилирует среду и вызывает оповещения при обнаружении действий от одного и того же пользователя в разных местах в течение периода времени, который меньше ожидаемого времени перемещения между двумя расположениями.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-230">**Impossible travel**: This policy profiles your environment and triggers alerts when activities are detected from the same user in different locations within a time period that is shorter than the expected travel time between the two locations.</span></span> <span data-ttu-id="0d7cc-231">Это может указывать на то, что другой пользователь использует одинаковые учетные данные.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-231">This could indicate that a different user is using the same credentials.</span></span> <span data-ttu-id="0d7cc-232">Обнаружение этого аномального поведения требует начального периода обучения в семь дней, в течение которого он получает данные о шаблоне активности нового пользователя.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-232">Detecting this anomalous behavior necessitates an initial learning period of seven days during which it learns a new user's activity pattern.</span></span>

  - <span data-ttu-id="0d7cc-233">Нестандартное обезличенные действия **(по пользователям):** эта политика профилирует среду и вызывает оповещения, когда пользователи выполняют несколько действий, выполнив в одном сеансе действия с учетом выявленных базовых показателей, что может указывать на попытку взлома.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-233">**Unusual impersonated activity (by user)**: This policy profiles your environment and triggers alerts when users perform multiple impersonated activities in a single session with respect to the baseline learned, which could indicate an attempted breach.</span></span>

- <span data-ttu-id="0d7cc-234">Используйте такое средство, как [оценка безопасности Office 365,](https://securescore.office.com/) для управления конфигурациями и поведением учетной записи.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-234">Leverage a tool like [Office 365 Secure Score](https://securescore.office.com/) to manage account security configurations and behaviors.</span></span>

### <a name="second-keep-your-outlook-clients-current"></a><span data-ttu-id="0d7cc-235">Second: Keep your Outlook clients current</span><span class="sxs-lookup"><span data-stu-id="0d7cc-235">Second: Keep your Outlook clients current</span></span>

<span data-ttu-id="0d7cc-236">Полностью обновленные и исправленные версии Outlook 2013 и 2016 отключают действие правила или формы "Запустить приложение" по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-236">Fully-updated and patched versions of Outlook 2013, and 2016 disable the "Start Application" rule/form action by default.</span></span> <span data-ttu-id="0d7cc-237">Это гарантирует, что даже если злоумышленник взломает учетную запись, действия правила и формы будут заблокированы.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-237">This will ensure that, even if an attacker breaches the account, the rule and form actions will be blocked.</span></span> <span data-ttu-id="0d7cc-238">Вы можете установить последние обновления и исправления для системы безопасности, следуя шагам в [области установки обновлений Office.](https://support.microsoft.com/office/2ab296f3-7f03-43a2-8e50-46de917611c5)</span><span class="sxs-lookup"><span data-stu-id="0d7cc-238">You can install the latest updates and security patches by following the steps in [Install Office updates](https://support.microsoft.com/office/2ab296f3-7f03-43a2-8e50-46de917611c5).</span></span>

<span data-ttu-id="0d7cc-239">Вот версии исправлений для клиентов Outlook 2013 и 2016:</span><span class="sxs-lookup"><span data-stu-id="0d7cc-239">Here are the patch versions for your Outlook 2013 and 2016 clients:</span></span>

- <span data-ttu-id="0d7cc-240">**Outlook 2016**: 16.0.4534.1001 или более.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-240">**Outlook 2016**: 16.0.4534.1001 or greater.</span></span>

- <span data-ttu-id="0d7cc-241">**Outlook 2013**: 15.0.4937.1000 или более.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-241">**Outlook 2013**: 15.0.4937.1000 or greater.</span></span>

<span data-ttu-id="0d7cc-242">Дополнительные сведения об отдельных исправлениях безопасности см. в:</span><span class="sxs-lookup"><span data-stu-id="0d7cc-242">For more information on the individual security patches, see:</span></span>

- [<span data-ttu-id="0d7cc-243">Исправление для системы безопасности Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="0d7cc-243">Outlook 2016 Security Patch</span></span>](https://support.microsoft.com/help/3191883)

- [<span data-ttu-id="0d7cc-244">Исправление для системы безопасности Outlook 2013</span><span class="sxs-lookup"><span data-stu-id="0d7cc-244">Outlook 2013 Security Patch</span></span>](https://support.microsoft.com/help/3191938)

### <a name="third-monitor-your-outlook-clients"></a><span data-ttu-id="0d7cc-245">Третий: мониторинг клиентов Outlook</span><span class="sxs-lookup"><span data-stu-id="0d7cc-245">Third: Monitor your Outlook clients</span></span>

<span data-ttu-id="0d7cc-246">Обратите внимание, что даже после установки исправлений и обновлений злоумышленник может изменить конфигурацию локального компьютера, чтобы снова включить поведение "Запустить приложение".</span><span class="sxs-lookup"><span data-stu-id="0d7cc-246">Note that even with the patches and updates installed, it is possible for an attacker to change the local machine configuration to re-enable the "Start Application" behavior.</span></span> <span data-ttu-id="0d7cc-247">С помощью [advanced Group Policy Management](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) вы можете отслеживать и применять политики локальных компьютеров на своих клиентах.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-247">You can use [Advanced Group Policy Management](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) to monitor and enforce local machine policies on your clients.</span></span>

<span data-ttu-id="0d7cc-248">Чтобы узнать, включено ли повторное использование "Запуска приложения" через переопределения в реестре, можно использовать сведения в [64-битных](https://support.microsoft.com/help/305097)версиях Windows, чтобы просмотреть системный реестр.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-248">You can to see if "Start Application" has been re-enabled through an override in the registry by using the information in [How to view the system registry by using 64-bit versions of Windows](https://support.microsoft.com/help/305097).</span></span> <span data-ttu-id="0d7cc-249">Проверьте эти подмайки:</span><span class="sxs-lookup"><span data-stu-id="0d7cc-249">Check these subkeys:</span></span>

- <span data-ttu-id="0d7cc-250">**Outlook 2016:**`HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\`</span><span class="sxs-lookup"><span data-stu-id="0d7cc-250">**Outlook 2016**: `HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\`</span></span>

- <span data-ttu-id="0d7cc-251">**Outlook 2013:**`HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\`</span><span class="sxs-lookup"><span data-stu-id="0d7cc-251">**Outlook 2013**: `HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\`</span></span>

<span data-ttu-id="0d7cc-252">Найми ключ EnableUnsafeClientMailRules.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-252">Look for the key EnableUnsafeClientMailRules.</span></span> <span data-ttu-id="0d7cc-253">Если он существует и имеет 1, исправление безопасности Outlook переопределено, и компьютер является уязвимым к атаке на формы и правила.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-253">If it is there and is set to 1, the Outlook security patch has been overridden and the computer is vulnerable to the Form/Rules attack.</span></span> <span data-ttu-id="0d7cc-254">Если значение 0, действие "Запустить приложение" отключено.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-254">If the value is 0, the "Start Application" action is disabled.</span></span> <span data-ttu-id="0d7cc-255">Если установлена обновленная и исправленная версия Outlook, а этот ключ реестра не существует, система не будет уязвимой для этих атак.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-255">If the updated and patched version of Outlook is installed and this registry key is not present, then a system is not vulnerable to these attacks.</span></span>

<span data-ttu-id="0d7cc-256">Клиентам с локальной установкой Exchange следует рассмотреть возможность блокировки более старых версий Outlook, в них нет доступных исправлений.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-256">Customers with on-premises Exchange installations should consider blocking older versions of Outlook that do not have patches available.</span></span> <span data-ttu-id="0d7cc-257">Подробные сведения об этом процессе можно найти в статье "Настройка [блокировки клиента Outlook".](https://docs.microsoft.com/exchange/configure-outlook-client-blocking-exchange-2013-help)</span><span class="sxs-lookup"><span data-stu-id="0d7cc-257">Details on this process can be found in the article [Configure Outlook client blocking](https://docs.microsoft.com/exchange/configure-outlook-client-blocking-exchange-2013-help).</span></span>

## <a name="secure-microsoft-365-like-a-cybersecurity-pro"></a><span data-ttu-id="0d7cc-258">Защитите Microsoft 365 на профессиональном уровне</span><span class="sxs-lookup"><span data-stu-id="0d7cc-258">Secure Microsoft 365 like a cybersecurity pro</span></span>

<span data-ttu-id="0d7cc-259">Для вашей подписки Microsoft 365 предусмотрен целый ряд полезных функций безопасности, которые можно использовать для защиты ваших данных и пользователей.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-259">Your Microsoft 365 subscription comes with a powerful set of security capabilities that you can use to protect your data and your users.</span></span> <span data-ttu-id="0d7cc-260">Используйте статью к [Стратегия развития безопасности Microsoft 365: приоритеты на первые 30 дней, 90 дней и далее](security-roadmap.md), чтобы применить лучшие методики, рекомендованные корпорацией Майкрософт, для защиты вашего клиента Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-260">Use the [Microsoft 365 security roadmap - Top priorities for the first 30 days, 90 days, and beyond](security-roadmap.md) to implement Microsoft recommended best practices for securing your Microsoft 365 tenant.</span></span>

- <span data-ttu-id="0d7cc-261">Задачи для выполнения в первые 30 дней.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-261">Tasks to accomplish in the first 30 days.</span></span> <span data-ttu-id="0d7cc-262">Они дают немедленный эффект и не создают помех вашим пользователям.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-262">These have immediate affect and are low-impact to your users.</span></span>

- <span data-ttu-id="0d7cc-263">Задачи для выполнения в течение 90 дней.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-263">Tasks to accomplish in 90 days.</span></span> <span data-ttu-id="0d7cc-264">Эти задачи требуют немного больше времени на планирование и реализацию, но значительно укрепляют вашу безопасность.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-264">These take a bit more time to plan and implement but greatly improve your security posture.</span></span>

- <span data-ttu-id="0d7cc-265">Более 90 дней.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-265">Beyond 90 days.</span></span> <span data-ttu-id="0d7cc-266">Эти меры дополняют ваши действия в течение первых 90 дней.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-266">These enhancements build in your first 90 days work.</span></span>

## <a name="see-also"></a><span data-ttu-id="0d7cc-267">См. также:</span><span class="sxs-lookup"><span data-stu-id="0d7cc-267">See also:</span></span>

- <span data-ttu-id="0d7cc-268">[Вредоносные правила Outlook](https://silentbreaksecurity.com/malicious-outlook-rules/) с помощью SilentBreak Security Post о векторе правил предоставляют подробный обзор того, как правила Outlook.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-268">[Malicious Outlook Rules](https://silentbreaksecurity.com/malicious-outlook-rules/) by SilentBreak Security Post about Rules Vector provides a detailed review of how the Outlook Rules.</span></span>

- <span data-ttu-id="0d7cc-269">[MapI over HTTP и Mailrule Pwnage](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) в блоге Sensepost о Mailrule Pwnage обсуждают средство под названием Ruler, которое позволяет использовать почтовые ящики с помощью правил Outlook.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-269">[MAPI over HTTP and Mailrule Pwnage](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) on the Sensepost blog about Mailrule Pwnage discusses a tool called Ruler that lets you exploit mailboxes through Outlook rules.</span></span>

- <span data-ttu-id="0d7cc-270">[Формы и оболочки Outlook](https://sensepost.com/blog/2017/outlook-forms-and-shells/) в блоге Sensepost о векторе угрозы форм.</span><span class="sxs-lookup"><span data-stu-id="0d7cc-270">[Outlook forms and shells](https://sensepost.com/blog/2017/outlook-forms-and-shells/) on the Sensepost blog about Forms Threat Vector.</span></span>

- [<span data-ttu-id="0d7cc-271">Ruler Codebase</span><span class="sxs-lookup"><span data-stu-id="0d7cc-271">Ruler Codebase</span></span>](https://github.com/sensepost/ruler)

- [<span data-ttu-id="0d7cc-272">Индикаторы компрометации линейки</span><span class="sxs-lookup"><span data-stu-id="0d7cc-272">Ruler Indicators of Compromise</span></span>](https://github.com/sensepost/notruler/blob/master/iocs.md)
