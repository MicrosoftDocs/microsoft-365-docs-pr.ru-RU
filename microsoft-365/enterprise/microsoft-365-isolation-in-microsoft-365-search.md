---
title: Изоляция клиента в поиске Microsoft 365
ms.author: robmazz
author: robmazz
manager: laurawi
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
f1.keywords:
- NOCSH
description: В этой статье найдите объяснение работы изоляции клиента для раздельного хранения данных клиента в Microsoft 365 Search.
ms.custom: seo-marvel-apr2020
ms.openlocfilehash: 3416afdeceaa7000b516ec89b4a2a1e59d8708d0
ms.sourcegitcommit: c029834c8a914b4e072de847fc4c3a3dde7790c5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "47332404"
---
# <a name="tenant-isolation-in-microsoft-365-search"></a>Изоляция клиента в поиске Microsoft 365

SharePoint Поиск в Интернете использует модель разделения клиента, которая уравновешивания эффективности общих структур данных с защитой от утечки информации между арендаторами. С помощью этой модели мы не мешаем функциям поиска:

- Возвращение результатов запроса, содержащих документы от других клиентов
- Анализ достаточной информации в запросе приводит к выводу, что опытный пользователь может сделать вывод о других клиентах.
- Отображение схемы или параметров другого клиента
- Смешивание сведений об обработке аналитики между арендаторами или хранилищем приводит к неправильному клиенту
- Использование записей словарей от другого клиента

Для каждого типа данных клиента мы используем один или несколько уровней защиты в коде для предотвращения случайной утечки информации. Наиболее важные данные обладает самыми слоями защиты, чтобы убедиться, что один дефект не приведет к фактической или предполагаемой утечке информации.

## <a name="tenant-separation-for-the-search-index"></a>Разделение клиента для индекса поиска

Индекс поиска хранится на диске на серверах, на которые размещены компоненты индекса, а клиенты делятся файлами индекса. Индексные документы клиента видны только для запросов для этого клиента. Три независимых механизма предотвращают утечку информации:

- Фильтрация ID клиента
- Префикс терминов tenant ID
- Проверки ACL

Все три механизма должны были бы не возвращать документы неправильному клиенту.

## <a name="tenant-id-filtering-and-tenant-id-term-prefixing"></a>Фильтрация ID клиента и префикс терминов tenant ID

Поиск префиксирует каждый термин, который индексируется в полно текстовом индексе с ИД клиента. Например, при индексации термина *"foo"* для клиента с ИД *"123",* запись в полно текстовом индексе является *"123foo".*

Каждый запрос преобразуется для включаемого ID клиента с помощью процесса фильтрации ID клиента. Например, запрос *"foo"* преобразуется в "<*guid*>. *foo* AND *tenantID*:<*guid*>", <*guid*> представляет клиента, который выполняет запрос. Преобразование запроса происходит в каждом узле индекса, и ни запрос, ни обработка контента не могут повлиять на него. Так как идентификация клиента добавляется к каждому запросу, частота термина в других клиентах не может быть высвечена, если посмотреть на лучший рейтинг совпадений в одном клиенте.

Префикс терминов tenant ID происходит только в полно текстовом индексе. Выполнимые поиски, такие как *"title:foo",* перейдите к синтетическому индексу поиска, где термины не префиксироваться по ID клиента. Вместо этого выполняется префикс полевых поисков с именем поля. Например, запрос *"title:foo"* преобразуется в *"fields.title:foo и fields.tenantID*:<*guid*>". Так как частота термина не влияет на ранжирование попаданий в синтетическом индексе поиска, нет необходимости в разделении клиента с помощью префиксирования терминов. Для поля поиска типа *"title:foo"* разделение контента клиента зависит от фильтрации ID клиента путем преобразования запроса.

## <a name="document-access-control-list-checks"></a>Проверка списка управления доступом к документам

Поиск контролирует доступ к документам с помощью acLs, сохраненных в индексе поиска. Каждый элемент индексироваться с набором терминов в специальном поле ACL. Поле ACL содержит один термин для группы или пользователя, который может просматривать документ. Каждый запрос дополняется списком терминов записи управления доступом (ACE), по одному для каждой группы, к которой принадлежит авторификация пользователя.

Например, запрос типа "<*guid*>. *Foo AND tenantID*:<*guid*>" становится: "<*guid*>. *foo И tenantID*:<*guid* >  *AND* *(docACL:* < *ace1* >  *OR docACL*:<*ace2* >  *OR docACL*:<*ace3* >  *...*)"

Так как идентификаторы пользователей и групп и, следовательно, acEs уникальны, это обеспечивает дополнительный уровень безопасности между арендаторами для документов, которые видны только некоторым пользователям. То же самое касается специального ACE "Все, кроме внешних пользователей", который предоставляет доступ к обычным пользователям в клиенте. Но так как acEs для "Все" одинаковы для всех клиентов, разделение клиента для общедоступных документов зависит от фильтрации ID клиента. Поддержка acEs также поддерживается. В дополнении запроса добавляется пункт, который удаляет документ из результатов при совпадении с ACE отказа.

В Exchange Online поиске индекс разделяется на ID почтовых ящиков для почтовых ящиков отдельных пользователей вместо ID клиента (подписки), как в SharePoint Online. Механизм раздела такой же, как SharePoint Online, но фильтрации ACL не существует.
