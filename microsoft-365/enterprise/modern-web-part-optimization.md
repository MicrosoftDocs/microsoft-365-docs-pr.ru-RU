---
title: Оптимизация производительности веб-частей страниц современных сайтов SharePoint Online
ms.author: kvice
author: kelleyvice-msft
manager: laurawi
ms.date: 03/11/2020
audience: Admin
ms.topic: conceptual
ms.service: o365-administration
localization_priority: Normal
ms.collection:
- Ent_O365
- Strat_O365_Enterprise
- SPO_Content
f1.keywords:
- CSH
ms.custom:
- Adm_O365
- seo-marvel-apr2020
ms.reviewer: sstewart
search.appverid:
- MET150
description: Узнайте, как использовать page Diagnostics для оптимизации производительности веб-частей на SharePoint веб-страниц.
ms.openlocfilehash: 2a72ecd8bc1f6dee4166809f72ce5f9bce422dc9
ms.sourcegitcommit: 27b2b2e5c41934b918cac2c171556c45e36661bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "50929064"
---
# <a name="optimize-web-part-performance-in-sharepoint-online-modern-site-pages"></a>Оптимизация производительности веб-частей страниц современных сайтов SharePoint Online

Страницы современного сайта SharePoint Online содержат веб-части, которые могут влиять на общее время загрузки страниц. Из этой статьи вы узнаете, как определять, насколько веб-части на страницах влияют на задержку, распознаваемую конечным пользователем, и как устранять распространенные проблемы.

>[!NOTE]
>Дополнительные сведения о производительности на современных порталах SharePoint Online см. в статье [Производительность в современном интерфейсе SharePoint](/sharepoint/modern-experience-performance).

## <a name="use-the-page-diagnostics-for-sharepoint-tool-to-analyze-web-parts"></a>Использование средства диагностики страниц SharePoint для анализа веб-частей

Средство "Диагностика страниц SharePoint" — это браузерное расширение для браузеров Chrome и новой версии Microsoft Edge (https://www.microsoft.com/edge), анализирующее страницы современных и классических сайтов публикаций SharePoint Online. Это средство предоставляет отчет о каждой проанализированной странице, показывающий, как она работает при заданных критериях производительности. Чтобы установить и изучить средство диагностики страниц SharePoint, ознакомьтесь со статьей [Использование средства диагностики страниц SharePoint Online](page-diagnostics-for-spo.md).

>[!NOTE]
>Средство диагностики страниц работает только в SharePoint Online, и его нельзя использовать на системной странице SharePoint.

При анализе сайта SharePoint с помощью средства диагностики страниц SharePoint можно просматривать данные о веб-частях, превышающие базовые показатели, которые указаны для результата **Влияние веб-частей на общее время загрузки страниц** на панели _Диагностические тесты_.

Возможные результаты:

- **Внимание** (красный цвет) — любая _настраиваемая_ веб-часть, видимая в окне просмотра (видимая часть страницы, загружаемая первой) и требующая более **двух** секунд на загрузку. Любые _настраиваемые_ веб-части за пределами окна просмотра, требующие более **четырех** секунд на загрузку. Общее время загрузки распределяется в результатах теста в зависимости от времени, потраченного на загрузку модулей, отложенную загрузку, инициализацию и отображение.
- **Возможна оптимизация** (желтый цвет) — требующие проверки и контроля элементы, которые могут влиять на время загрузки страницы. Среди них могут быть готовые веб-части Майкрософт. Результаты для всех веб-частей Майкрософт, приведенные в этом разделе, автоматически направляются в корпорацию Майкрософт, поэтому **никакие действия не требуются**. Если результаты анализа **всех веб-частей Майкрософт** на странице отображаются в разделе **Возможна оптимизация**, а вы столкнулись с очень низкой производительностью на странице, тогда следует отправить запрос в службу поддержки. Обратите внимание, что при последующих обновлениях средство диагностики страниц SharePoint будет группировать результаты в соответствии с определенными конфигурациями веб-частей Майкрософт.
- **Действия не требуются** (зеленый цвет) — для возвращения данных все веб-части не занимают больше **двух** секунд времени.

Если в разделе **Возможна оптимизация** или **Внимание** появится результат **Влияние веб-частей на общее время загрузки страниц**, щелкните его, чтобы посмотреть, какие веб-части загружаются медленно. В последующих обновлениях средства диагностики страниц SharePoint могут быть обновленные правила анализа, поэтому убедитесь, что у вас всегда есть последняя версия средства.

![Результаты диагностики страниц](../media/modern-portal-optimization/pagediag-web-part.png)

Результаты содержат следующие данные:

- **Сделано показано,** является ли веб-часть настраиваемой или Microsoft OOTB.
- **Имя и ID** показывают идентифицирующие сведения, которые помогут найти веб-часть на странице.
- **Total** показывает общее время загрузки модуля, инициализации и отрисовки веб-части. Это общее относительное время, заемного веб-частью для отрисовки на странице от начала до конца.
- **МодульНая** нагрузка показывает время загрузки, оценки и загрузки файлов JavaScript и CSS. Затем начнется процесс Init.
- **Лентяйная** нагрузка показывает время отложенной загрузки веб-частей, не показанных в основном разделе страницы. Существуют определенные условия, при которых слишком много веб-частей для отрисовки, и они стоят в очереди, чтобы отрисовка свести к минимуму время загрузки страницы.
- **Init** показывает время, необходимое веб-части для инициализации данных.
    Это асинхронный вызов, и время init — это вычисление времени для функции onInit, когда возвращенное обещание будет разрешено.
- **Отрисовка** показывает время, необходимое для отображения пользовательского интерфейса (пользовательского интерфейса) после завершения загрузки модуля и Init.
    Время выполнения JavaScript для установки DOM в документе (странице).
    Для отрисовки асинхронных ресурсов, например изображений, может потребоваться дополнительное время.

Эта информация предназначена для того, чтобы помочь проектировщикам и разработчикам устранять проблемы. С ней следует ознакомить команду по проектированию и разработке.

## <a name="remediate-web-part-performance-issues"></a>Устранение проблем производительности веб-частей

Чтобы определить и устранить проблемы с производительностью веб-частей, указанных в окне **Влияние веб-частей на общее время загрузки страниц**, используйте инструкции, приведенные в этом разделе.

Возможные причины низкой производительности веб-части делятся на три категории. С помощью приведенной ниже информации можно определить, какие проблемы относятся к вашему сценарию, и устранить их.

- Размер скрипта веб-части и зависимости
  - Оптимизируйте исходный сценарий, который отображает основной сценарий _только в режиме просмотра_.
  - Переместите редко используемые сценарии и код режима изменения (например, панель свойств) в отдельные блоки с помощью оператора _import()_.
  - Ознакомьтесь с зависимостями в файле _package.json_, чтобы полностью удалить ненужный код. Переместите зависимости "только тестирование" или "только сборка" в раздел devDependencies.
  - Для оптимальной статической загрузки ресурсов следует использовать сеть доставки содержимого (CDN) Office 365. Открытые источники CDN предпочтительнее использовать для файлов _JS и CSS_. Дополнительные сведения о сети Office 365 CDN см. в статье [Использование сети доставки содержимого Office 365 с SharePoint Online](use-microsoft-365-cdn-with-spo.md).
  - Повторно используйте такие платформы, как _React_ и _Fabric imports_, которые входят в состав SharePoint Framework (SPFx). Дополнительные сведения см. в статье [Обзор SharePoint Framework](/sharepoint/dev/spfx/sharepoint-framework-overview).
  - Убедитесь, что у вас установлена последняя версия SharePoint Framework, и обновляйте до новых версий, когда они станут доступны.
- Извлечение или кэширование данных
  - Если веб-часть использует дополнительные вызовы серверов для получения данных для отображения, убедитесь, что эти API сервера являются быстрыми и/или реализуют кэшацию сторон клиента (например, с помощью _localStorage_ или _IndexedDB_ для больших наборов).
  - Если для отображения важных данных требуется несколько вызовов, воспользуйтесь пакетной обработкой на сервере или другими методами объединения запросов в один вызов.
  - Если определенные данные задействуют медленные серверные API, а отображение может начаться и без них, рекомендуется отделить их в независимый вызов, который будет выполнен после отображения критически важных данных.
  - Когда одни и те же данные повторяются в разных частях, используйте один уровень данных, чтобы избежать повторения вызовов.
- Время отображения
  - Любые мультимедийные источники, такие как изображения и видеоролики, следует уменьшать до размера контейнера, устройства и (или) сети во избежание загрузки ненужных больших активов. Дополнительные сведения о пакетных зависимостях см. в статье [Использование сети доставки содержимого Office 365 с SharePoint Online](use-microsoft-365-cdn-with-spo.md).
  - Избегайте вызовов API, которые приводят к перегруппировке, применению сложных правил CSS или сложной анимации. Дополнительные сведения см. в статье [Минимизация перегруппировки браузера](https://developers.google.com/speed/docs/insights/browser-reflow).
  - Избегайте выполнения длительных цепных задач. Разбивайте такие задачи на отдельные очереди. Дополнительные сведения см. в статье [Оптимизация выполнения JavaScript](https://developers.google.com/web/fundamentals/performance/rendering/optimize-javascript-execution).
  - Резервируйте соответствующее место для асинхронного отображения визуальных элементов или элементов мультимедиа, чтобы избежать пропуска кадров и перебоев, известных как _подвисания_.
  - Если какой-либо из браузеров не поддерживает функцию, используемую для отображения, загрузите полизаполнение или исключите выполнение зависимого кода. А если эта функция не является критической, удалите ресурсы, например, обработчики событий, чтобы избежать утечки памяти.

Перед изменением в страниц для устранения проблем производительности запомните время загрузки страницы по результатам анализа. Снова запустите средство после внесения изменений, чтобы узнать, соответствует ли новый результат базовому стандарту, и проверить, сократилось ли время загрузки.

![Анализ времени загрузки страницы](../media/modern-portal-optimization/pagediag-page-load-time.png)

>[!NOTE]
>Время загрузки страницы зависит от множества факторов, например от загрузки сети, времени суток и других переменных условий. Следует несколько раз проверить время загрузки страницы до и после внесения изменений, чтобы получить среднестатистические данные.

## <a name="related-topics"></a>Статьи по теме

[Настройка производительности SharePoint Online](tune-sharepoint-online-performance.md)

[Настройка производительности Office 365](tune-microsoft-365-performance.md)

[Производительность в современном интерфейсе SharePoint](/sharepoint/modern-experience-performance)

[Сети доставки содержимого](content-delivery-networks.md)

[Использование сети доставки содержимого Office 365 с SharePoint Online](use-microsoft-365-cdn-with-spo.md)