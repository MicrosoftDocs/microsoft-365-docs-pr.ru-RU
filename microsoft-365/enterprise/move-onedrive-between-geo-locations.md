---
title: Перемещение сайта OneDrive в другой геообъект
ms.reviewer: adwood
ms.author: mikeplum
author: MikePlumleyMSFT
manager: pamgreen
audience: ITPro
ms.topic: article
ms.service: o365-solutions
f1.keywords:
- NOCSH
ms.custom: seo-marvel-apr2020
ms.collection:
- Strat_SP_gtc
- SPO_Content
localization_priority: Normal
description: Сведения о перемещении OneDrive в другое географическое расположение, в том числе о том, как планировать перемещения сайта и связывать ожидания пользователей.
ms.openlocfilehash: 9e75c8e4102f82d4ab6e0f99ea26e1c0ad8b4bab
ms.sourcegitcommit: f7fbf45af64c5c0727fd5eaab309d20ad097a483
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/09/2021
ms.locfileid: "53362250"
---
# <a name="move-a-onedrive-site-to-a-different-geo-location"></a>Перемещение сайта OneDrive в другой геообъект 

С OneDrive перемещения по гео, вы можете переместить OneDrive пользователя в другое географическое расположение. OneDrive выполняется администратором SharePoint Online или глобальным администратором Microsoft 365. Перед началом OneDrive, обязательно уведомите пользователя, OneDrive которого перемещается OneDrive, и порекомендуйте закрыть все файлы на время перемещения. (Если у пользователя открыт документ с Office клиентом во время перемещения, после завершения перемещения документ необходимо сохранить в новом расположении.) При желании перемещение может быть назначено в течение будущего времени.

Служба OneDrive использует azure Blob служба хранилища для хранения контента. Blob служба хранилища, связанный с OneDrive пользователя, будет перемещен из источника в расположение гео назначения в течение 40 дней с точки OneDrive для пользователя. Доступ к данным пользователя OneDrive, как только появится OneDrive назначения.

Во OneDrive окне перемещения (около 2-6 часов) OneDrive пользователя устанавливается только для чтения. Пользователь по-прежнему может получать доступ к своим файлам через приложение приложение синхронизации OneDrive или веб-сайт OneDrive в SharePoint Online. После OneDrive перемещения по геополизии пользователь будет автоматически подключен к OneDrive в географическом расположении OneDrive в пусковой Microsoft 365 приложения. Приложение синхронизации автоматически начнет синхронизацию с нового расположения.

Процедуры, описываемые в этой статье, требуют наличия [модуля Microsoft SharePoint Online для PowerShell](https://www.microsoft.com/download/details.aspx?id=35588).

## <a name="communicating-to-your-users"></a>Общение с пользователями

При перемещении сайтов OneDrive из одного географического расположения в другое важно объяснить пользователям, чего ожидать. Это поможет избежать недоразумений и снизит количество обращений в службу поддержки. Перед тем как начать перемещение, отправьте пользователям по электронной почте следующую информацию:

- время начала перемещения и его длительность;
- географическое расположение, в которое переносится OneDrive, и новый URL-адрес для доступа к нему;
- напомните, что необходимо закрыть файлы и не редактировать их во время перемещения;
- после перемещения разрешения для файлов и параметры общего доступа к файлам остаются без изменений;
- чего ожидать от [пользовательского интерфейса в среде с поддержкой нескольких регионов](multi-geo-user-experience.md).

Обязательно известите пользователей об успешном окончании перемещения и сообщите, что они могут возобновить работу в OneDrive.

## <a name="scheduling-onedrive-site-moves"></a>Планирование перемещений сайтов OneDrive

Вы можете заранее спланировать перемещения сайтов OneDrive (описано далее в этой статье). Рекомендуется начать с небольшого количества пользователей для проверки рабочих процессов и стратегий коммуникации. После ознакомления с процессом можно планировать перемещения следующим образом:

- Можно запланировать до 4000 перемещений за один раз.
- После начала перемещения можно продолжить планирование, не превышая 4000 ожидаемых перемещений в очереди в любой момент времени.
- Максимальный размер OneDrive, который можно переместить, составляет 1 терабайт (1 ТБ).

## <a name="moving-a-onedrive-site"></a>Перемещение сайта OneDrive

Чтобы выполнить OneDrive, администратор клиента должен сначала установить предпочтительное расположение данных пользователя (PDL) в соответствующем географическом расположении. После задатки PDL подождите по крайней мере 24 часа, пока обновление PDL синхронизируется между географическими расположениями перед началом OneDrive geo move.

При использовании cmdlets geo move подключайтесь к службе SPO в текущем расположении OneDrive пользователя, используя следующий синтаксис:

`Connect-SPOService -url https://<tenantName>-admin.sharepoint.com`

Например. Чтобы переместить OneDrive пользователя Matt@contosoenergy.onmicrosoft.com, подключись к центру администрирования EUR SharePoint, так как OneDrive пользователя находится в географическом расположении EUR:

`Connect-SPOSservice -url https://contosoenergyeur-admin.sharepoint.com`

![Снимок экрана: окно PowerShell с командлетом connect-sposervice](../media/move-onedrive-between-geo-locations-image1.png)

## <a name="validating-the-environment"></a>Проверка среды

Прежде чем начинать перемещение OneDrive в отношении геообъекта, рекомендуем проверить среду.

Чтобы проверить, все ли геообъекты совместимы, выполните такую команду:

`Get-SPOGeoMoveCrossCompatibilityStatus`

Вы увидите список ваших геообъектов, а контент, который можно перемещать между ними будет обозначен как Compatible (Совместимый). Если команда возвращает значение Incompatible (Несовместимый), попробуйте проверить состояние позднее.

Переместить службу OneDrive невозможно, если она, к примеру, содержит дочерний сайт. Чтобы проверить возможность перемещения OneDrive, выполните командлет Start-SPOUserAndContentMove с параметром -ValidationOnly.

`Start-SPOUserAndContentMove -UserPrincipalName <UPN> -DestinationDataLocation <DestinationDataLocation> -ValidationOnly`

Если служба OneDrive готова к перемещению, вернется отклик, указывающий на успешное выполнение. Если же есть состояние удержания по юридическим причинам или дочерний сайт, что будет препятствовать перемещению, вернется отклик, указывающий на ошибку. Убедившись в том, что служба OneDrive готова к перемещению, начинайте эту процедуру.

## <a name="start-a-onedrive-geo-move"></a>Перемещение OneDrive в отношении геообъекта

Чтобы начать перемещение, выполните такую команду:  

`Start-SPOUserAndContentMove -UserPrincipalName <UserPrincipalName> -DestinationDataLocation <DestinationDataLocation>`

Используйте эти параметры:

-   _UserPrincipalName_ — имя участника-пользователя, OneDrive которого перемещается.

-   _DestinationDataLocation_ — Geo-Location, OneDrive необходимо переместить OneDrive. Это должно быть то же самое, что и предпочтительное расположение данных пользователя.

Например, чтобы переместить OneDrive matt@contosoenergy.onmicrosoft.com из Европы в Австралию, выполните такую команду:

`Start-SPOUserAndContentMove -UserPrincipalName matt@contosoenergy.onmicrosoft.com -DestinationDataLocation AUS`

![Снимок экрана: окно PowerShell с командлетом Start-SPOUserAndContentMove](../media/move-onedrive-between-geo-locations-image2.png)

Чтобы запланировать перемещение в отношении геообъекта на более позднее время, используйте один из следующих параметров:

-   _PreferredMoveBeginDate_ — предполагаемое время начала перемещения. Должно быть задано в формате UTC.

-   _PreferredMoveEndDate_ — предполагаемое время завершения перемещения (самый короткий период). Должно быть задано в формате UTC. 

## <a name="cancel-a-onedrive-geo-move"></a>Отмена перемещения OneDrive в отношении геообъекта 

При условии, что перемещение не выполнено или завершено с помощью cmdlet, можно остановить перемещение по OneDrive пользователя.

`Stop-SPOUserAndContentMove – UserPrincipalName <UserPrincipalName>`

Здесь _UserPrincipalName_ — имя участника-пользователя, перемещение OneDrive которого нужно остановить.

## <a name="determining-current-status"></a>Определение текущего состояния

Вы можете проверить состояние гео OneDrive перемещения в или из гео, к который вы подключены с помощью Get-SPOUserAndContentMoveState cmdlet.

Состояния перемещения описаны в приведенной ниже таблице.

<table>
<thead>
<tr class="header">
<th align="left">Состояние</th>
<th align="left">Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NotStarted</td>
<td align="left">Перемещение не начато.</td>
</tr>
<tr class="even">
<td align="left">InProgress (<em>n</em>/4)</td>
<td align="left">Перемещение в процессе и находится в одном из следующих состояний: "проверка" (1/4), "резервное копирование" (2/4), "восстановление" (3/4), "очистка" (4/4).</td>
</tr>
<tr class="odd">
<td align="left">Success</td>
<td align="left">Перемещение успешно завершено.</td>
</tr>
<tr class="even">
<td align="left">Failed</td>
<td align="left">Перемещение не удалось выполнить.</td>
</tr>
</tbody>
</table>

Чтобы найти состояние перемещения конкретного пользователя, используйте параметр UserPrincipalName:

`Get-SPOUserAndContentMoveState -UserPrincipalName <UPN>`

Чтобы найти состояние всех ходов в или из геолокации, с чем вы подключены, используйте параметр MoveState с одним из следующих значений: NotStarted, InProgress, Success, Failed, All.

`Get-SPOUserAndContentMoveState -MoveState <value>`

Для более подробного описания состояния перемещения вы можете добавить параметр `-Verbose`.

## <a name="user-experience"></a>Взаимодействие с пользователем

Перемещение OneDrive пользователей в другой геообъект должно проходить максимально незаметно для них. Если не считать кратковременного состояния доступа только для чтения при перемещении, после завершения этого процесса существующие ссылки и разрешения будут доступны в обычном режиме.

### <a name="users-onedrive"></a>Хранилище OneDrive пользователя

Пока ход находится в процессе выполнения, OneDrive настроено только для чтения. После завершения перемещения пользователь направляется к OneDrive в новом географическом расположении при переходе OneDrive запуска Microsoft 365 приложения или веб-браузера.

### <a name="permissions-on-onedrive-content"></a>Разрешения для содержимого OneDrive

Пользователи с разрешениями OneDrive контента будут по-прежнему иметь доступ к содержимому во время перемещения и после его завершения.

### <a name="onedrive-sync-app"></a>приложение синхронизации OneDrive приложение 

Приложение приложение синхронизации OneDrive автоматически обнаруживает и плавно переносит синхронизацию в новое расположение OneDrive после завершения OneDrive перемещения по гео. Пользователю не нужно снова входить или принимать какие-либо другие действия.  (Версия 17.3.6943.0625 или более поздней версии требуемого приложения синхронизации.)

Если пользователь обновляет файл во время OneDrive, приложение синхронизации уведомляет его о том, что загрузка файлов ожидается во время перемещения.

### <a name="sharing-links"></a>Предоставление ссылок 

Когда перемещение OneDrive в отношении геообъекта будет завершено, для существующих предоставленных ссылок на перемещенные файлы будет автоматически выполняться перенаправление на новый геообъект.

### <a name="onenote-experience"></a>Интерфейс OneNote 

Когда перемещение OneDrive в отношении геообъекта будет завершено, приложение UWP (универсальное) и клиент OneNote win32 автоматически обнаружат и легко синхронизируют записные книжки с новым расположением OneDrive. Пользователю не нужно будет выполнять повторный вход или любые другие действия. Во время выполнения перемещения OneDrive в отношении геообъекта единственным отображаемым индикатором для пользователя является уведомление об ошибке синхронизации записной книжки. Эта возможность доступна для следующих клиентских версий OneNote:

-   OneNote win32 версии 16.0.8326.2096 (или более поздней);

-   OneNote UWP версии 16.0.8431.1006 (или более поздней);

-   приложение OneNote Mobile версии 16.0.8431.1011 (или более поздней).

### <a name="teams-app"></a>Приложение Teams

Когда перемещение OneDrive в отношении геообъекта будет завершено, пользователи получат доступ к своим файлам OneDrive в приложении Teams. Кроме того, файлы, отправленные из OneDrive через чат Teams до такого перемещения, будут продолжать работать и после него.

### <a name="onedrive-mobile-app-ios"></a>OneDrive Мобильное приложение (iOS) 

Когда перемещение OneDrive в отношении геообъекта будет завершено, пользователю понадобится выйти из мобильного приложения для iOS и снова войти в него. Благодаря этому будет выполнена синхронизация с новым расположением OneDrive.

### <a name="existing-followed-groups-and-sites"></a>Существующие отслеживаемые группы и сайты

Последующие сайты и группы будут показываться в OneDrive независимо от их географического расположения. Сайты и группы, размещение в другом географическом расположении, откроется в отдельной вкладке.

### <a name="delve-geo-url-updates"></a>Delve Обновления URL-адресов Geo

Пользователи будут отправлены на Delve, соответствующий их PDL, только после того, как OneDrive будут перемещены в новый гео.
