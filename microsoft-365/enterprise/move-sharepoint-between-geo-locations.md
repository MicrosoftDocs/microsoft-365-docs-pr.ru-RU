---
title: Перемещение сайта SharePoint в другой геообъект
ms.reviewer: adwood
ms.author: mikeplum
author: MikePlumleyMSFT
manager: pamgreen
audience: ITPro
ms.topic: article
ms.service: o365-solutions
ms.collection:
- Strat_SP_gtc
- SPO_Content
localization_priority: Normal
f1.keywords:
- NOCSH
description: Узнайте, как переместить сайт SharePoint в другое геопозиционное расположение в многоэтапной среде и сообщить пользователям об изменениях.
ms.custom: seo-marvel-apr2020
ms.openlocfilehash: eed323b2e2b8f68a4a603052657e17495bb17690
ms.sourcegitcommit: 27b2b2e5c41934b918cac2c171556c45e36661bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "50910934"
---
# <a name="move-a-sharepoint-site-to-a-different-geo-location"></a>Перемещение сайта SharePoint в другой геообъект

С помощью функции перемещения географического расположения сайта SharePoint можно перемещать сайты SharePoint в другие геообъекты в среде с поддержкой нескольких регионов.

Следующие типы сайтов можно перемещать между геообъектами:

- Сайты, подключенные к группе Microsoft 365
- Современные сайты, не связанные с группой Microsoft 365
- Классические сайты SharePoint
- Информационные сайты

Чтобы переместить сайт между геообъектами, необходимо быть глобальным администратором или администратором SharePoint.

Во время перемещения географического расположения сайта SharePoint возникает промежуток с доступом только для чтения продолжительностью около 4–6 часов в зависимости от содержимого сайта.

## <a name="best-practices"></a>Рекомендации

- Попробуйте выполнить перемещение сайта SharePoint на тестовом сайте, чтобы познакомиться с процедурой.
- Подтвердите возможность перемещения сайта до планирования или выполнения перемещения.
- По возможности планируйте перемещение сайтов между геообъектами в нерабочие часы для уменьшения влияния на пользователей.
- Перед перемещением сайта оповестите затрагиваемых пользователей.

## <a name="communicating-to-your-users"></a>Общение с пользователями

При перемещении сайтов SharePoint из одного географического расположения в другое важно объяснить пользователям, чего ожидать. Это поможет избежать недоразумений и снизит количество обращений в службу поддержки. Перед тем как начать перемещение, отправьте пользователям по электронной почте следующую информацию:

- время начала перемещения и его длительность;
- географическое расположение, в которое переносится сайт, и новый URL-адрес для доступа к нему;
- напомните, что необходимо закрыть файлы и не редактировать их во время перемещения;
- после перемещения разрешения для файлов и параметры общего доступа к файлам остаются без изменений;
- чего ожидать от пользовательского интерфейса в среде с поддержкой нескольких регионов.

Обязательно известите пользователей сайтов об успешном окончании перемещения и сообщите, что они могут возобновить работу на сайтах.

## <a name="scheduling-sharepoint-site-moves"></a>Планирование перемещений сайтов SharePoint

Вы можете заранее спланировать перемещения сайтов SharePoint (описано далее в этой статье). Вы можете запланировать перемещения следующим образом:

- Можно запланировать до 4000 перемещений за один раз.
- После начала перемещения можно продолжить планирование, не превышая 4000 ожидаемых перемещений в очереди в любой момент времени.

Чтобы запланировать перемещение географического расположения сайта SharePoint на более позднее время, укажите один из следующих параметров в начале перемещения:

- `PreferredMoveBeginDate` — предполагаемое время начала перемещения.
- `PreferredMoveEndDate` — предполагаемое время завершения перемещения (самый короткий период).

Для обоих параметров время необходимо указывать в формате UTC.

## <a name="moving-the-site"></a>Перемещение сайта

Перемещение географического расположения сайта SharePoint требует подключения и выполнения перемещения из URL-адреса администрирования SharePoint в географическом расположении, в котором находится сайт.

Например, если URL-адрес сайта — <https://contosohealthcare.sharepoint.com/sites/Turbines> подключитесь к URL-адресу администратора SharePoint по <https://contosohealthcare-admin.sharepoint.com> адресу:

```powershell
Connect-SPOService -Url https://contosohealthcare-admin.sharepoint.com
```

![Окно Командной оболочки SharePoint Online с Connect-SPOService командой](../media/move-onedrive-between-geo-locations-image1.png)

### <a name="validating-the-environment"></a>Проверка среды

Перед планированием перемещения любого сайта рекомендуется выполнить проверку, позволяющую убедиться, что сайт можно перемещать.

Не поддерживается перемещение сайтов со следующими элементами:

- Службы Business Connectivity Services
- Формы InfoPath
- Примененные шаблоны управления правами на доступ к данным (IRM)

Чтобы проверить, все ли геообъекты совместимы, выполните команду `Get-SPOGeoMoveCrossCompatibilityStatus`. Она отобразит все ваши геообъекты и укажет, совместима ли среда с целевым географическим расположением.

Чтобы выполнить на сайте только проверочную операцию, используйте `Start-SPOSiteContentMove` с параметром `-ValidationOnly` для проверки возможности перемещения сайта. Пример:

```PowerShell
Start-SPOSiteContentMove -SourceSiteUrl <SourceSiteUrl> -ValidationOnly -DestinationDataLocation <DestinationLocation>
```

В результате будет возвращено значение *Success*, если сайт готов к перемещению или *Fail*, если имеются какие-либо препятствия.

### <a name="start-a-sharepoint-site-geo-move-for-a-site-with-no-associated-microsoft-365-group"></a>Запуск перемещения сайта SharePoint для сайта, не связанного с группой Microsoft 365

По умолчанию исходный URL-адрес для сайта изменяется на URL-адрес целевого географического расположения. Пример:

<https://Contoso.sharepoint.com/sites/projectx> меняется на <https://ContosoEUR.sharepoint.com/sites/projectx>

Сайты, не связанные с группой Microsoft 365, также можно переименовать с помощью параметра `-DestinationUrl`. Пример:

<https://Contoso.sharepoint.com/sites/projectx> меняется на <https://ContosoEUR.sharepoint.com/sites/projecty>

Чтобы начать перемещение сайта, выполните такую команду:

```powershell
Start-SPOSiteContentMove -SourceSiteUrl <siteURL> -DestinationDataLocation <DestinationDataLocation> -DestinationUrl <DestinationSiteURL>
```

![Снимок экрана: окно PowerShell с командлетом Start-SPOSiteContentMove](../media/multi-geo-sharepoint-site-move-powershell.png)

### <a name="start-a-sharepoint-site-geo-move-for-a-microsoft-365-group-connected-site"></a>Запуск перемещения сайта SharePoint для сайта, подключенного к группе Microsoft 365

Чтобы переместить сайт, подключенный к группе Office 365, глобальный администратор или администратор SharePoint должен сначала изменить атрибут предпочтительного расположения данных (PDL) для группы Office 365.

Настройка атрибута PDL для группы Microsoft 365:

```PowerShell
Set-SPOUnifiedGroup -PreferredDataLocation <PDL> -GroupAlias <GroupAlias>
Get-SPOUnifiedGroup -GroupAlias <GroupAlias>
```

После обновления атрибута PDL вы можете начать перемещение сайта:

```PowerShell
Start-SPOUnifiedGroupMove -GroupAlias <GroupAlias> -DestinationDataLocation <DestinationDataLocation>
```

## <a name="cancel-a-sharepoint-site-geo-move"></a>Отмена перемещения географического расположения сайта SharePoint

Перемещение географического расположения сайта SharePoint можно остановить, если этот процесс не находится на этапе выполнения или не завершен с помощью командлета `Stop-SPOSiteContentMove`.

## <a name="determining-the-status-of-a-sharepoint-site-geo-move"></a>Определение состояния перемещения географического расположения сайта SharePoint

Вы можете определить состояние перемещения сайта в отношении геообъекта (в расположение или из расположения), к которому подключены, с помощью следующих командлетов:

- [Get-SPOSiteContentMoveState](/powershell/module/sharepoint-online/get-spositecontentmovestate) (сайты, не подключенные к группе)
- [Get-SPOUnifiedGroupMoveState](/powershell/module/sharepoint-online/get-spounifiedgroupmovestate) (сайты, подключенные к группе)

Используйте параметр `-SourceSiteUrl`, чтобы указать сайт, для которого нужно просмотреть состояние перемещения.

Состояния перемещения описаны в приведенной ниже таблице.

****

|Состояние|Описание|
|---|---|
|Ready to Trigger|Перемещение не начато.|
|Scheduled|Перемещение в очереди, но еще не началось.|
|InProgress (n/4)|Перемещение в процессе и находится в одном из следующих состояний: "проверка" (1/4), "резервное копирование" (2/4), "восстановление" (3/4), "очистка" (4/4).|
|Success|Перемещение успешно завершено.|
|Failed|Перемещение не удалось выполнить.|
|

Вы также можете применить параметр `-Verbose`, чтобы просмотреть дополнительные сведения о перемещении.

## <a name="user-experience"></a>Взаимодействие с пользователем

Перемещение сайта в другой геообъект должно проходить максимально незаметно для пользователей сайта. Если не считать кратковременного состояния доступа только для чтения при перемещении, после завершения этого процесса существующие ссылки и разрешения будут доступны в обычном режиме.

### <a name="site"></a>Сайт

Во время перемещения сайт доступен только для чтения. Когда перемещение завершится, при попытке пользователя щелкнуть закладку или другую ссылку, ведущую к сайту, он будет направлен к новому сайту в новом географическом расположении.

### <a name="permissions"></a>Разрешения

У пользователей с разрешениями для сайта будет к нему доступ во время перемещения и после его завершения.

### <a name="sync-client"></a>Клиент синхронизации

Когда будет выполнено перемещение сайта, клиент синхронизации автоматически обнаружит и легко перенесет синхронизацию в новое расположение сайта. Пользователю не нужно выполнять повторный вход или любые другие действия. (Требуется клиент синхронизации версии 17.3.6943.0625 или более поздней.)

Если пользователь попробует обновить файл во время перемещения, клиент синхронизации уведомит его о том, что отправка файла при выполнении перемещения приостанавливается.

### <a name="sharing-links"></a>Предоставление ссылок

Когда перемещение географического расположения сайта SharePoint будет завершено, для существующих предоставленных ссылок на перемещенные файлы будет автоматически выполняться перенаправление на новый геообъект.

### <a name="most-recently-used-files-in-office-mru"></a>Недавно использованные файлы в Office (MRU)

Служба MRU обновляется с URL-адресом сайта и URL-адресами его содержимого после завершения перемещения. Это применяется к Word, Excel и PowerPoint.

### <a name="onenote-experience"></a>Интерфейс OneNote

Когда перемещение сайта будет завершено, приложение UWP (универсальное) и клиент OneNote win32 автоматически обнаружат и легко синхронизируют записные книжки с новым расположением сайта. Пользователю не нужно выполнять повторный вход или любые другие действия. Во время выполнения перемещения сайта единственным отображаемым индикатором для пользователя является уведомление об ошибке синхронизации записной книжки. Эта возможность доступна для следующих клиентских версий OneNote:

- OneNote win32 версии 16.0.8326.2096 (или более поздней);
- OneNote UWP версии 16.0.8431.1006 (или более поздней);
- приложение OneNote Mobile версии 16.0.8431.1011 (или более поздней).

### <a name="teams-applicable-to-microsoft-365-group-connected-sites"></a>Teams (применимо к сайтам, подключенным к группе Microsoft 365)

Когда перемещение сайта SharePoint будет завершено, пользователи получат доступ к файлам сайта, подключенного к группе Microsoft 365, в приложении Teams. Кроме того, файлы, отправленные из сайта через чат Teams до такого перемещения, будут продолжать работать и после него.

### <a name="sharepoint-mobile-app-iosandroid"></a>Мобильное приложение SharePoint (iOS или Android)

Мобильное приложение SharePoint совместимо с переносом географических расположений и может определять новое географическое расположение сайта.

### <a name="sharepoint-workflows"></a>Рабочие процессы SharePoint

Рабочие процессы SharePoint 2013 требуют повторной публикации после перемещения сайта. Рабочие процессы SharePoint 2010 должны продолжать нормально работать.

### <a name="apps"></a>Приложения

Если вы перемещаете сайт с приложениями, необходимо повторно создать экземпляр приложения в новом географическом расположении сайта, так как приложение и его связи могут быть недоступны в конечном геообъекте.

### <a name="flow"></a>Flow

В большинстве случаев потоки Flow будут продолжать работать после перемещения географического расположения сайта SharePoint. Рекомендуется проверить их после завершения перемещения.

### <a name="powerapps"></a>PowerApps

Для PowerApps требуется повторное создание в конечном расположении.

### <a name="data-movement-between-geo-locations"></a>Перемещение данных между географическими расположениями

SharePoint использует хранилище BLOB-объектов Azure для своего содержимого, а метаданные, связанные с сайтами и файлами, хранятся в SharePoint. После перемещения сайта из исходного в новое географическое расположение служба также переместит связанное хранилище BLOB-объектов. Перемещение хранилища BLOB-объектов завершается примерно за 40 дней.