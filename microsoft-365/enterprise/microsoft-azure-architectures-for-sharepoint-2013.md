---
title: Архитектуры Microsoft Azure для SharePoint 2013
ms.author: bcarter
author: brendacarter
manager: laurawi
ms.date: 12/15/2017
audience: ITPro
ms.topic: conceptual
ms.service: o365-solutions
localization_priority: Normal
ms.collection: Ent_O365
f1.keywords:
- CSH
ms.custom:
- Ent_Architecture
- seo-marvel-apr2020
ms.assetid: 98fc1006-9399-4ff0-a216-c7c05820d822
description: Узнайте, какие типы решений SharePoint 2013 могут быть организованы в виртуальных машинах Microsoft Azure, а также о том, как настроить Azure для хозяйского устройства.
ms.openlocfilehash: eed74e2dcbe383f0f63e7f6ea2fc70fe7b51b1b3
ms.sourcegitcommit: 27b2b2e5c41934b918cac2c171556c45e36661bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "50924180"
---
# <a name="microsoft-azure-architectures-for-sharepoint-2013"></a>Архитектуры Microsoft Azure для SharePoint 2013

Среда Azure отлично подходит для размещения решений SharePoint Server 2013. В большинстве случаев мы рекомендуем Microsoft 365, но ферма SharePoint Server, которая имеется в Azure, может быть хорошим вариантом для определенных решений. В этой статье описано, как спроектировать решения SharePoint для обеспечения совместимости с платформой Azure. В качестве примеров используются два следующих решения:
  
- [Аварийное восстановление SharePoint Server 2013 в Microsoft Azure](sharepoint-server-2013-disaster-recovery-in-microsoft-azure.md)
    
- [Веб-сайты в Microsoft Azure с использованием SharePoint Server 2013](internet-sites-in-microsoft-azure-using-sharepoint-server-2013.md)
    
## <a name="recommended-sharepoint-solutions-for-azure-infrastructure-services"></a>Рекомендуемые решения SharePoint для служб инфраструктуры Azure

Службы инфраструктуры Azure отлично подходят для размещения решений SharePoint. Не все решения одинаково совместимы с этой платформой. В приведенной ниже таблице представлены рекомендуемые решения.
  
|**Решение**|**Преимущества работы с Azure**|
|:-----|:-----|
|Среды разработки и тестирования  <br/> |Создавать такие среды и управлять ими легко.  <br/> |
|Аварийное восстановление локальных ферм SharePoint в Azure  <br/> |**Размещенный вспомогательный центр обработки данных** Используйте Azure, чтобы не вкладывать средства во вспомогательный центр обработки данных в другом регионе. <br/> **Снижение затрат на среды аварийного восстановления** По сравнению с локальной средой аварийного восстановления потребуется обслуживать и оплачивать меньше ресурсов. Их количество зависит от выбранной среды аварийного восстановления: с холодным или горячим резервированием либо горячей заменой.<br/> **Более эластичная платформа** В случае аварии вы можете с легкостью развернуть ферму восстановления SharePoint в соответствии с требованиями к нагрузке. Когда необходимость в дополнительных ресурсах пропадет, вы можете свернуть ферму.<br/> См. статью [Аварийное восстановление SharePoint Server 2013 в Microsoft Azure](sharepoint-server-2013-disaster-recovery-in-microsoft-azure.md).  <br/> |
|Веб-сайты, на которые используются функции и масштабы, недоступные в Microsoft 365  <br/> |**Правильные приоритеты** Сосредоточьтесь на создании отличного сайта, а не инфраструктуры. <br/> **Воспользуйтесь преимуществами эластичности Azure** Изменяйте размер фермы в соответствии с потребностями, добавляя новые серверы, и платите только за необходимые вам ресурсы. Динамическое распределение машин не поддерживается (автомасштабирование).<br/> **Использование службы Azure Active Directory (AD)** Воспользуйтесь преимуществами Azure AD для учетных записей клиентов. <br/> **Добавление функций SharePoint, недоступных в Microsoft 365** Добавьте глубокие отчеты и веб-аналитику. <br/> См. статью [Веб-сайты в Microsoft Azure с использованием SharePoint Server 2013](internet-sites-in-microsoft-azure-using-sharepoint-server-2013.md).  <br/> |
|Фермы приложений для поддержки сред Microsoft 365 или локальной среды  <br/> |**Создание, тестирование и размещение приложений** в Azure для поддержки как локальных, так и облачных сред. <br/> **Разместите эту роль** в Azure, не покупая новое оборудование для локальных сред. <br/> |
   
Для решений интрасети и совместной работы рассмотрите следующие факторы.
  
- Определите, соответствует ли Microsoft 365 требованиям бизнеса или может быть частью решения. Microsoft 365 предоставляет богатый набор функций, который всегда в курсе.
    
- Если Microsoft 365 не соответствует всем бизнес-требованиям, рассмотрите стандартную реализацию SharePoint 2013 на локальной основе от Microsoft Consulting Services (MCS). Поддерживать стандартную архитектуру может быть дешевле и проще, чем персонализированное решение. 
    
- Если стандартная реализация не соответствует вашим бизнес-требованиям, рекомендуется персонализированное локальное решение.
    
- Если ваши бизнес-требования включают использование облачной платформы, рассмотрите возможность стандартной или персонализированной реализации SharePoint 2013 с размещением в службах инфраструктуры Azure. Поддерживать решения SharePoint в Azure намного проще, чем другие общедоступные облачные платформы (не корпорации Майкрософт).
    
## <a name="before-you-design-the-azure-environment"></a>Перед разработкой среды Azure

Хотя в этой статье используются примеры топологий SharePoint, вы можете использовать эти проектные решения с любой топологией фермы SharePoint. Прежде чем разрабатывать среду Azure, используйте указанные ниже топологию, архитектуру, емкость и производительность для разработки фермы SharePoint.
  
- [Архитектура SharePoint 2013 для ИТ-специалистов](/SharePoint/technical-reference/technical-diagrams)
    
- [Plan for performance and capacity management in SharePoint Server 2013](/SharePoint/administration/performance-planning-in-sharepoint-server-2013)
    
## <a name="determine-the-active-directory-domain-type"></a>Определение типа домена Active Directory

Каждая ферма SharePoint Server использует службу Active Directory для создания учетных записей администраторов. В настоящее время существует два варианта для решений SharePoint в Azure. Они описываются в следующей таблице.
  
|**Вариант**|**Описание**|
|:-----|:-----|
|Выделенный домен  <br/> |Вы можете развернуть выделенный изолированный домен Active Directory в Azure для поддержки фермы SharePoint. Этот вариант хорошо подходит для общедоступных сайтов в Интернете.  <br/> |
|Расширение локального домена через подключение между организациями  <br/> |Когда вы расширяете локальный домен через подключение между организациями, пользователи получают доступ к ферме SharePoint через интрасеть, как будто она размещена локально. Вы можете использовать локальные службы Active Directory и DNS.  <br/> Для создания среды аварийного восстановления в Azure необходимо соединение между организациями, чтобы обрабатывать отказы локальной фермы.  <br/> |
   
В этой статье представлены проектные решения для расширения локального домена через подключение между организациями. Если ваше решение использует выделенный домен, подключение между организациями не требуется.
  
## <a name="design-the-virtual-network"></a>Разработка виртуальной сети

Для начала вам потребуется виртуальная сеть в Azure, включающая подсети, в которых будут размещаться виртуальные машины. Для виртуальной сети необходимо пространство частных IP-адресов, части которого назначаются подсетям.
  
Если вы расширяете локальную сеть в Azure через подключение между организациями (требуется для среды аварийного восстановления), необходимо выбрать пространство частных адресов, которое еще не используется в сети организации и может включать локальную среду и другие виртуальные сети Azure. 
  
**Рисунок 1. Локальная среда с виртуальной сетью в Azure**

![Конструкция виртуальной сети Microsoft Azure для решения SharePoint. Одна подсеть для шлюза Azure. Одна подсеть для виртуальных машин.](../media/OPrrasconWA-AZarch.png)
  
На этой схеме:
  
- Виртуальная сеть в Azure показана рядом с локальной средой. Между двумя средами еще не установлено подключение (VPN-подключение типа "сеть-сеть" или подключение ExpressRoute);
    
- Сейчас виртуальная сеть включает только подсети без остальных элементов архитектуры. В одной подсети будет размещаться шлюз Azure, а в других — уровни фермы SharePoint с дополнительной подсетью для Active Directory и DNS.
    
## <a name="add-cross-premises-connectivity"></a>Добавление подключения между организациями

Следующий этап развертывания  создание подключения между организациями (если это применимо к вашему решению). В схеме подключений между организациями шлюз Azure находится в отдельной подсети, которую необходимо создать и которой нужно назначить пространство адресов. 
  
При планировании подключения между организациями необходимо определить и создать шлюз Azure и подключение к локальному устройству шлюза.
  
**Рисунок 2. Использование шлюза Azure и локального устройства шлюза для установки подключения типа "сеть-сеть" между локальной средой и Azure**

![Локальная среда подключена к виртуальной сети Azure с помощью VPN-подключения типа "сеть-сеть" или подключения ExpressRoute](../media/AZarch-VPNgtwyconnct.png)
  
На этой схеме:
  
- В отличие от предыдущей схемы, здесь добавлено подключение между локальной средой и виртуальной сетью Azure (VPN-подключение типа "сеть-сеть" или подключение ExpressRoute).
    
- Шлюз Azure находится в подсети шлюза.
    
- Локальная среда включает устройство шлюза, например маршрутизатор или VPN-сервер.
    
Дополнительные сведения о планировании и создании распределенной виртуальной сети см. в статье [Подключение локальной сети к виртуальной сети Microsoft Azure](connect-an-on-premises-network-to-a-microsoft-azure-virtual-network.md).
  
## <a name="add-active-directory-domain-services-ad-ds-and-dns"></a>Добавление служб домена Active Directory (AD DS) и DNS

Для аварийного восстановления в Azure доменные службы AD на сервере Windows и DNS развертываются в гибридном сценарии, где AD на сервере Windows развертывается как в локальной среде, так и на виртуальных машинах Azure.
  
**Рисунок 3. Гибридная конфигурация домена Active Directory**

![Две виртуальные машины, развернутые в виртуальной сети Azure и подсети фермы SharePoint — это реплики контроллеров домена и DNS-серверы](../media/AZarch-HyADdomainConfig.png)
  
В отличие от предыдущих схем, на этой схеме в подсеть AD на сервере Windows и DNS добавлены две виртуальные машины. Это реплики контроллеров доменов и DNS-серверов. Они являются расширением локальной среды AD на сервере Windows. 
  
В таблице ниже приведены рекомендации по настройке этих виртуальных машин в Azure. Используйте их в качестве основы для разработки своей среды  даже для выделенного домена, где среда Azure не подключена к локальной среде.
  
|**Элемент**|**Конфигурация**|
|:-----|:-----|
|Размер виртуальных машин в Azure  <br/> |Размер A1 или A2 стандартного уровня  <br/> |
|Операционная система  <br/> |Windows Server 2012 R2  <br/> |
|Роль Active Directory  <br/> |Контроллер домена AD DS, выбранный в качестве сервера глобального каталога. Эта конфигурация снижает выходной трафик соединения между организациями.  <br/> В среде с несколькими доменами и высокими темпами роста (такие среды встречаются редко) настройте локальные контроллеры домена так, чтобы они не синхронизировались с серверами глобального каталога в Azure, что позволяет снизить трафик репликации.  <br/> |
|Роль DNS  <br/> |Установка и настройка службы DNS-серверов на контроллерах доменов.  <br/> |
|Диски с данными  <br/> |Разместите базу данных Active Directory, журналы и SYSVOL на дополнительных дисках с данными Azure. Не размещайте их на диске операционной системы и временных дисках, предоставленных Azure.  <br/> |
|IP-адреса  <br/> |Используйте статические IP-адреса и настройте виртуальную сеть, чтобы назначить эти адреса виртуальным машинам в виртуальной сети после того, как будут настроены контроллеры доменов.  <br/> |
   
> [!IMPORTANT]
> Перед развертыванием Active Directory в Azure прочитайте [руководства по развертыванию Windows Server Active Directory на виртуальных машинах Azure](/windows-server/identity/ad-ds/introduction-to-active-directory-domain-services-ad-ds-virtualization-level-100). Они помогут вам определить, требуются ли для вашего решения другие параметры конфигурации или другая архитектура. 
  
## <a name="add-the-sharepoint-farm"></a>Добавление фермы SharePoint

Разместите виртуальные машины фермы SharePoint по уровням соответствующей подсети.
  
**Рисунок 4. Размещение виртуальных машин SharePoint**

![Серверы баз данных и роли сервера SharePoint добавлены в виртуальную сеть Azure в подсети фермы SharePoint](../media/AZarch-SPVMsinCloudSer.png)
  
В отличие от предыдущих схем, на этой схеме на соответствующие уровни добавлены роли серверов фермы SharePoint.
  
- Две виртуальные машины баз данных, на которых запущен SQL Server, образуют уровень баз данных.
    
- Две виртуальные машины, на которых запущен SharePoint Server 2013, на каждый из следующих уровней: серверы переднего плана, серверы распределенного кэша и тыловые серверы.
    
## <a name="design-and-fine-tune-server-roles-for-availability-sets-and-fault-domains"></a>Разработка и точная настройка ролей серверов для групп доступности и доменов сбоя

Домен сбоя  это набор оборудования, на котором выполняются экземпляры ролей. Инфраструктура Azure может одновременно обновлять все виртуальные машины в одном домене сбоя. Тем не менее они могут одновременно отказать, так как используют одну стойку. Чтобы не размещать две виртуальные машины в одном домене сбоя, вы можете настроить их как группу доступности, тогда каждая виртуальная машина будет размещаться в отдельном домене сбоя. Если три виртуальные машины настроены как группа доступности, Azure гарантирует, что в одном домене сбоя размещается не больше двух виртуальных машин.
  
При разработке архитектуры Azure для фермы SharePoint настройте одинаковые роли серверов как группу доступности. Это обеспечит распределение виртуальных машин между несколькими доменами сбоя.
  
**Рисунок 5. Использование групп доступности Azure для обеспечения высокой доступности уровней фермы SharePoint**

![Конфигурация групп доступности в инфраструктуре Azure для решения SharePoint 2013](../media/AZenv-WinAzureAvailSetsHA.png)
  
На этой схеме показана конфигурация групп доступности в инфраструктуре Azure. Перечисленные ниже роли используют отдельную группу доступности.
  
- Active Directory и DNS
    
- База данных
    
- Тыловой сервер
    
- Сервер распределенного кэша
    
- Интерфейсный сервер
    
Может потребоваться точная настройка фермы SharePoint на платформе Azure. Чтобы обеспечить высокую доступность всех компонентов, убедитесь, что все роли серверов настроены одинаково.
  
Ниже приводится пример стандартной архитектуры веб-сайтов, которая соответствует определенным требованиям к мощности и производительности. Этот пример представлен в модели [Архитектуры поиска на веб-сайтах для SharePoint Server 2013](https://go.microsoft.com/fwlink/p/?LinkId=261519).
  
**Рисунок 6. Пример планирования емкости и производительности в трехуровневой ферме**

![Стандартная архитектура SharePoint 2013 Internet Sites с распределением компонентов, которое соответствует определенным требованиям к мощности и производительности](../media/AZarch-CapPerfexmpArch.png)
  
На этой схеме:
  
- Представлена трехуровневая ферма: веб-серверы, серверы приложений и серверы баз данных;
    
- Три веб-сервера настроены одинаково с несколькими компонентами.
    
- Два сервера баз данных настроены одинаково.
    
- Три сервера приложений настроены по-разному. Эти роли серверов требуют точной настройки для групп доступности в Azure.
    
Рассмотрим уровень серверов приложений подробнее.
  
**Рисунок 7. Уровень серверов приложений перед точной настройкой**

![Пример уровня серверов приложений SharePoint Server 2013 перед настройкой для групп доступности Microsoft Azure](../media/AZarch-AppServtierBefore.png)
  
На этой схеме:
  
- уровень приложений включает три сервера;
    
- первый сервер включает четыре компонента;
    
- второй сервер включает три компонента;
    
- третий сервер включает два компонента.
    
Количество компонентов определяется требованиями к производительности и емкости фермы. Чтобы адаптировать эту архитектуру для Azure, мы реплицируем четыре компонента на всех трех серверах. Таким образом, количество компонентов будет превышать необходимое. С другой стороны, такая схема обеспечивает высокую доступность всех четырех компонентов на платформе Azure, когда эти три виртуальные машины назначаются группе доступности.
  
**Рисунок 8. Уровень серверов приложений после точной настройки**

![Пример уровня серверов приложений SharePoint Server 2013 после настройки для групп доступности Microsoft Azure](../media/AZarch-AppServtierAfter.png)
  
На этой схеме показаны все три сервера приложений, настроенных одинаково с одними и теми же четырьмя компонентами.
  
После того как мы добавили к уровням фермы SharePoint группы доступности, этап реализации завершен.
  
**Рисунок 9. Готовая ферма SharePoint в службах инфраструктуры Azure**

![Пример фермы SharePoint 2013 в службах инфраструктуры Azure с виртуальной сетью, подключением между организациями, подсетями, виртуальными машинами и группами доступности](../media/7256292f-bf11-485b-8917-41ba206153ee.png)
  
На этой схеме показана ферма SharePoint, реализованная в службах инфраструктуры Azure: группы доступности обеспечивают домены сбоя для серверов на каждом уровне.
  
## <a name="see-also"></a>См. также

[Центр архитектуры и решений Microsoft 365](../solutions/index.yml)
  
[Веб-сайты в Microsoft Azure с использованием SharePoint Server 2013](internet-sites-in-microsoft-azure-using-sharepoint-server-2013.md)
  
[Аварийное восстановление SharePoint Server 2013 в Microsoft Azure](sharepoint-server-2013-disaster-recovery-in-microsoft-azure.md)