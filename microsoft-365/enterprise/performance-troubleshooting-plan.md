---
title: План устранения неполадок с производительностью Office 365
ms.author: kvice
author: kelleyvice-msft
manager: laurawi
ms.date: 5/10/2019
audience: Admin
ms.topic: conceptual
ms.service: o365-administration
localization_priority: Normal
f1.keywords:
- CSH
ms.custom:
- Adm_O365
- seo-marvel-apr2020
search.appverid:
- MET150
- MOE150
- BCS160
ms.assetid: e241e5d9-b1d8-4f1d-a5c8-4106b7325f8c
ms.collection:
- M365-security-compliance
- Ent_O365
description: В этой статье можно устранить Office 365 проблемы с производительностью и даже устранить некоторые из наиболее распространенных проблем.
ms.openlocfilehash: 588a19e86d903a7ab709a7f0d0131da6e2a77f47
ms.sourcegitcommit: 27b2b2e5c41934b918cac2c171556c45e36661bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "50928240"
---
# <a name="performance-troubleshooting-plan-for-office-365"></a><span data-ttu-id="e5bfb-103">План устранения неполадок с производительностью Office 365</span><span class="sxs-lookup"><span data-stu-id="e5bfb-103">Performance troubleshooting plan for Office 365</span></span>

<span data-ttu-id="e5bfb-104">Необходимо ли знать, какие действия необходимо предпринять для выявления и устранения лагов, зависания и медленной производительности между SharePoint Online, OneDrive для бизнеса, Exchange Online или Skype для бизнеса Online и клиентского компьютера?</span><span class="sxs-lookup"><span data-stu-id="e5bfb-104">Do you need to know the steps to take to identify and fix lags, hangs, and slow performance between SharePoint Online, OneDrive for Business, Exchange Online, or Skype for Business Online, and your client computer?</span></span> <span data-ttu-id="e5bfb-105">Перед вызовом службы поддержки эта статья может помочь устранить Office 365 проблемы с производительностью и даже устранить некоторые из наиболее распространенных проблем.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-105">Before you call support, this article can help you troubleshoot Office 365 performance issues and even fix some of the most common issues.</span></span>

<span data-ttu-id="e5bfb-106">В этой статье фактически используется пример плана действий, который можно использовать для захвата ценных данных о проблеме производительности при ее работе.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-106">This article is actually a sample action plan that you can use to capture valuable data about your performance issue as it's happening.</span></span> <span data-ttu-id="e5bfb-107">Некоторые главные проблемы также включены в эту статью.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-107">Some top issues are also included in this article.</span></span>

<span data-ttu-id="e5bfb-108">Если вы не знаете о производительности сети и хотите спланировать долгосрочный план мониторинга производительности между клиентской машиной и Office 365, взгляните на Office 365 настройки производительности и устранение неполадок — администрирование и [ИТ-Pro](performance-tuning-using-baselines-and-history.md).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-108">If you're new to network performance and want to make a long term plan to monitor performance between your client machines and Office 365, take a look at [Office 365 performance tuning and troubleshooting - Admin and IT Pro](performance-tuning-using-baselines-and-history.md).</span></span>

## <a name="sample-performance-troubleshooting-action-plan"></a><span data-ttu-id="e5bfb-109">Пример плана действий по устранению неполадок производительности</span><span class="sxs-lookup"><span data-stu-id="e5bfb-109">Sample performance troubleshooting action plan</span></span>

<span data-ttu-id="e5bfb-110">Этот план действий содержит две части; этап подготовки и этап ведения журнала.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-110">This action plan contains two parts; a preparation phase, and a logging phase.</span></span> <span data-ttu-id="e5bfb-111">Если у вас есть проблемы с производительностью прямо сейчас, и вам необходимо сделать сбор данных, вы можете начать использовать этот план сразу.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-111">If you have a performance problem right now, and you need to do data collection, you can start using this plan right away.</span></span>

### <a name="prepare-the-client-computer"></a><span data-ttu-id="e5bfb-112">Подготовка клиентского компьютера</span><span class="sxs-lookup"><span data-stu-id="e5bfb-112">Prepare the client computer</span></span>

- <span data-ttu-id="e5bfb-113">Найдите клиентский компьютер, который может воспроизвести проблему производительности.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-113">Find a client computer that can reproduce the performance problem.</span></span> <span data-ttu-id="e5bfb-114">Этот компьютер будет использоваться во время устранения неполадок.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-114">This computer will be used during the course of troubleshooting.</span></span>
- <span data-ttu-id="e5bfb-115">Запишите действия, которые приводят к проблеме производительности, чтобы вы были готовы, когда придет время для тестирования.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-115">Write down the steps that cause the performance problem to happen so you're ready when it comes time to test.</span></span>
- <span data-ttu-id="e5bfb-116">Установите средства для сбора и записи сведений:</span><span class="sxs-lookup"><span data-stu-id="e5bfb-116">Install tools for gathering and recording information:</span></span>
  - <span data-ttu-id="e5bfb-117">Установка [Netmon 3.4](https://www.microsoft.com/download/details.aspx?id=4865) (или использование эквивалентного средства отслеживания сети).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-117">Install [Netmon 3.4](https://www.microsoft.com/download/details.aspx?id=4865) (or use an equivalent network tracing tool).</span></span>
  - <span data-ttu-id="e5bfb-118">Установите бесплатное базовое издание [HTTPWatch](https://www.httpwatch.com/download/) (или используйте эквивалентный сетевой инструмент трассивки).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-118">Install the free Basic Edition of [HTTPWatch](https://www.httpwatch.com/download/) (or use an equivalent network Tracing tool).</span></span>
  - <span data-ttu-id="e5bfb-119">Используйте регистратор экрана или запустите регистратор шагов (PSR.exe), который поставляется с Windows Vista и позже, чтобы сохранить запись действий, которые вы принимаете во время тестирования.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-119">Use a screen recorder or run the Steps Recorder (PSR.exe) that comes with Windows Vista and later, in order to keep a record of the steps you take during testing.</span></span>

### <a name="log-the-performance-issue"></a><span data-ttu-id="e5bfb-120">Журнал проблемы производительности</span><span class="sxs-lookup"><span data-stu-id="e5bfb-120">Log the performance issue</span></span>

- <span data-ttu-id="e5bfb-121">Закрой все лишние интернет-браузеры.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-121">Close all extraneous Internet browsers.</span></span>
- <span data-ttu-id="e5bfb-122">Запустите регистратор шагов или другой регистратор экрана.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-122">Start the Steps Recorder, or another screen recorder.</span></span>
- <span data-ttu-id="e5bfb-123">Запустите захват Netmon (или средство отслеживания сети).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-123">Start your Netmon capture (or network tracing tool).</span></span>
- <span data-ttu-id="e5bfb-124">Очистить кэш DNS на клиентский компьютер от командной строки, введя ipconfig/flushdns.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-124">Clear your DNS cache on the client computer from the command line by typing ipconfig /flushdns.</span></span>
- <span data-ttu-id="e5bfb-125">Запустите новый сеанс браузера и включив HTTPWatch.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-125">Start a new browser session and turn on HTTPWatch.</span></span>
- <span data-ttu-id="e5bfb-126">Необязательный. Если вы Exchange Online, запустите средство анализатора производительности Exchange клиента из консоли Office 365 администратора.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-126">Optional: If you are testing Exchange Online, run the Exchange Client Performance Analyzer tool from the Office 365 admin console.</span></span>
- <span data-ttu-id="e5bfb-127">Воспроизведение точных действий, которые вызывают проблему производительности.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-127">Reproduce the exact steps that cause the performance issue.</span></span>
- <span data-ttu-id="e5bfb-128">Остановите след Netmon или другого средства.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-128">Stop your Netmon or other tool's trace.</span></span>
- <span data-ttu-id="e5bfb-129">В командной строке запустите маршрут трассировки для Office 365 подписки, введя следующую команду и нажав кнопку ENTER:</span><span class="sxs-lookup"><span data-stu-id="e5bfb-129">At the command line, run a trace route to your Office 365 subscription by typing the following command and then pressing ENTER:</span></span>

  ``` cmd
  tracert <subscriptionname>.onmicrosoft.com
  ```

- <span data-ttu-id="e5bfb-130">Остановите регистратор шагов и сохраните видео.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-130">Stop the Steps Recorder and save the video.</span></span> <span data-ttu-id="e5bfb-131">Обязательно включай дату и время захвата и показывает ли он хорошую или плохую производительность.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-131">Be sure to include the date and time of the capture and whether it demonstrates good or bad performance.</span></span>
- <span data-ttu-id="e5bfb-132">Сохраните файлы трассировки.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-132">Save the trace files.</span></span> <span data-ttu-id="e5bfb-133">Опять же, обязательно включай дату и время захвата и показывает ли он хорошую или плохую производительность.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-133">Again, be sure to include the date and time of the capture and whether it demonstrates good or bad performance.</span></span>

<span data-ttu-id="e5bfb-134">Если вы не знакомы с управлением средствами, упомянутыми в этой статье, не волнуйтесь, так как мы предлагаем следующие действия.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-134">If you're not familiar with running the tools mentioned in this article, don't worry because we provide those steps next.</span></span> <span data-ttu-id="e5bfb-135">Если вы привыкли делать этот вид захвата сети, вы можете пропустить, как собрать базовые [данные,](performance-tuning-using-baselines-and-history.md#how-to-collect-baselines)который описывает фильтрацию и чтение журналов.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-135">If you're accustomed to doing this kind of network capturing, you can skip to [How to collect baselines](performance-tuning-using-baselines-and-history.md#how-to-collect-baselines), which describes filtering and reading the logs.</span></span>

### <a name="flush-the-dns-cache-first"></a><span data-ttu-id="e5bfb-136">Сначала смыть кэш DNS</span><span class="sxs-lookup"><span data-stu-id="e5bfb-136">Flush the DNS Cache first</span></span>

<span data-ttu-id="e5bfb-137">Почему?</span><span class="sxs-lookup"><span data-stu-id="e5bfb-137">Why?</span></span> <span data-ttu-id="e5bfb-138">Вымыв кэш DNS, вы начинаете тесты с чистого листа.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-138">By flushing out the DNS cache you're starting your tests with a clean slate.</span></span> <span data-ttu-id="e5bfb-139">Очищая кэш, вы сбрасываете содержимое содержимого ретранслиатора DNS в самые последние записи.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-139">By clearing the cache, you're resetting the DNS resolver contents to the most up-to-date entries.</span></span> <span data-ttu-id="e5bfb-140">Помните, что флеш не удаляет записи файлов HOSTs.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-140">Remember that a flush does not remove HOSTs file entries.</span></span> <span data-ttu-id="e5bfb-141">Если вы широко используете записи файлов HOST, следует скопировать эти записи в файл в другом каталоге, а затем опустеть файл HOST.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-141">If you use HOST file entries extensively, you should copy those entries out to a file in another directory and then empty the HOST file.</span></span>

#### <a name="flush-your-dns-resolver-cache"></a><span data-ttu-id="e5bfb-142">Флеш-кэш разрешения DNS</span><span class="sxs-lookup"><span data-stu-id="e5bfb-142">Flush your DNS resolver cache</span></span>

1. <span data-ttu-id="e5bfb-143">Откройте командную подсказку **(начните** запуск \>  \> **cmd** **или Windows** \> **клавишу).**</span><span class="sxs-lookup"><span data-stu-id="e5bfb-143">Open the command prompt, (either **Start** \> **Run** \> **cmd** or **Windows key** \> **cmd**).</span></span>
2. <span data-ttu-id="e5bfb-144">Введите следующую команду и нажмите клавишу ВВОД:</span><span class="sxs-lookup"><span data-stu-id="e5bfb-144">Type the following command and press ENTER:</span></span>

    ``` cmd
    ipconfig /flushdns
    ```

## <a name="netmon"></a><span data-ttu-id="e5bfb-145">Netmon</span><span class="sxs-lookup"><span data-stu-id="e5bfb-145">Netmon</span></span>

<span data-ttu-id="e5bfb-146">Средство мониторинга сети Майкрософт[(Netmon)](https://www.microsoft.com/download/details.aspx?id=4865)анализирует пакеты, то есть трафик, который проходит между компьютерами в сетях.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-146">Microsoft's Network Monitoring tool ([Netmon](https://www.microsoft.com/download/details.aspx?id=4865)) analyzes packets, that is traffic, that passes between computers on networks.</span></span> <span data-ttu-id="e5bfb-147">Используя Netmon для отслеживания трафика с помощью Office 365 вы можете захватывать, просматривать и читать заглавные пакеты, определять взаимозаменяющие устройства, проверять важные параметры сетевого оборудования, искать отброшенные пакеты и следить за потоком трафика между компьютерами в корпоративной сети и Office 365.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-147">By using Netmon to trace traffic with Office 365 you can capture, view, and read packet headers, identify intervening devices, check important settings on network hardware, look for dropped packets, and follow the flow of traffic between computers on your corporate network and Office 365.</span></span> <span data-ttu-id="e5bfb-148">Так как фактический текст трафика зашифрован, то есть он (отправляется в порт 443 через SSL/TLS), вы не можете прочитать отправленные файлы.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-148">Because the actual body of the traffic is encrypted, that is, it(travels on port 443 via SSL/TLS, you can't read the files being sent.</span></span> <span data-ttu-id="e5bfb-149">Вместо этого вы получите неотбитый след пути, который принимает пакет, который может помочь вам отслеживать поведение проблемы.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-149">Instead, you get an unfiltered trace of the path that the packet takes which can help you track down the problem behavior.</span></span>

<span data-ttu-id="e5bfb-150">Убедитесь, что в настоящее время фильтр не применяется.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-150">Be sure you don't apply a filter at this time.</span></span> <span data-ttu-id="e5bfb-151">Вместо этого пробегите по шагам и продемонстрируем проблему, прежде чем остановить след и сохранить.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-151">Instead, run through the steps and demonstrate the problem before stopping the trace and saving.</span></span>

<span data-ttu-id="e5bfb-152">После установки Netmon 3.4 откройте средство и примите следующие действия:</span><span class="sxs-lookup"><span data-stu-id="e5bfb-152">After you install Netmon 3.4, open the tool and take these steps:</span></span>

### <a name="take-a-netmon-trace-and-reproduce-the-issue"></a><span data-ttu-id="e5bfb-153">Возьмите след Netmon и воспроизведйте проблему</span><span class="sxs-lookup"><span data-stu-id="e5bfb-153">Take a Netmon trace and reproduce the issue</span></span>

1. <span data-ttu-id="e5bfb-154">Запуск Netmon 3.4.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-154">Launch Netmon 3.4.</span></span>
<span data-ttu-id="e5bfb-155">На странице "Начало"  есть три **области:**"Последние захваты", **"Выбор** сетей" и "Начало работы с **Microsoft Network Monitor 3.4". Обратите внимание.**</span><span class="sxs-lookup"><span data-stu-id="e5bfb-155">There are three panes on the **Start** page: **Recent Captures**, **Select Networks**, and the **Getting Started with Microsoft Network Monitor 3.4. Notice**.</span></span> <span data-ttu-id="e5bfb-156">Панель Select Networks также даст вам список сетей по умолчанию, из которых можно захватить.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-156">The Select Networks panel will also give you a list of the default networks from which you can capture.</span></span> <span data-ttu-id="e5bfb-157">Убедитесь, что сетевые карты выбраны здесь.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-157">Be sure that network cards are selected here.</span></span>

2. <span data-ttu-id="e5bfb-158">Нажмите **кнопку Новый захват** в верхней части страницы **Начните.**</span><span class="sxs-lookup"><span data-stu-id="e5bfb-158">Click **New Capture** at the top of the **Start** page.</span></span> <span data-ttu-id="e5bfb-159">Это добавляет новую вкладку рядом со вкладками **Начните** страницу под названием **Захват 1**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-159">This adds a new tab beside the **Start** page tab called **Capture 1**.</span></span>
<span data-ttu-id="e5bfb-160">![Пользовательский интерфейс Netmon с выделенными кнопками New Capture, Start и Stop.](../media/d4527d84-62ec-4301-82d5-e0166ff71f20.PNG)</span><span class="sxs-lookup"><span data-stu-id="e5bfb-160">![Netmon's user interface with the New Capture, Start, and Stop buttons highlighted.](../media/d4527d84-62ec-4301-82d5-e0166ff71f20.PNG)</span></span>

3. <span data-ttu-id="e5bfb-161">Чтобы сделать простой захват, нажмите **кнопку Начните** на панели инструментов.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-161">To take a simple capture, click **Start** on the toolbar.</span></span>

4. <span data-ttu-id="e5bfb-162">Воспроизведение действий, которые представляют проблему производительности.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-162">Reproduce the steps that present a performance issue.</span></span>

5. <span data-ttu-id="e5bfb-163">Щелкните  \> **Стоп-файл** \> **Сохранить как**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-163">Click **Stop** \> **File** \> **Save As**.</span></span> <span data-ttu-id="e5bfb-164">Не забудьте ударить дату и время с часовой зоной и упоминают, демонстрирует ли он плохую или хорошую производительность.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-164">Remember to give the date and time with the time zone and to mention if it demonstrates bad or good performance.</span></span>

## <a name="httpwatch"></a><span data-ttu-id="e5bfb-165">HTTPWatch</span><span class="sxs-lookup"><span data-stu-id="e5bfb-165">HTTPWatch</span></span>

<span data-ttu-id="e5bfb-166">[HTTPWatch](https://www.httpwatch.com/download/) поставляется с заряженным и бесплатным выпуском.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-166">[HTTPWatch](https://www.httpwatch.com/download/) comes in charged, and a free edition.</span></span> <span data-ttu-id="e5bfb-167">Бесплатное базовое издание охватывает все необходимое для этого теста.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-167">The free Basic Edition covers everything you need for this test.</span></span> <span data-ttu-id="e5bfb-168">HTTPWatch отслеживает сетевой трафик и время загрузки страницы прямо из окна браузера.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-168">HTTPWatch monitors network traffic and page load time right from your browser window.</span></span> <span data-ttu-id="e5bfb-169">HTTPWatch — это подключаемый модуль к Internet Explorer, который графически описывает производительность.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-169">HTTPWatch is a plug-in to Internet Explorer that graphically describes performance.</span></span> <span data-ttu-id="e5bfb-170">Анализ можно сохранить и просмотреть в HTTPWatch Studio.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-170">The analysis can be saved and viewed in HTTPWatch Studio.</span></span>

> [!NOTE]
> <span data-ttu-id="e5bfb-171">Если вы используете другой браузер, например Firefox, Google Chrome или не можете установить HTTPWatch в Internet Explorer, откройте новое окно браузера и нажмите клавишу F12 на клавиатуре.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-171">If you use another browser, such as Firefox, Google Chrome, or if you can't install HTTPWatch in Internet Explorer, open a new browser window and press F12 on your keyboard.</span></span> <span data-ttu-id="e5bfb-172">Вы должны увидеть всплывающее всплывающее средство разработчика в нижней части браузера.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-172">You should see the Developer Tool pop-up at the bottom of your browser.</span></span> <span data-ttu-id="e5bfb-173">Если вы используете Opera, нажмите CTRL+SHIFT+I для веб-инспектора, а затем нажмите вкладку **Сеть** и завершите тестирование, описанное ниже.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-173">If you use Opera, press CTRL+SHIFT+I for Web Inspector, then click the **Network** tab and complete the testing outlined below.</span></span> <span data-ttu-id="e5bfb-174">Сведения будут немного отличаться, но время загрузки по-прежнему будет отображаться в миллисекунд.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-174">The information will be slightly different, but load times will still be displayed in milliseconds.</span></span> <span data-ttu-id="e5bfb-175">> HTTPWatch также очень полезен для проблем с SharePoint время загрузки страниц в Интернете.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-175">> HTTPWatch is also very useful for issues with SharePoint Online page load times.</span></span>

### <a name="run-httpwatch-and-reproduce-the-issue"></a><span data-ttu-id="e5bfb-176">Запустите HTTPWatch и воспроизведите проблему</span><span class="sxs-lookup"><span data-stu-id="e5bfb-176">Run HTTPWatch and reproduce the issue</span></span>

<span data-ttu-id="e5bfb-177">HTTPWatch — это подключаемый модуль браузера, поэтому для каждой версии Internet Explorer средство в браузере несколько отличается.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-177">HTTPWatch is a browser plug-in, so exposing the tool in the browser is slightly different for each version of Internet Explorer.</span></span> <span data-ttu-id="e5bfb-178">Как правило, httpWatch можно найти в панели Команд в браузере Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-178">Typically, you can find HTTPWatch under the Commands bar in the Internet Explorer browser.</span></span> <span data-ttu-id="e5bfb-179">Если вы не видите плагин HTTPWatch в окне браузера, проверьте версию браузера, нажав справку о , или в более поздних версиях Internet Explorer, щелкните символ передачи и  \> Об **internet Explorer**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-179">If you don't see the HTTPWatch plug-in in your browser window, check the version of your browser by clicking **Help** \> **About**, or in later versions of Internet Explorer, click the gear symbol and **About Internet Explorer**.</span></span> <span data-ttu-id="e5bfb-180">Чтобы запустить **планку Команд,** щелкните правой кнопкой мыши меню в Internet Explorer и нажмите **кнопку Команд.**</span><span class="sxs-lookup"><span data-stu-id="e5bfb-180">To launch the **Commands** bar, right-click the menu bar in Internet Explorer and click **Commands bar**.</span></span>

<span data-ttu-id="e5bfb-181">В прошлом HTTPWatch был связан как с командами, так и с панелью Explorer, поэтому после установки, если вы не сразу увидите значок (даже после перезагрузки) проверьте Инструменты **и** панели инструментов для значка.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-181">In the past, HTTPWatch has been associated with both the Commands and the Explorer bars, so once you install, if you don't immediately see the icon (even after reboot) check **Tools**, and your toolbars for the icon.</span></span> <span data-ttu-id="e5bfb-182">Помните, что панели инструментов можно настроить и добавить к ним параметры.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-182">Remember that toolbars can be customized and options can be added to them.</span></span>

![Панель команд internet Explorer с отображаемой иконкой HTTPWatch.](../media/198590b0-d7b1-4bff-a6ad-e4ec3a1e83df.png)

1. <span data-ttu-id="e5bfb-184">Запуск HTTPWatch в окне браузера Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-184">Launch HTTPWatch in an Internet Explorer browser window.</span></span> <span data-ttu-id="e5bfb-185">Он будет отображаться пристыкованным к браузеру в нижней части этого окна.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-185">It will appear docked to the browser at the bottom of that window.</span></span> <span data-ttu-id="e5bfb-186">Нажмите **кнопку Запись**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-186">Click **Record**.</span></span>

2. <span data-ttu-id="e5bfb-187">Воспроизвести точные действия, связанные с проблемой производительности.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-187">Reproduce the exact steps involved in the performance issue.</span></span> <span data-ttu-id="e5bfb-188">Нажмите **кнопку Остановка** в HTTPWatch.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-188">Click the **Stop** button in HTTPWatch.</span></span>

3. <span data-ttu-id="e5bfb-189">**Сохранить** HTTPWatch или **отправить по электронной почте**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-189">**Save** the HTTPWatch or **Send by Email**.</span></span> <span data-ttu-id="e5bfb-190">Не забудьте назвать файл таким образом, чтобы он включал сведения о дате и времени, а также указывает, содержит ли часы демонстрацию хорошей или плохой производительности.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-190">Remember to name the file so that it includes date and time information and an indication of whether your Watch contains a demonstration of good or bad performance.</span></span>

![HTTPWatch с отображением вкладки "Сеть" при загрузке домашней страницы Office 365.](../media/021a2c64-d581-49fd-adf4-4c364f589d75.PNG)

<span data-ttu-id="e5bfb-192">Этот снимок экрана из Professional httpWatch.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-192">This screen shot is from the Professional version of HTTPWatch.</span></span> <span data-ttu-id="e5bfb-193">Можно открыть следы, взятые в базовой версии, на компьютере с Professional и прочитать его там.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-193">You can open traces taken in the Basic Version on a computer with a Professional version and read it there.</span></span> <span data-ttu-id="e5bfb-194">Дополнительные сведения могут быть доступны из трассировки с помощью этого метода.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-194">Extra information may be available from the trace through that method.</span></span>

## <a name="problem-steps-recorder"></a><span data-ttu-id="e5bfb-195">Регистратор действий проблем</span><span class="sxs-lookup"><span data-stu-id="e5bfb-195">Problem Steps Recorder</span></span>

<span data-ttu-id="e5bfb-196">Регистратор шагов или PSR.exe позволяет записывать проблемы по мере их фиксировать.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-196">Steps Recorder, or PSR.exe, allows you to record issues as they are occurring.</span></span> <span data-ttu-id="e5bfb-197">Это очень полезный инструмент и очень простой в запуске.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-197">It's a very useful tool and very simple to run.</span></span>

### <a name="run-problem-steps-recorder-psrexe-to-record-your-work"></a><span data-ttu-id="e5bfb-198">Запуск регистратора действий проблем (PSR.exe) для записи работы</span><span class="sxs-lookup"><span data-stu-id="e5bfb-198">Run Problem Steps Recorder (PSR.exe) to record your work</span></span>

1. <span data-ttu-id="e5bfb-199">Либо используйте **тип запуска** \>  \> **PSR.exe** \> **ОК,** либо  \>  нажмите кнопку Windows ключаPSR.exe\> нажмите кнопку ENTER.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-199">Either use **Start** \> **Run** \> type **PSR.exe** \> **OK**, or, click the **Windows Key** \> type **PSR.exe** \> and then press ENTER.</span></span>

2. <span data-ttu-id="e5bfb-200">Когда появится PSR.exe окно, нажмите **кнопку Начните** запись и воспроизводя действия, воспроизводя проблемы с производительностью.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-200">When the small PSR.exe window appears, click **Start Record** and reproduce the steps that reproduce the performance issue.</span></span> <span data-ttu-id="e5bfb-201">Вы можете добавить комментарии по мере необходимости, щелкнув **Добавить комментарии**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-201">You can add comments as needed, by clicking **Add Comments**.</span></span>

3. <span data-ttu-id="e5bfb-202">Щелкните **стоп-запись** после завершения действий.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-202">Click **Stop Record** when you have completed the steps.</span></span> <span data-ttu-id="e5bfb-203">Если проблема производительности — это отрисовка страницы, подождите, пока страница не будет отрисовка, прежде чем остановить запись.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-203">If the performance issue is a page render, wait for the page to render before you stop the recording.</span></span>

4. <span data-ttu-id="e5bfb-204">Щелкните **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-204">Click **Save**.</span></span>

![Снимок экрана регистратора шагов или PSR.exe.](../media/8542b0aa-a3ff-4718-8dc4-43f5521c6c34.PNG)

<span data-ttu-id="e5bfb-206">Дата и время записи для вас.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-206">The date and time is recorded for you.</span></span> <span data-ttu-id="e5bfb-207">Это вовремя связывает psR с трассировочными данными Netmon и HTTPWatch, а также помогает в устранении неполадок.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-207">This links your PSR to your Netmon trace and HTTPWatch in time, and helps with precision troubleshooting.</span></span> <span data-ttu-id="e5bfb-208">Дата и время записи PSR могут показать, что между входом и просмотром URL-адреса и частичным отрисовывом веб-сайта администратора, например, прошла минута.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-208">The date and time in the PSR record can show that a minute passed between the login and browsing of the URL and the partial render of the admin site, for example.</span></span>

## <a name="read-your-traces"></a><span data-ttu-id="e5bfb-209">Чтение следов</span><span class="sxs-lookup"><span data-stu-id="e5bfb-209">Read your traces</span></span>

<span data-ttu-id="e5bfb-210">Невозможно научить всех устранению неполадок в сети и производительности, которые кто-то должен знать в статье.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-210">It isn't possible to teach everything about network and performance troubleshooting that someone would need to know via an article.</span></span> <span data-ttu-id="e5bfb-211">Получение хорошей производительности требует опыта и знаний о том, как работает и обычно работает ваша сеть.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-211">Getting good at performance takes experience, and knowledge of how your network works and usually performs.</span></span> <span data-ttu-id="e5bfb-212">Но можно скруглять список главных проблем и показать, как средства могут упростить устранение наиболее распространенных проблем.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-212">But it is possible to round up a list of top issues and show how tools can make it easier for you to eliminate the most common problems.</span></span>

<span data-ttu-id="e5bfb-213">Если вы хотите получить навыки чтения сетевых трассировок для Office 365 сайтов, нет лучшего учителя, чем регулярно создавать следы загрузки страниц и получать опыт чтения их.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-213">If you want to pick up skills reading network traces for your Office 365 sites, there is no better teacher than creating traces of page loads regularly and gaining experience reading them.</span></span> <span data-ttu-id="e5bfb-214">Например, если у вас есть шанс, загрузить Office 365 службу и проследить процесс.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-214">For example, when you have a chance, load an Office 365 service and trace the process.</span></span> <span data-ttu-id="e5bfb-215">Фильтр трассировки для трафика DNS или поиск в FrameData для имени службы, которая просматривается.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-215">Filter the trace for DNS traffic, or search the FrameData for the name of the service you browsed.</span></span> <span data-ttu-id="e5bfb-216">Сканируйте след, чтобы получить представление о действиях, которые происходят при загрузке службы.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-216">Scan the trace to get an idea of the steps that occur when the service loads.</span></span> <span data-ttu-id="e5bfb-217">Это поможет вам узнать, как должна выглядеть нормальная нагрузка страницы, и в случае устранения неполадок, особенно в области производительности, сравнение хороших и плохих следов может научить вас многому.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-217">This will help you learn what normal page load should look like, and in the case of troubleshooting, particularly around performance, comparing good to bad traces can teach you a lot.</span></span>

<span data-ttu-id="e5bfb-218">Netmon использует Microsoft Intellisense в поле фильтра Display.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-218">Netmon uses Microsoft Intellisense in the Display filter field.</span></span> <span data-ttu-id="e5bfb-219">Intellisense или интеллектуальное завершение кода — это тот трюк, в котором введите период, и все доступные параметры отображаются в поле выбора.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-219">Intellisense, or intelligent code completion, is that trick where you type in a period and all available options are displayed in a drop-down selection box.</span></span> <span data-ttu-id="e5bfb-220">Если, например, вас беспокоит масштабирование окна TCP, вы можете найти путь к фильтру (например) с помощью  `.protocol.tcp.window < 100` этого средства.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-220">If, for example, you are worried about TCP window scaling, you can find your way to a filter (such as  `.protocol.tcp.window < 100`) by this means.</span></span>

![Снимок экрана Netmon, показывающий, что поле фильтра отображения использует intellisense.](../media/75a56c11-9a60-47ee-a100-aabdfb1ba10f.PNG)

<span data-ttu-id="e5bfb-222">Следы Netmon могут иметь большой трафик в них.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-222">Netmon traces can have a lot of traffic in them.</span></span> <span data-ttu-id="e5bfb-223">Если у вас нет опыта чтения их, скорее всего, вы будете перегружены открытие трассировки в первый раз.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-223">If you aren't experienced with reading them, it's likely you will be overwhelmed opening the trace the first time.</span></span> <span data-ttu-id="e5bfb-224">Первое, что нужно сделать, это отделить сигнал от фонового шума в следе.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-224">The first thing to do is separate the signal from the background noise in the trace.</span></span> <span data-ttu-id="e5bfb-225">Вы протестировали Office 365, и это трафик, который вы хотите видеть.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-225">You tested against Office 365, and that's the traffic you want to see.</span></span> <span data-ttu-id="e5bfb-226">Если вы привыкли перемещаться по следам, этот список может не понадобиться.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-226">If you are used to navigating through traces, you may not need this list.</span></span>

<span data-ttu-id="e5bfb-227">Трафик между клиентом и Office 365 через TLS, что означает, что тело трафика будет зашифровано и не может быть читаемым в общем следе Netmon.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-227">Traffic between your client and Office 365 travels via TLS, which means that the body of the traffic will be encrypted and not readable in a generic Netmon trace.</span></span> <span data-ttu-id="e5bfb-228">Анализ производительности не должен знать специфику сведений в пакете.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-228">Your performance analysis doesn't need to know the specifics of the information in the packet.</span></span> <span data-ttu-id="e5bfb-229">Однако он очень заинтересован в загонах пакетов и информации, которая в них содержится.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-229">It is, however, very interested in packet headers and the information that they contain.</span></span>

### <a name="tips-to-get-a-good-trace"></a><span data-ttu-id="e5bfb-230">Советы получить хороший след</span><span class="sxs-lookup"><span data-stu-id="e5bfb-230">Tips to get a good trace</span></span>

- <span data-ttu-id="e5bfb-231">Знать значение адреса IPv4 или IPv6 клиентского компьютера.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-231">Know the value of the IPv4 or IPv6 address of your client computer.</span></span> <span data-ttu-id="e5bfb-232">Это можно получить из командной подсказки, введя **IPConfig** и нажав кнопку ENTER.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-232">You can get this from the command prompt by typing **IPConfig** and then pressing ENTER.</span></span> <span data-ttu-id="e5bfb-233">Знание этого адреса позволит сразу определить, связан ли трафик трассировки непосредственно с клиентского компьютера.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-233">Knowing this address will let you tell at a glance whether the traffic in the trace directly involves your client computer.</span></span> <span data-ttu-id="e5bfb-234">Если имеется известный прокси- сервер, прогонать его и получить его IP-адрес, а также.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-234">If there is a known proxy, ping it and get its IP address as well.</span></span>

- <span data-ttu-id="e5bfb-235">Смойте кэш разрешения DNS и, по возможности, закройте все браузеры, кроме браузера, в котором вы тестируете.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-235">Flush your DNS resolver cache and, if possible, close all browsers except the one in which you are running your tests.</span></span> <span data-ttu-id="e5bfb-236">Если вы не можете это сделать, например, если поддержка использует какой-либо инструмент на основе браузера, чтобы увидеть рабочий стол клиентского компьютера, будьте готовы к фильтрации трассировки.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-236">If you are not able to do this, for instance, if support is using some browser-based tool to see your client computer's desktop, be prepared to filter your trace.</span></span>

- <span data-ttu-id="e5bfb-237">В занятом следе найдите Office 365 службу, которую вы используете.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-237">In a busy trace, locate the Office 365 service that you're using.</span></span> <span data-ttu-id="e5bfb-238">Если вы никогда или редко видели трафик раньше, это полезный шаг в отделять проблему производительности от другого сетевого шума.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-238">If you've never or seldom seen your traffic before, this is a helpful step in separating the performance issue from other network noise.</span></span> <span data-ttu-id="e5bfb-239">Существует несколько способов сделать это.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-239">There are a few ways to do this.</span></span> <span data-ttu-id="e5bfb-240">Непосредственно перед тестом можно использовать _пинг_ или _psPing_ по URL-адресу определенной службы (или, `ping outlook.office365.com` `psping -4 microsoft-my.sharepoint.com:443` например).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-240">Directly before your test, you can use _ping_ or _PsPing_ against the URL of the specific service (`ping outlook.office365.com` or `psping -4 microsoft-my.sharepoint.com:443`, for example).</span></span> <span data-ttu-id="e5bfb-241">Вы также можете легко найти, что пинг или PsPing в netmon трассировки (по имени процесса).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-241">You can also easily find that ping or PsPing in a Netmon trace (by its process name).</span></span> <span data-ttu-id="e5bfb-242">Это даст вам место, чтобы начать искать.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-242">That will give you a place to start looking.</span></span>

<span data-ttu-id="e5bfb-243">Если вы используете трассировку Netmon только во время проблемы, это тоже нормально.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-243">If you're only using Netmon tracing at the time of the problem, that's okay too.</span></span> <span data-ttu-id="e5bfb-244">Чтобы ориентироваться, используйте фильтр like `ContainsBin(FrameData, ASCII, "office")` или `ContainsBin(FrameData, ASCII, "outlook")` .</span><span class="sxs-lookup"><span data-stu-id="e5bfb-244">To orient yourself, use a filter like `ContainsBin(FrameData, ASCII, "office")` or `ContainsBin(FrameData, ASCII, "outlook")`.</span></span> <span data-ttu-id="e5bfb-245">Вы можете записать номер кадра из файла трассировки.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-245">You can record your frame number from the trace file.</span></span> <span data-ttu-id="e5bfb-246">Кроме того, может потребоваться прокрутка области _сводки_ кадров вправо и искать столбец Conversation ID.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-246">You may also want to scroll the _Frame Summary_ pane all the way to the right and look for the Conversation ID column.</span></span> <span data-ttu-id="e5bfb-247">Существует номер, указанный там для ID этого конкретного разговора, что вы также можете записывать и смотреть в изоляции позже.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-247">There is a number indicated there for the ID of this specific conversation that you can also record and look at in isolation later.</span></span> <span data-ttu-id="e5bfb-248">Не забудьте удалить этот фильтр, прежде чем применять другие фильтры.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-248">Remember to remove this filter before applying any other filtering.</span></span>

> [!TIP]
> <span data-ttu-id="e5bfb-249">Netmon имеет много полезных встроенных фильтров.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-249">Netmon has a lot of helpful built-in filters.</span></span> <span data-ttu-id="e5bfb-250">Попробуйте **кнопку Фильтр нагрузки** в верхней части области _фильтра отображения._</span><span class="sxs-lookup"><span data-stu-id="e5bfb-250">Try the **Load Filter** button at the top of the _Display_ filter pane.</span></span>

![Найдите IP-адрес с помощью PSPing в командной строке на клиентском компьютере.](../media/4c43ac67-e28e-4536-842d-7add7aa28847.PNG)

![Netmon trace from the client showing the same PSPing command through the filter TCP. Flags.Syn == 1.](../media/0ae7ef7d-e003-4d01-a006-dc49bd1fcef2.PNG)

<span data-ttu-id="e5bfb-253&quot;>Ознакомьтесь с трафиком и узнайте, как найти необходимую информацию.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;e5bfb-253&quot;>Get familiar with your traffic, and learn to locate the information you need.</span></span> <span data-ttu-id=&quot;e5bfb-254&quot;>Например, узнайте, какой пакет в следе имеет первую ссылку на используемую службу Office 365 (например, &quot;Outlook").</span><span class="sxs-lookup"><span data-stu-id="e5bfb-254">For example, learn to determine which packet in the trace has the first reference to the Office 365 service you're using (like "Outlook").</span></span>

<span data-ttu-id="e5bfb-255">Пример Office 365 Outlook в Интернете, и трафик начинается так:</span><span class="sxs-lookup"><span data-stu-id="e5bfb-255">Taking Office 365 Outlook Online as an example, the traffic begins something like this:</span></span>

- <span data-ttu-id="e5bfb-256">Стандартный запрос DNS и ответ DNS для outlook.office365.com с соответствием queryIDs.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-256">DNS Standard Query and DNS Response for outlook.office365.com with matching QueryIDs.</span></span> <span data-ttu-id="e5bfb-257">Важно отметить смещение времени для этого поворота, а также то, где в мире Office 365 глобальной DNS отправляет запрос на разрешение имен.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-257">It's important to note the time offset for this turn-around, as well as where in the world the Office 365 Global DNS sends the request for name resolution.</span></span> <span data-ttu-id="e5bfb-258">В идеале, как можно локально, а не на полпути по всему миру.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-258">Ideally, as locally as possible, rather than halfway across the world.</span></span>

- <span data-ttu-id="e5bfb-259">Запрос HTTP GET, отчет о состоянии которого перенесен навсегда (301)</span><span class="sxs-lookup"><span data-stu-id="e5bfb-259">A HTTP GET Request whose status report Moved Permanently (301)</span></span>

- <span data-ttu-id="e5bfb-260">RWS Traffic, включая RWS Подключение запросы и Подключение ответы.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-260">RWS Traffic including RWS Connect requests and Connect replies.</span></span> <span data-ttu-id="e5bfb-261">(Это удаленный Уинсок, который делает подключение для вас.)</span><span class="sxs-lookup"><span data-stu-id="e5bfb-261">(This is Remote Winsock making a connection for you.)</span></span>

- <span data-ttu-id="e5bfb-262">Беседа TCP SYN и TCP SYN/ACK.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-262">A TCP SYN and TCP SYN/ACK conversation.</span></span> <span data-ttu-id="e5bfb-263">Многие параметры в этом разговоре влияют на производительность.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-263">A lot of the settings in this conversation impact your performance.</span></span>

- <span data-ttu-id="e5bfb-264">Затем состоится серия TLS:TLS-трафика, в котором проходят беседы о рукопожатии TLS и TLS-сертификатах.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-264">Then a series of TLS:TLS traffic which is where the TLS handshake and TLS certificate conversations take place.</span></span> <span data-ttu-id="e5bfb-265">(Помните, что данные шифруются с помощью SSL/TLS.)</span><span class="sxs-lookup"><span data-stu-id="e5bfb-265">(Remember the data is encrypted via SSL/TLS.)</span></span>

<span data-ttu-id="e5bfb-266">Все части трафика важны и подключены, но небольшие части трассировки содержат сведения, особенно важные с точки зрения устранения неполадок производительности, поэтому мы сосредоточимся на этих областях.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-266">All parts of the traffic are important and connected, but small portions of the trace contain information particularly important in terms of performance troubleshooting, so we'll focus on those areas.</span></span> <span data-ttu-id="e5bfb-267">Кроме того, поскольку мы сделали достаточно Office 365 устранения неполадок производительности в Корпорации Майкрософт для компиляции списка наиболее распространенных проблем, мы сосредоточимся на этих проблемах и о том, как использовать средства, которые необходимо устранить далее.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-267">Also, since we've done enough Office 365 performance troubleshooting at Microsoft to compile a Top Ten list of common problems, we'll focus on those issues and how to use the tools we have to root them out next.</span></span>

<span data-ttu-id="e5bfb-268">Если вы еще не установили их все готово, в приведенной ниже матрице используется несколько инструментов.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-268">If you haven't installed them all ready, the matrix below makes use of several tools.</span></span> <span data-ttu-id="e5bfb-269">Где это возможно.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-269">Where possible.</span></span> <span data-ttu-id="e5bfb-270">Ссылки предоставляются в пункты установки.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-270">Links are provided to the installation points.</span></span> <span data-ttu-id="e5bfb-271">В список включены распространенные средства отслеживания сетей, такие как [Netmon](https://www.microsoft.com/download/details.aspx?id=4865) и [Wireshark,](https://www.wireshark.org/)но используйте любое удобное средство отслеживания, в котором вы привыкли к фильтрации сетевого трафика.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-271">The list includes common network tracing tools like [Netmon](https://www.microsoft.com/download/details.aspx?id=4865) and [Wireshark](https://www.wireshark.org/), but use any tracing tool you are comfortable with, and in which you're accustomed to filtering network traffic.</span></span> <span data-ttu-id="e5bfb-272">При тестировании помните:</span><span class="sxs-lookup"><span data-stu-id="e5bfb-272">When you're testing, remember:</span></span>

- <span data-ttu-id="e5bfb-273">*Закройте браузеры и протестировать*  с помощью только одного браузера — это уменьшит общий трафик, который вы захватываете.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-273">*Close your browsers, and test with only one browser running*  - This will reduce the overall traffic you capture.</span></span> <span data-ttu-id="e5bfb-274">Это делает для менее занят след.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-274">It makes for a less busy trace.</span></span>
- <span data-ttu-id="e5bfb-275">*Смойте кэш*  разрешения DNS на клиентский компьютер . Это даст вам чистый сланец, когда вы начнете захват, для более чистого следа.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-275">*Flush your DNS resolver cache on the client computer*  - This will give you a clean slate when you start to take your capture, for a cleaner trace.</span></span>

## <a name="common-issues"></a><span data-ttu-id="e5bfb-276">Распространенные проблемы</span><span class="sxs-lookup"><span data-stu-id="e5bfb-276">Common issues</span></span>

<span data-ttu-id="e5bfb-277">Некоторые распространенные проблемы, с которые вы можете столкнуться, и их поиск в сетевом следе.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-277">Some common issues you may face and how to find them in your Network trace.</span></span>

### <a name="tcp-windows-scaling"></a><span data-ttu-id="e5bfb-278">Масштабирование Windows TCP</span><span class="sxs-lookup"><span data-stu-id="e5bfb-278">TCP Windows Scaling</span></span>

<span data-ttu-id="e5bfb-279">Найдено в syn - SYN/ACK.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-279">Found in the SYN - SYN/ACK.</span></span> <span data-ttu-id="e5bfb-280">Устаревшее или устаревшее оборудование может не использовать преимущества масштабирования окон TCP.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-280">Legacy or aging hardware may not take advantage of TCP windows scaling.</span></span>  <span data-ttu-id="e5bfb-281">Без надлежащих параметров масштабирования окон TCP 16-битный буфер в загонах TCP заполняет миллисекунд.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-281">Without proper TCP windows scaling settings, the default 16-bit buffer in TCP headers fills in milliseconds.</span></span>  <span data-ttu-id="e5bfb-282">Трафик не может продолжать отправляться, пока клиент не получит подтверждение о том, что исходные данные получены, что приводит к задержкам.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-282">Traffic cannot continue to send until the client receives an acknowledgment that the original data has been received, causing delays.</span></span>

#### <a name="tools"></a><span data-ttu-id="e5bfb-283">Инструменты</span><span class="sxs-lookup"><span data-stu-id="e5bfb-283">Tools</span></span>

- <span data-ttu-id="e5bfb-284">Netmon</span><span class="sxs-lookup"><span data-stu-id="e5bfb-284">Netmon</span></span>
- <span data-ttu-id="e5bfb-285">Wireshark</span><span class="sxs-lookup"><span data-stu-id="e5bfb-285">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="e5bfb-286">Что нужно искать</span><span class="sxs-lookup"><span data-stu-id="e5bfb-286">What to look for</span></span>

<span data-ttu-id="e5bfb-287">Найди трафик SYN - SYN/ACK в сетевом следе.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-287">Look for the SYN - SYN/ACK traffic in your network trace.</span></span>  <span data-ttu-id="e5bfb-288">В Netmon используйте фильтр типа  `tcp.flags.syn == 1` .</span><span class="sxs-lookup"><span data-stu-id="e5bfb-288">In Netmon, use a filter like  `tcp.flags.syn == 1`.</span></span> <span data-ttu-id="e5bfb-289">Этот фильтр является одинаковым в Wireshark.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-289">This filter is the same in Wireshark.</span></span>

![Фильтр в Netmon или Wireshark для пакетов Syn для обоих инструментов: TCP. Flags.Syn == 1.](../media/4b9a12a1-c915-43c8-ac2f-a679d0435a29.PNG)

<span data-ttu-id="e5bfb-291">Обратите внимание, что для каждого СИН имеется номер источника порта (SrcPort), соответствующий в порту назначения (DstPort) связанного подтверждения (SYN/ACK).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-291">Notice that for every SYN there is a source port (SrcPort) number that is matched in the destination port (DstPort) of the related Acknowledgment (SYN/ACK).</span></span>

<span data-ttu-id="e5bfb-292">Чтобы увидеть значение Windows масштабирования, используемой сетевым подключением, развяжи сначала СИН, а затем связанный syn/ACK.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-292">To see the Windows Scaling value that is used by your network connection, expand first the SYN, and then the related SYN/ACK.</span></span>

![На рисунке показано, как сопопобирать SrcPort с DstPort в следе, чтобы получить дельту времени.](../media/6a4ca573-0253-4fbd-93e8-92821ee1c351.png)

### <a name="tcp-idle-time-settings"></a><span data-ttu-id="e5bfb-294">Время ожидания TCP Параметры</span><span class="sxs-lookup"><span data-stu-id="e5bfb-294">TCP Idle Time Settings</span></span>

<span data-ttu-id="e5bfb-295">Исторически большинство сетей периметра настроены для переходных подключений, что означает, что простаиваемые подключения обычно прекращаются.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-295">Historically, most perimeter networks are configured for transient connections, meaning idle connections are generally terminated.</span></span> <span data-ttu-id="e5bfb-296">Сеансы ожидания TCP могут быть прекращены прокси-службами и брандмауэрами более чем за 100-300 секунд.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-296">Idle TCP sessions can be terminated by proxies and firewalls at greater than 100 to 300 seconds.</span></span> <span data-ttu-id="e5bfb-297">Это проблематично для Outlook Online, так как оно создает и использует долгосрочные подключения независимо от того, простаивают они или нет.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-297">This is problematic for Outlook Online because it creates and uses long-term connections, whether they are idle or not.</span></span>

<span data-ttu-id="e5bfb-298">Когда подключение прекращается с помощью прокси-серверов или брандмауэров, клиент не информируется, а попытка использовать Outlook Online будет означать, что клиентский компьютер будет пытаться повторно восстановить подключение перед созданием нового.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-298">When connections are terminated by proxy or firewall devices, the client is not informed, and an attempt to use Outlook Online will mean a client computer will try, repeatedly, to revive the connection before making a new one.</span></span> <span data-ttu-id="e5bfb-299">Вы можете увидеть зависает в продукте, подсказки, или медленная производительность на странице нагрузки.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-299">You may see hangs in the product, prompts, or slow performance on page load.</span></span>

#### <a name="tools"></a><span data-ttu-id="e5bfb-300">Инструменты</span><span class="sxs-lookup"><span data-stu-id="e5bfb-300">Tools</span></span>

- <span data-ttu-id="e5bfb-301">Netmon</span><span class="sxs-lookup"><span data-stu-id="e5bfb-301">Netmon</span></span>
- <span data-ttu-id="e5bfb-302">Wireshark</span><span class="sxs-lookup"><span data-stu-id="e5bfb-302">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="e5bfb-303">Что нужно искать</span><span class="sxs-lookup"><span data-stu-id="e5bfb-303">What to look for</span></span>

<span data-ttu-id="e5bfb-304">В Netmon посмотрите на поле Смещение времени для круговой поездки.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-304">In Netmon, look at the Time Offset field for a round-trip.</span></span> <span data-ttu-id="e5bfb-305">Круговая поездка — это время между отправкой запроса клиента на сервер и получением ответа обратно.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-305">A round-trip is the time between client sending a request to the server and receiving a response back.</span></span> <span data-ttu-id="e5bfb-306">Проверьте между клиентом и точкой отступа (например.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-306">Check between the Client and the egress point (ex.</span></span> <span data-ttu-id="e5bfb-307">Клиент -- Прокси) или клиент \> для Office 365 (клиент \> -- Office 365).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-307">Client --\> Proxy), or the Client to Office 365 (Client --\> Office 365).</span></span> <span data-ttu-id="e5bfb-308">Это можно увидеть во многих типах пакетов.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-308">You can see this in many types of packets.</span></span>

<span data-ttu-id="e5bfb-309">Например, фильтр в Netmon может выглядеть  `.Protocol.IPv4.Address == 10.102.14.112 AND .Protocol.IPv4.Address == 10.201.114.12` как , или, в Wireshark,  `ip.addr == 10.102.14.112 &amp;&amp; ip.addr == 10.201.114.12` .</span><span class="sxs-lookup"><span data-stu-id="e5bfb-309">As an example, the filter in Netmon may look like  `.Protocol.IPv4.Address == 10.102.14.112 AND .Protocol.IPv4.Address == 10.201.114.12`, or, in Wireshark,  `ip.addr == 10.102.14.112 &amp;&amp; ip.addr == 10.201.114.12`.</span></span>

> [!TIP]
> <span data-ttu-id="e5bfb-310">Не знаете, принадлежит ли IP-адрес вашего следа вашему DNS-серверу?</span><span class="sxs-lookup"><span data-stu-id="e5bfb-310">Don't know if the IP address in your trace belongs to your DNS server?</span></span> <span data-ttu-id="e5bfb-311">Попробуйте найти его в командной строке.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-311">Try looking it up at the command line.</span></span> <span data-ttu-id="e5bfb-312">Нажмите **кнопку Начните** запуск и введите \>  \> **cmd** или **нажмите клавишу Windows и** \> введите **cmd**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-312">Click **Start** \> **Run** \> and type **cmd**, or press **Windows Key** \> and type **cmd**.</span></span> <span data-ttu-id="e5bfb-313">В запросе введите  `nslookup <the IP address from the network trace>` .</span><span class="sxs-lookup"><span data-stu-id="e5bfb-313">At the prompt, type  `nslookup <the IP address from the network trace>`.</span></span> <span data-ttu-id="e5bfb-314">Чтобы проверить, используйте nslookup для IP-адреса собственного компьютера.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-314">To test, use nslookup against your own computer's IP address.</span></span> <span data-ttu-id="e5bfb-315">> список ip-диапазонов Корпорации Майкрософт см. в Office 365 [URL-адресов и диапазонов IP-адресов.](./urls-and-ip-address-ranges.md)</span><span class="sxs-lookup"><span data-stu-id="e5bfb-315">> To see a list of Microsoft's IP ranges, see [Office 365 URLs and IP address ranges](./urls-and-ip-address-ranges.md).</span></span>

<span data-ttu-id="e5bfb-316">Если возникла проблема, ожидайте появления длинных смещений времени в этом случае (Outlook Online), особенно в пакетах TLS:TLS, которые показывают прохождение данных приложений (например, в Netmon можно найти пакеты данных приложений с помощью `.Protocol.TLS AND Description == "TLS:TLS Rec Layer-1 SSL Application Data"` ).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-316">If there is a problem, expect long Time Offsets to appear, in this case (Outlook Online), particularly in TLS:TLS packets that show the passage of Application Data (for example, in Netmon you can find application data packets via  `.Protocol.TLS AND Description == "TLS:TLS Rec Layer-1 SSL Application Data"`).</span></span> <span data-ttu-id="e5bfb-317">Вы должны видеть плавную прогрессию во время сеанса.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-317">You should see a smooth progression in the time across the session.</span></span> <span data-ttu-id="e5bfb-318">Если вы видите длительные задержки при Outlook в Интернете, это может быть вызвано высокой степенью отгружаемой.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-318">If you see long delays when refreshing your Outlook Online, this could be caused by a high degree of resets being sent.</span></span>

### <a name="latencyround-trip-time"></a><span data-ttu-id="e5bfb-319">Время задержки и обратного пути</span><span class="sxs-lookup"><span data-stu-id="e5bfb-319">Latency/Round Trip Time</span></span>

<span data-ttu-id="e5bfb-320">Задержка — это мера, которая может многое изменить в зависимости от многих переменных, таких, как обновление устройств старения, добавление большого количества пользователей в сеть и процент общей пропускной способности, потребляемой другими задачами на сетевом подключении.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-320">Latency is a measure that can change a lot depending on many variables, such upgrading aging devices, adding a large number of users to a network, and the percentage of overall bandwidth consumed by other tasks on a network connection.</span></span>

<span data-ttu-id="e5bfb-321">Существуют калькуляторы пропускной способности для Office 365 для этого сетевого планирования и настройки [производительности для Office 365](network-planning-and-performance.md) страницы.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-321">There are bandwidth calculators for Office 365 available from this [Network planning and performance tuning for Office 365](network-planning-and-performance.md) page.</span></span>

<span data-ttu-id="e5bfb-322">Необходимо измерить скорость подключения или пропускную способность подключения к интернет-каналу?</span><span class="sxs-lookup"><span data-stu-id="e5bfb-322">Need to measure the speed of your connection, or your ISP connection's bandwidth?</span></span> <span data-ttu-id="e5bfb-323">Попробуйте этот сайт (или сайты, как он): [Speedtest Официальный сайт](https://www.speedtest.net/), или запрос вашей любимой поисковой системы для теста **скорости фразы**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-323">Try this site (or sites like it): [Speedtest Official Site](https://www.speedtest.net/), or query your favorite search engine for the phrase **speed test**.</span></span>

#### <a name="tools"></a><span data-ttu-id="e5bfb-324">Инструменты</span><span class="sxs-lookup"><span data-stu-id="e5bfb-324">Tools</span></span>

- <span data-ttu-id="e5bfb-325">Ping</span><span class="sxs-lookup"><span data-stu-id="e5bfb-325">Ping</span></span>
- <span data-ttu-id="e5bfb-326">PsPing</span><span class="sxs-lookup"><span data-stu-id="e5bfb-326">PsPing</span></span>
- <span data-ttu-id="e5bfb-327">Netmon</span><span class="sxs-lookup"><span data-stu-id="e5bfb-327">Netmon</span></span>
- <span data-ttu-id="e5bfb-328">Wireshark</span><span class="sxs-lookup"><span data-stu-id="e5bfb-328">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="e5bfb-329">Что нужно искать</span><span class="sxs-lookup"><span data-stu-id="e5bfb-329">What to look for</span></span>

<span data-ttu-id="e5bfb-330">Чтобы отслеживать задержку в трассировке, вы сможете зафиксировать IP-адрес клиентского компьютера и IP-адрес DNS-сервера в Office 365.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-330">To track latency in a trace, you will benefit from having recorded the client computer IP address and the IP address of the DNS server in Office 365.</span></span> <span data-ttu-id="e5bfb-331">Это делается для более легкой фильтрации трассировки.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-331">This is for the purpose of easier trace filtering.</span></span> <span data-ttu-id="e5bfb-332">При подключении через прокси-сервер вам потребуется IP-адрес клиентского компьютера, IP-адрес прокси/egress и ip-адрес Office 365 DNS, чтобы упростить работу.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-332">If you connect through a proxy, you will need your client computer IP address, the proxy/egress IP address, and the Office 365 DNS IP address, to make the work easier.</span></span>

<span data-ttu-id="e5bfb-333">В запросе ping, отправленном в outlook.office365.com, будет названо имя центра обработки данных, получающие запрос, даже если  *ping*  не сможет подключиться для отправки последовательных пакетов ICMP товарного знака.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-333">A ping request sent to outlook.office365.com will tell you the name of the datacenter receiving the request, even if ping  *may*  not be able to connect to send the trademark consecutive ICMP packets.</span></span> <span data-ttu-id="e5bfb-334">Если вы используете PsPing (бесплатный инструмент для скачивания) и укатерите порт (443) и, возможно, для использования IPv4 (-4), вы получите среднее время в пути для отправленных пакетов.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-334">If you use PsPing (a free tool for download), and specific the port (443) and perhaps to use IPv4 (-4) you will get an average round-trip-time for packets sent.</span></span> <span data-ttu-id="e5bfb-335">Это будет работать для других URL-адресов в Office 365, например `psping -4 yourSite.sharepoint.com:443` .</span><span class="sxs-lookup"><span data-stu-id="e5bfb-335">This will work this for other URLs in the Office 365 services, like `psping -4 yourSite.sharepoint.com:443`.</span></span> <span data-ttu-id="e5bfb-336">В самом деле, вы можете указать ряд 1000 000, чтобы получить больший пример для среднего, попробуйте что-то вроде `psping -4 -n 20 yourSite-my.sharepoint.com:443` .</span><span class="sxs-lookup"><span data-stu-id="e5bfb-336">In fact, you can specify a number of pings to get a larger sample for your average, try something like `psping -4 -n 20 yourSite-my.sharepoint.com:443`.</span></span>

> [!NOTE]
> <span data-ttu-id="e5bfb-337">PsPing не отправляет пакеты ICMP.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-337">PsPing doesn't send ICMP packets.</span></span> <span data-ttu-id="e5bfb-338">Он pings с пакетами TCP над определенным портом, поэтому вы можете использовать любой, который вы знаете, чтобы быть открытым.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-338">It pings with TCP packets over a specific port, so you can use any one you know to be open.</span></span> <span data-ttu-id="e5bfb-339">В Office 365, который использует SSL/TLS, попробуйте прикрепить порт :443 к psPing.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-339">In Office 365, which uses SSL/TLS, try attaching port :443 to your PsPing.</span></span>

![Снимок экрана с разрешением пинга outlook.office365.com и PSPing с 443 аналогичными данными, но также отчеты о среднем RTT в 6,5 мс.](../media/c64339f2-2c96-45b8-b168-c2a060430266.PNG)

<span data-ttu-id="e5bfb-341">Если вы загрузили медленную страницу Office 365 при выполнении сетевого трассировки, необходимо отфильтровать трассировку Netmon или Wireshark `DNS` для .</span><span class="sxs-lookup"><span data-stu-id="e5bfb-341">If you loaded the slow performing Office 365 page while doing a network trace, you should filter a Netmon or Wireshark trace for `DNS`.</span></span> <span data-ttu-id="e5bfb-342">Это один из ИП, который мы ищем.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-342">This is one of the IPs we're looking for.</span></span>

<span data-ttu-id="e5bfb-343">Вот шаги, которые необходимо предпринять для фильтрации Netmon, чтобы получить IP-адрес (и взглянуть на задержку DNS).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-343">Here are the steps to take to filter your Netmon to get the IP address (and take a look at DNS Latency).</span></span> <span data-ttu-id="e5bfb-344">В этом примере outlook.office365.com, но может также использовать URL-адрес клиента SharePoint Online (например, hithere.sharepoint.com).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-344">This example uses outlook.office365.com, but may also use the URL of a SharePoint Online tenant (hithere.sharepoint.com for example).</span></span>

1. <span data-ttu-id="e5bfb-345">Ping URL-адрес и, в результатах, запись имени и `ping outlook.office365.com` IP-адреса сервера DNS запрос был отправлен.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-345">Ping the URL `ping outlook.office365.com` and, in the results, record the name and IP address of the DNS server the ping request was sent to.</span></span>
2. <span data-ttu-id="e5bfb-346">Сетевой след, открывая страницу, или делая действия, которые дают вам проблему производительности, или, если вы видите высокую задержку на ping, сама сеть отслеживает ее.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-346">Network trace opening the page, or doing the action that gives you the performance problem, or, if you see a high latency on the ping, itself, network trace it.</span></span>
3. <span data-ttu-id="e5bfb-347">Откройте трассировку в Netmon и фильтр для DNS (этот фильтр также работает в Wireshark, но чувствителен к `-- dns` делу).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-347">Open the trace in Netmon and filter for DNS (this filter also works in Wireshark, but is sensitive to case `-- dns`).</span></span> <span data-ttu-id="e5bfb-348">Так как вы знаете имя DNS-сервера из вашего ping, вы также можете фильтровать более быстро в Netmon, как это: , который выглядит так в dns Wireshark и кадр содержит `DNS AND ContainsBin(FrameData, ASCII, "namnorthwest")` "namnorthwest".</span><span class="sxs-lookup"><span data-stu-id="e5bfb-348">Since you know the name of the DNS server from your ping you may also filter more speedily in Netmon like this: `DNS AND ContainsBin(FrameData, ASCII, "namnorthwest")`, which looks like this in Wireshark dns and frame contains "namnorthwest".</span></span><br/><span data-ttu-id="e5bfb-349">Откройте пакет ответов и в окне Сведения о кадре **Netmon** щелкните **DNS,** чтобы расширить для получения дополнительных сведений.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-349">Open the response packet and, in the Netmon **Frame Details** window, click **DNS** to expand for more information.</span></span> <span data-ttu-id="e5bfb-350">В DNS-информации вы найдете IP-адрес сервера DNS, на который поступил запрос в Office 365.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-350">In the DNS information you'll find the IP address of the DNS server the request went to in Office 365.</span></span> <span data-ttu-id="e5bfb-351">Этот IP-адрес потребуется для следующего шага (средства PsPing).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-351">You'll need this IP address for the next step (the PsPing tool).</span></span> <span data-ttu-id="e5bfb-352">Удалите фильтр, щелкните правой кнопкой мыши на ответ DNS в Netmon (Сводка кадров \> **Найти** \> **беседы DNS**), чтобы увидеть DNS-запрос и ответ бок о бок.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-352">Remove the filter, right-click on the DNS Response in Netmon (**Frame Summary** \> **Find Conversations** \> **DNS**) to see the DNS Query and Response side-by-side.</span></span>
4. <span data-ttu-id="e5bfb-353">В Netmon также обратите внимание на столбец Смещение времени между запросом DNS и ответом.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-353">In Netmon, also note the Time Offset  column between the DNS Request and Response.</span></span> <span data-ttu-id="e5bfb-354">На следующем шаге средство [PsPing,](/sysinternals/downloads/psping) легкое в установке и использовании, очень удобно, так как ICMP часто блокируется на брандмауэрах, а также потому, что PsPing элегантно отслеживает задержку в миллисекунд.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-354">In the next step, the easy-to-install and use [PsPing](/sysinternals/downloads/psping) tool comes in very handy, both because ICMP is often blocked on Firewalls, and because PsPing elegantly tracks latency in milliseconds.</span></span> <span data-ttu-id="e5bfb-355">PsPing завершает подключение TCP к адресу и порту (в нашем случае открытый порт 443).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-355">PsPing completes a TCP connection to an address and port (in our case open port 443).</span></span>
5. <span data-ttu-id="e5bfb-356">Установка PsPing.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-356">Install PsPing.</span></span>
6. <span data-ttu-id="e5bfb-357">Откройте командную подсказку (командный код типа запуска или Windows ключа) и измените каталог в каталог, в котором установлен PsPing для запуска \> \> команды \> PsPing.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-357">Open a command prompt (Start \> Run \> type cmd, or Windows Key \> type cmd) and change directory to the directory where you installed PsPing to run the PsPing command.</span></span> <span data-ttu-id="e5bfb-358">В моих примерах вы можете увидеть, как я сделал папку "Perf" на корневой части C. Вы можете сделать то же самое для быстрого доступа.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-358">In my examples you can see I made a 'Perf' folder on the root of C. You can do the same for quick access.</span></span>
7. <span data-ttu-id="e5bfb-359">Введите команду, чтобы сделать psPing с IP-адресом сервера DNS Office 365 от предыдущего следа Netmon, включая номер порта, например `psping -n 20 132.245.24.82:445` .</span><span class="sxs-lookup"><span data-stu-id="e5bfb-359">Type the command so that you're making your PsPing against the IP address of the Office 365 DNS server from your earlier Netmon trace, including the port number, like `psping -n 20 132.245.24.82:445`.</span></span> <span data-ttu-id="e5bfb-360">Это позволит вам сделать выборку из 20 пингов и усреднить задержку при остановке psPing.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-360">This will give you a sampling of 20 pings and average the latency when PsPing stops.</span></span>

<span data-ttu-id="e5bfb-361">Если вы собираетесь Office 365 через прокси-сервер, действия немного отличаются.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-361">If you're going to Office 365 through a proxy server, the steps are a little different.</span></span> <span data-ttu-id="e5bfb-362">Сначала psPing на прокси-сервере, чтобы получить среднее значение задержки в миллисекунд до прокси/egress и обратно, а затем либо запустить PsPing на прокси-сервере или на компьютере с прямым подключением к Интернету, чтобы получить недостающее значение (от одного до Office 365 и обратно).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-362">You would first PsPing to your proxy server to get an average latency value in milliseconds to proxy/egress and back, and then either run PsPing on the proxy, or on a computer with a direct Internet connection to get the missing value (the one to Office 365 and back).</span></span>

<span data-ttu-id="e5bfb-363">Если вы решите выполнить psPing из прокси-сервера, у вас будет два миллисекундных значения: клиентский компьютер до прокси-сервера или точки отступа, а прокси-сервер — Office 365.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-363">If you choose to run PsPing from the proxy, you'll have two millisecond values: Client computer to proxy server or egress point, and proxy server to Office 365.</span></span> <span data-ttu-id="e5bfb-364">И вы закончили!</span><span class="sxs-lookup"><span data-stu-id="e5bfb-364">And you're done!</span></span> <span data-ttu-id="e5bfb-365">Ну, записи значений, в любом случае.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-365">Well, recording values, anyway.</span></span>

<span data-ttu-id="e5bfb-366">Если вы запустите PsPing на другом клиентском компьютере, который имеет прямое подключение к Интернету, то есть без прокси-сервера, у вас будет два миллисекундных значения: клиентский компьютер на прокси-сервер или точку отступа и клиентский компьютер для Office 365.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-366">If you run PsPing on another client computer that has a direct connection to the Internet, that is, without a proxy, you will have two millisecond values: Client computer to proxy server or egress point, and client computer to Office 365.</span></span> <span data-ttu-id="e5bfb-367">В этом случае вычитайте значение клиентского компьютера на прокси-сервер или точку регресса от значения клиентского компьютера до Office 365, и у вас будут номера RTT с клиентского компьютера на прокси-сервер или точку отступа, а с прокси-сервера или отступа точки на Office 365.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-367">In this case, subtract the value of client computer to proxy server or egress point from the value of client computer to Office 365, and you will have the RTT numbers from your client computer to the proxy server or egress point, and from proxy server or egress point to Office 365.</span></span>

<span data-ttu-id="e5bfb-368">Однако если вы можете найти клиентский компьютер в непосредственном подключенном расположении или обойти прокси-сервер, вы можете проверить, воспроизводится ли проблема, и протестировать его использование после этого.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-368">However, if you can find a client computer in the impacted location that is directly connected, or bypasses the proxy, you may choose to see if the issue reproduces there to begin with, and test using it thereafter.</span></span>

<span data-ttu-id="e5bfb-369">Задержки, как понаблизали в следе Netmon, эти дополнительные миллисекунды можно добавить, если их достаточно в любом сеансе.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-369">Latency, as seen in a Netmon trace, those extra milliseconds can add up, if there are enough of them in any given session.</span></span>

![Показана общая задержка в Netmon, при этом заданный по умолчанию столбец "Time Delta" (Смещение по времени) добавлен в раздел "Frame Summary" (Сводка по фреймам).](../media/7ad17380-8527-4bc2-9b9b-6310cf19ba6b.PNG)

> [!NOTE]
> <span data-ttu-id="e5bfb-371">Ваш IP-адрес может быть другим, чем ip-адреса, показанные здесь, например, ваш ing может возвращать что-то большее, как 157.56.0.0/16 или аналогичный диапазон.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-371">Your IP address may be different than the IPs shown here, for example, your ping may return something more like 157.56.0.0/16 or a similar range.</span></span> <span data-ttu-id="e5bfb-372">Список диапазонов, используемых Office 365, Office 365 [URL-адресов и IP-адресов.](./urls-and-ip-address-ranges.md)</span><span class="sxs-lookup"><span data-stu-id="e5bfb-372">For a list of ranges used by Office 365, check out [Office 365 URLs and IP address ranges](./urls-and-ip-address-ranges.md).</span></span>

<span data-ttu-id="e5bfb-373">Не забудьте расширить все узлы (в верхней части есть кнопка для этого), если вы хотите найти, например, 132.245.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-373">Remember to expand all the nodes (there's a button at the top for this) if you want to search for, for example, 132.245.</span></span>

### <a name="proxy-authentication"></a><span data-ttu-id="e5bfb-374">Проверка подлинности прокси</span><span class="sxs-lookup"><span data-stu-id="e5bfb-374">Proxy Authentication</span></span>

<span data-ttu-id="e5bfb-375">Это относится только к вам, если вы проходите через прокси-сервер.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-375">This only applies to you if you're going through a proxy server.</span></span> <span data-ttu-id="e5bfb-376">Если нет, можно пропустить эти действия.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-376">If not, you can skip these steps.</span></span> <span data-ttu-id="e5bfb-377">При правильной работе проверка подлинности прокси должна проходить в миллисекунах последовательно.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-377">When working properly, proxy authentication should take place in milliseconds, consistently.</span></span> <span data-ttu-id="e5bfb-378">Не следует видеть прерывную плохую производительность во время пиковых периодов использования (например).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-378">You shouldn't see intermittent bad performance during peak usage periods (for example).</span></span>

<span data-ttu-id="e5bfb-379">Если проверка подлинности прокси-серверов будет подключена, каждый раз, когда вы Office 365 подключение к TCP для получения информации, вам необходимо пройти процесс проверки подлинности за кулисами.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-379">If Proxy authentication is on, each time you make a new TCP connection to Office 365 to get information, you need to pass through an authentication process behind the scenes.</span></span> <span data-ttu-id="e5bfb-380">Например, при переходе с календаря на почту в Outlook Online вы пройдете проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-380">So, for example, when switching from Calendar to Mail in Outlook Online, you will authenticate.</span></span> <span data-ttu-id="e5bfb-381">И в SharePoint Online, если страница отображает носители или данные с нескольких сайтов или местоположений, вы пройдете проверку подлинности для каждого подключения TCP, необходимого для отрисовки данных.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-381">And in SharePoint Online, if a page displays media or data from multiple sites or locations, you will authenticate for each different TCP connection that is needed in order to render the data.</span></span>

<span data-ttu-id="e5bfb-382">В Outlook Online вы можете испытывать медленные нагрузки при переходе между календарем и почтовым ящиком или медленные загрузки страниц в SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-382">In Outlook Online, you may experience slow load times whenever you switch between Calendar and your mailbox, or slow page loads in SharePoint Online.</span></span> <span data-ttu-id="e5bfb-383">Однако здесь не указаны другие симптомы.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-383">However, there are other symptoms not listed here.</span></span>

<span data-ttu-id="e5bfb-384">Проверка подлинности прокси — это параметр на сервере прокси-сервера egress.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-384">Proxy authentication is a setting on your egress proxy server.</span></span> <span data-ttu-id="e5bfb-385">Если из-за этого с Office 365 проблемы с производительностью, необходимо проконсультироваться с сетевой командой.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-385">If it is causing a performance issue with Office 365, you must consult your networking team.</span></span>

#### <a name="tools"></a><span data-ttu-id="e5bfb-386">Инструменты</span><span class="sxs-lookup"><span data-stu-id="e5bfb-386">Tools</span></span>

- <span data-ttu-id="e5bfb-387">Netmon</span><span class="sxs-lookup"><span data-stu-id="e5bfb-387">Netmon</span></span>
- <span data-ttu-id="e5bfb-388">Wireshark</span><span class="sxs-lookup"><span data-stu-id="e5bfb-388">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="e5bfb-389">Что нужно искать</span><span class="sxs-lookup"><span data-stu-id="e5bfb-389">What to look for</span></span>

<span data-ttu-id="e5bfb-390">Проверка подлинности прокси происходит всякий раз, когда необходимо разворачивать новый сеанс TCP, как правило, для запроса файлов или информации с сервера или для подачи информации.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-390">Proxy authentication takes place whenever a new TCP session must be spun up, commonly to request files or info from the server, or to supply info.</span></span> <span data-ttu-id="e5bfb-391">Например, вы можете увидеть проверку подлинности прокси в запросах HTTP GET или HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-391">For example, you may see proxy authentication around HTTP GET or HTTP POST requests.</span></span> <span data-ttu-id="e5bfb-392">Если вы хотите увидеть кадры, в которых вы запрашиваете проверку подлинности в трассировке, добавьте столбец "NTLMSSP Summary" в Netmon и фильтруйте  `.property.NTLMSSPSummary` .</span><span class="sxs-lookup"><span data-stu-id="e5bfb-392">If you want to see the frames where you are authenticating requests in your trace, add the 'NTLMSSP Summary' column to Netmon and filter for  `.property.NTLMSSPSummary`.</span></span> <span data-ttu-id="e5bfb-393">Чтобы узнать, как долго проходит проверка подлинности, добавьте столбец "Дельта времени".</span><span class="sxs-lookup"><span data-stu-id="e5bfb-393">To see how long the authentication is taking, add the Time Delta column.</span></span>

<span data-ttu-id="e5bfb-394">Добавление столбца в Netmon:</span><span class="sxs-lookup"><span data-stu-id="e5bfb-394">To add a column to Netmon:</span></span>

1. <span data-ttu-id="e5bfb-395">Щелкните правой кнопкой мыши столбец, например **Description**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-395">Right-click on a column such as **Description**.</span></span>
2. <span data-ttu-id="e5bfb-396">Щелкните **Выберите столбцы**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-396">Click **Choose Columns**.</span></span>
3. <span data-ttu-id="e5bfb-397">Найдите _сводку NTLMSSP_ и _дельту времени_ в списке и нажмите **кнопку Добавить**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-397">Locate _NTLMSSP Summary_ and _Time Delta_ in the list and click **Add**.</span></span>
4. <span data-ttu-id="e5bfb-398">Перемещение новых столбцов на место до или за столбцом _Описание,_ чтобы вы могли читать их бок о бок.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-398">Move the new columns into place before or behind the _Description_ column so you can read them side-by-side.</span></span>
5. <span data-ttu-id="e5bfb-399">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-399">Click **OK**.</span></span>

<span data-ttu-id="e5bfb-400">Даже если столбец не добавляется, фильтр Netmon будет работать.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-400">Even if you don't add the column, the Netmon filter will work.</span></span> <span data-ttu-id="e5bfb-401">Но устранение неполадок будет намного проще, если вы увидите, на каком этапе проверки подлинности вы в настоящее время.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-401">But your troubleshooting will be much easier if you can see what stage of authentication you're in.</span></span>

<span data-ttu-id="e5bfb-402">При поиске экземпляров проверки подлинности прокси-серверов обязательно изучите все кадры, на которых существует проблема NTLM или присутствует сообщение проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-402">When looking for instances of Proxy Authentication, be sure to study all frames where there is an NTLM Challenge, or an Authenticate Message is present.</span></span> <span data-ttu-id="e5bfb-403">При необходимости щелкните правой кнопкой мыши определенный элемент трафика и выберите TCP "Поиск \> разговоров".</span><span class="sxs-lookup"><span data-stu-id="e5bfb-403">If necessary, right-click the specific piece of traffic and Find Conversations \> TCP.</span></span> <span data-ttu-id="e5bfb-404">Будьте в курсе значений дельты времени в этих беседах.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-404">Be aware of the Time Delta values in these Conversations.</span></span>

![Трассировка Netmon, показывающая проверку подлинности прокси, фильтруемая путем беседы.](../media/b640f176-0a52-4bbb-972e-60fb3d6aece2.PNG)

<span data-ttu-id="e5bfb-406">Четырех секундная задержка проверки подлинности прокси, как положено в Wireshark.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-406">A four second delay in proxy authentication as seen in Wireshark.</span></span> <span data-ttu-id="e5bfb-407">Дельта **времени из** предыдущего отображаемого столбца кадра была выполнена с помощью правой щелкнув поле с таким же именем в деталях кадра и выбрав Add as Column.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-407">The **Time delta from previous displayed frame** column was made via right-clicking the field of the same name in the frame details and selecting Add as Column.</span></span>  <br/> <span data-ttu-id="e5bfb-408">![В Wireshark столбец "Время из предыдущего отображаемого кадра" можно сделать правой кнопкой мыши поле с таким же именем в деталях кадра и выбрать Добавить в качестве столбца.](../media/f5b7bde4-8067-4ee0-bc7f-e9062ce1ba6f.PNG)</span><span class="sxs-lookup"><span data-stu-id="e5bfb-408">![In Wireshark, the 'Time delta from previous displayed frame' column can be made via right-clicking the field of the same name in the frame details and selecting Add as Column.](../media/f5b7bde4-8067-4ee0-bc7f-e9062ce1ba6f.PNG)</span></span>

### <a name="dns-performance"></a><span data-ttu-id="e5bfb-409">Производительность DNS</span><span class="sxs-lookup"><span data-stu-id="e5bfb-409">DNS Performance</span></span>

<span data-ttu-id="e5bfb-410">Разрешение имен работает наилучшим образом и быстрее всего, если оно происходит как можно ближе к стране клиента.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-410">Name resolution works best and most quickly when it takes place as close to the client's country as possible.</span></span>

<span data-ttu-id="e5bfb-411">Если разрешение имен DNS происходит за границей, он может добавлять секунды к нагрузкам на страницу.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-411">If DNS name resolution is taking place overseas, it can add seconds to page loads.</span></span> <span data-ttu-id="e5bfb-412">В идеале разрешение имен происходит в менее 100 мс.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-412">Ideally, name resolution happens in under 100ms.</span></span> <span data-ttu-id="e5bfb-413">Если нет, то следует дополнительно и расследование.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-413">If not, you should do further investigation.</span></span>

> [!TIP]
> <span data-ttu-id="e5bfb-414">Не знаете, как работает подключение клиентов в Office 365?</span><span class="sxs-lookup"><span data-stu-id="e5bfb-414">Not sure how Client Connectivity works in Office 365?</span></span> <span data-ttu-id="e5bfb-415">Взгляните на справочный документ клиентской подключения [здесь](/previous-versions//dn741250(v=technet.10)).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-415">Take a look at the Client Connectivity Reference document [here](/previous-versions//dn741250(v=technet.10)).</span></span>

#### <a name="tools"></a><span data-ttu-id="e5bfb-416">Инструменты</span><span class="sxs-lookup"><span data-stu-id="e5bfb-416">Tools</span></span>

- <span data-ttu-id="e5bfb-417">Netmon</span><span class="sxs-lookup"><span data-stu-id="e5bfb-417">Netmon</span></span>
- <span data-ttu-id="e5bfb-418">Wireshark</span><span class="sxs-lookup"><span data-stu-id="e5bfb-418">Wireshark</span></span>
- <span data-ttu-id="e5bfb-419">PsPing</span><span class="sxs-lookup"><span data-stu-id="e5bfb-419">PsPing</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="e5bfb-420">Что нужно искать</span><span class="sxs-lookup"><span data-stu-id="e5bfb-420">What to look for</span></span>

<span data-ttu-id="e5bfb-421">Анализ производительности DNS обычно является другой задачей для сетевого трассировки.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-421">Analyzing DNS performance is typically another job for a network trace.</span></span> <span data-ttu-id="e5bfb-422">Тем не менее, psPing также помогает в праве в или вне, возможной причине.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-422">However, PsPing is also helpful in ruling in, or out, a possible cause.</span></span>

<span data-ttu-id="e5bfb-423">Трафик DNS основан на запросах TCP и UDP, и ответы четко помечены ИД, который поможет соответствовать определенному запросу с его конкретным ответом.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-423">DNS traffic is based on TCP and UDP requests and responses are clearly marked with an ID that will help to match a specific request with its specific response.</span></span> <span data-ttu-id="e5bfb-424">Вы увидите трафик DNS, когда, например, SharePoint Online использует сетевое имя или URL-адрес на веб-странице.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-424">You'll see DNS traffic when, for example, SharePoint Online uses a network name or URL on a web page.</span></span> <span data-ttu-id="e5bfb-425">Как правило, большая часть этого трафика, за исключением передачи Зон, проходит через UDP.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-425">As a rule of thumb, most of this traffic, except when transferring Zones, runs over UDP.</span></span>

<span data-ttu-id="e5bfb-426">В Netmon и Wireshark самый простой фильтр, который позволит вам взглянуть на трафик DNS, это просто `dns` .</span><span class="sxs-lookup"><span data-stu-id="e5bfb-426">In both Netmon and Wireshark, the most basic filter that will let you look at DNS traffic is simply `dns`.</span></span> <span data-ttu-id="e5bfb-427">Не забудьте использовать нижний корпус при указании фильтра.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-427">Be sure to use lower case when specifying the filter.</span></span> <span data-ttu-id="e5bfb-428">Не забудьте смыть кэш разрешения DNS перед началом воспроизведения проблемы на клиентский компьютер.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-428">Remember to flush your DNS resolver cache before you begin to reproduce the issue on your client computer.</span></span> <span data-ttu-id="e5bfb-429">Например, при медленной загрузке страницы SharePoint Online для домашней страницы необходимо закрыть все браузеры, открыть новый браузер, начать отслеживание, смыть кэш разрешения DNS и просмотреть веб-сайт SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-429">For example, if you have a slow SharePoint Online page load for the Home page, you should close all browsers, open a new browser, start tracing, flush your DNS resolver cache, and browse to your SharePoint Online site.</span></span> <span data-ttu-id="e5bfb-430">После устранения всей страницы необходимо остановить и сохранить след.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-430">Once the entire page resolves, you should stop and save the trace.</span></span>

![Стандартный фильтр для DNS в Netmon — DNS.](../media/1bebc118-ca13-45f3-803f-ab73e7af401d.png)

<span data-ttu-id="e5bfb-432">Вы хотите посмотреть смещение времени здесь.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-432">You want to look at the time offset here.</span></span> <span data-ttu-id="e5bfb-433">Возможно, будет полезно добавить столбец **"Дельта** времени" в Netmon, который можно сделать, завершив следующие действия:</span><span class="sxs-lookup"><span data-stu-id="e5bfb-433">And it may be helpful to add the **Time Delta** column to Netmon which you can do by completing these steps:</span></span>

1. <span data-ttu-id="e5bfb-434">Щелкните правой кнопкой мыши столбец, например **Description**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-434">Right-click on a column such as **Description**.</span></span>
2. <span data-ttu-id="e5bfb-435">Щелкните **Выберите столбцы**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-435">Click **Choose Columns**.</span></span>
3. <span data-ttu-id="e5bfb-436">Найдите _дельту времени_ в списке и нажмите **кнопку Добавить**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-436">Locate _Time Delta_ in the list and click **Add**.</span></span>
4. <span data-ttu-id="e5bfb-437">Перемещение нового столбца на место до или за столбцом _Описание,_ чтобы вы могли читать их бок о бок.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-437">Move the new column into place before or behind the _Description_ column so you can read them side-by-side.</span></span>
5. <span data-ttu-id="e5bfb-438">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-438">Click **OK**.</span></span>

<span data-ttu-id="e5bfb-439">Если вы найдете интересующий запрос, рассмотрите возможность его изоляции, щелкнув его правой кнопкой мыши в панели сведений о кадре, выбрав **DNS Find Conversations** \> .</span><span class="sxs-lookup"><span data-stu-id="e5bfb-439">If you find a query of interest, consider isolating it by right-clicking that query in the frame details panel, choosing **Find Conversations** \> **DNS**.</span></span> <span data-ttu-id="e5bfb-440">Обратите внимание, что панель "Сетевые беседы" перескакинет прямо к определенному разговору в журнале трафика UDP.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-440">Notice that the Network Conversations panel jumps right to the specific conversation in its log of UDP traffic.</span></span>

![След Netmon от Outlook нагрузки в Интернете, фильтруемой DNS, и с помощью поиска бесед затем DNS сузить результаты.](../media/763cf20e-7b48-4a37-9449-c9978cfe118b.PNG)

<span data-ttu-id="e5bfb-442">В Wireshark можно сделать столбец для времени DNS.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-442">In Wireshark you can make a column for DNS time.</span></span> <span data-ttu-id="e5bfb-443">Возьмите ваш след (или откройте след) в Wireshark и `dns` фильтр, или, что более полезно,  `dns.time` .</span><span class="sxs-lookup"><span data-stu-id="e5bfb-443">Take your trace (or open a trace) in Wireshark and filter by `dns`, or, more helpfully,  `dns.time`.</span></span> <span data-ttu-id="e5bfb-444">Щелкните любой запрос DNS и на панели с подробными сведениями  `Domain Name System (response)` разойдитесь.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-444">Click on any DNS query, and, in the panel showing details, expand the  `Domain Name System (response)` details.</span></span> <span data-ttu-id="e5bfb-445">Вы увидите поле для времени (например, `[Time: 0.001111100 seconds]` .</span><span class="sxs-lookup"><span data-stu-id="e5bfb-445">You'll see a field for time (for example, `[Time: 0.001111100 seconds]`.</span></span> <span data-ttu-id="e5bfb-446">Щелкните правой кнопкой мыши в этот раз и выберите **Применить в качестве столбца**.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-446">Right-click this time and select **Apply as Column**.</span></span> <span data-ttu-id="e5bfb-447">Это даст вам **столбец Время** для более быстрой сортировки трассировки.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-447">This will give you a **Time** column for quicker sorting of your trace.</span></span> <span data-ttu-id="e5bfb-448">Щелкните новый столбец, чтобы отсортировать, убывая значения, чтобы узнать, какой вызов DNS занял больше всего времени для решения.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-448">Click on the new column to sort by descending values to see which DNS call took the longest to resolve.</span></span>

[<span data-ttu-id="e5bfb-449">Данные по SharePoint Online, отфильтрованные в Wireshark с помощью dns.time (нижний регистр), при этом значения времени из области сведений собраны в столбец и отсортированы по возрастанию.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-449">A browse of SharePoint Online filtered in Wireshark by (lowercase) dns.time, with the time from the details made into a column and sorted ascending.</span></span>](../media/1439dcc2-12ff-4ee2-9ef3-1484cf79c384.PNG)

<span data-ttu-id="e5bfb-450">Если вы хотите больше исследовать время разрешения DNS, попробуйте psPing в отношении порта DNS, используемого TCP (например,  `psping <IP address of DNS server>:53` ) .</span><span class="sxs-lookup"><span data-stu-id="e5bfb-450">If you would like to do more investigation of the DNS resolution time, try a PsPing against the DNS port used by TCP (for example,  `psping <IP address of DNS server>:53`) .</span></span> <span data-ttu-id="e5bfb-451">Вы все еще видите проблему производительности?</span><span class="sxs-lookup"><span data-stu-id="e5bfb-451">Do you still see a performance issue?</span></span> <span data-ttu-id="e5bfb-452">Если это так, то проблема, скорее всего, будет более широкой сетевой проблемой, чем проблема определенного приложения DNS, которое вы нажимаем для разрешения.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-452">If you do, then the problem is more likely to be a broader network issue than an issue of specific the DNS application you're hitting to do resolution.</span></span> <span data-ttu-id="e5bfb-453">Кроме того, стоит еще раз отметить, что в outlook.office365.com 1000 000 000 000 000 000 000 000 000 000 000 000 000 000 000 000 Outlook Online (например, outlook-namnorthwest.office365.com).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-453">It's also worth mentioning, again, that a ping to outlook.office365.com will tell you where DNS name resolution for Outlook Online is taking place (for example, outlook-namnorthwest.office365.com).</span></span>

<span data-ttu-id="e5bfb-454">Если проблема выглядит как конкретная DNS, может потребоваться связаться с ИТ-отделом, чтобы узнать о конфигурациях DNS и DNS Forwarders для дальнейшего изучения этой проблемы.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-454">If the issue looks to be DNS specific, it may be necessary to contact your IT department to look at DNS configurations and DNS Forwarders to further investigate this issue.</span></span>

### <a name="proxy-scalability"></a><span data-ttu-id="e5bfb-455">Прокси-масштабируемость</span><span class="sxs-lookup"><span data-stu-id="e5bfb-455">Proxy Scalability</span></span>

<span data-ttu-id="e5bfb-456">Службы, такие как Outlook Online, Office 365 предоставлять клиентам несколько долгосрочных подключений.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-456">Services like Outlook Online in Office 365 grant clients multiple long-term connections.</span></span> <span data-ttu-id="e5bfb-457">Поэтому каждый пользователь может использовать больше подключений, для которых требуется более длительный срок службы.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-457">Therefore, each user may use more connections that require a longer life.</span></span>

#### <a name="tools"></a><span data-ttu-id="e5bfb-458">Инструменты</span><span class="sxs-lookup"><span data-stu-id="e5bfb-458">Tools</span></span>

<span data-ttu-id="e5bfb-459">математика;</span><span class="sxs-lookup"><span data-stu-id="e5bfb-459">Math</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="e5bfb-460">Что нужно искать</span><span class="sxs-lookup"><span data-stu-id="e5bfb-460">What to look for</span></span>

<span data-ttu-id="e5bfb-461">Для этого не существует средства сетевого отслеживания или устранения неполадок.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-461">There is no network trace or troubleshooting tool specific to this.</span></span> <span data-ttu-id="e5bfb-462">Вместо этого он основан на расчетах пропускной способности с учетом ограничений и других переменных.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-462">Instead, it's based upon bandwidth calculations given limitations and other variables.</span></span>

### <a name="tcp-max-segment-size"></a><span data-ttu-id="e5bfb-463">TCP Max Segment Size</span><span class="sxs-lookup"><span data-stu-id="e5bfb-463">TCP Max Segment Size</span></span>

<span data-ttu-id="e5bfb-464">Найдено в syn - SYN/ACK.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-464">Found in the SYN - SYN/ACK.</span></span>  <span data-ttu-id="e5bfb-465">Убедитесь, что пакеты TCP настроены для хранения максимально возможного объема данных.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-465">Do this check in any performance network trace you've taken to ensure that TCP packets are configured to carry the maximum amount of data possible.</span></span>

<span data-ttu-id="e5bfb-466">Цель состоит в том, чтобы увидеть MSS в 1460 bytes для передачи данных.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-466">The goal is to see a MSS of 1460 bytes for transmission of data.</span></span> <span data-ttu-id="e5bfb-467">Если вы находитесь за прокси-сервером или используете NAT, не забудьте выполнить этот тест от клиента до прокси/egress/NAT, а также от прокси/egress/NAT до Office 365 для наилучших результатов!</span><span class="sxs-lookup"><span data-stu-id="e5bfb-467">If you're behind a proxy, or you are using a NAT, remember to run this test from client to proxy/egress/NAT, and from proxy/egress/NAT to Office 365 for best results!</span></span> <span data-ttu-id="e5bfb-468">Это разные сеансы TCP.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-468">These are different TCP sessions.</span></span>

#### <a name="tools"></a><span data-ttu-id="e5bfb-469">Инструменты</span><span class="sxs-lookup"><span data-stu-id="e5bfb-469">Tools</span></span>

<span data-ttu-id="e5bfb-470">Netmon</span><span class="sxs-lookup"><span data-stu-id="e5bfb-470">Netmon</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="e5bfb-471">Что нужно искать</span><span class="sxs-lookup"><span data-stu-id="e5bfb-471">What to look for</span></span>

<span data-ttu-id="e5bfb-472">TCP Max Segment Size (MSS) — это еще один параметр трех способов рукопожатия в сетевом следе, что означает, что вы найдете данные, необходимые в пакете SYN - SYN/ACK.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-472">TCP Max Segment Size (MSS) is another parameter of the three-way handshake in your network trace, that means you'll find the data you need in the SYN - SYN/ACK packet.</span></span> <span data-ttu-id="e5bfb-473">MSS на самом деле довольно прост в том, чтобы увидеть.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-473">MSS is actually pretty simple to see.</span></span>

<span data-ttu-id="e5bfb-474">Откройте любой сетевой след производительности и найдите интересующих вас подключений или это демонстрирует проблему производительности.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-474">Open any performance network trace you have and find the connection you're curious about, or that demonstrates the performance problem.</span></span>

> [!NOTE]
> <span data-ttu-id="e5bfb-475">Если вы ищете след и хотите найти трафик, соответствующий вашему разговору, фильтруйте IP-адрес клиента или IP-адрес прокси-сервера или точки отступа или оба.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-475">If you are looking at a trace and need to find the traffic relevant to your conversation, filter by the IP of the Client, or the IP of the proxy server or egress point, or both.</span></span> <span data-ttu-id="e5bfb-476">При непосредственном обращении необходимо перейти к URL-адресу, который вы тестируете для IP-Office 365 в следе, и отфильтровать его.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-476">Going directly, you will need to ping the URL that you're testing for the IP address of Office 365 in the trace, and filter by it.</span></span>

<span data-ttu-id="e5bfb-477">Глядя на след сегодной руки?</span><span class="sxs-lookup"><span data-stu-id="e5bfb-477">Looking at the trace second-hand?</span></span> <span data-ttu-id="e5bfb-478">Попробуйте с помощью фильтров ориентироваться.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-478">Try using filters to orient yourself.</span></span> <span data-ttu-id="e5bfb-479">В Netmon запустите поиск на основе URL-адреса, например, обратите внимание `Containsbin(framedata, ascii, "sphybridExample")` на номер кадра.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-479">In Netmon, run a search based on the URL, such as `Containsbin(framedata, ascii, "sphybridExample")`, take note of the frame number.</span></span>

<span data-ttu-id="e5bfb-480">В Wireshark используйте что-то вроде  `frame contains "sphybridExample"` .</span><span class="sxs-lookup"><span data-stu-id="e5bfb-480">In Wireshark use something like  `frame contains "sphybridExample"`.</span></span> <span data-ttu-id="e5bfb-481">Если вы заметили, что вы нашли удаленный трафик Winsock (RWS) (он может отображаться как [PSH, ACK] в Wireshark), помните, что подключения RWS можно увидеть незадолго до соответствующего СИН - SYN/ACKs, как говорилось ранее.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-481">If you notice that you've found Remote Winsock (RWS) traffic (it may appear as a [PSH, ACK] in Wireshark), remember that RWS connects can be seen shortly before relevant SYN - SYN/ACKs, as discussed earlier.</span></span>

<span data-ttu-id="e5bfb-482">На этом этапе вы можете записать номер кадра, отбросить фильтр, щелкнуть все трафик в окне Сетевые беседы в Netmon, чтобы посмотреть ближайший СИН. </span><span class="sxs-lookup"><span data-stu-id="e5bfb-482">At this point, you can record the frame number, drop the filter, click **All Traffic** in the Network Conversations window in Netmon to look at the nearest SYN.</span></span>

<span data-ttu-id="e5bfb-483">Важно отметить, что если на момент трассировки вы не получили ни одной из сведений об IP-адресе, поиск URL-адреса в следе (часть, например), позволит отфильтровать `sphybridExample-my.sharepoint.com` IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-483">Importantly, if you didn't receive any of the IP address information at the time of the trace, finding your URL in the trace (part of `sphybridExample-my.sharepoint.com`, for example), will give you IP addresses to filter by.</span></span>

<span data-ttu-id="e5bfb-484">Найдите подключение в следе, который вам интересен.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-484">Locate the connection in the trace that you're interested in seeing.</span></span> <span data-ttu-id="e5bfb-485">Это можно сделать путем сканирования трассировки, фильтрации по IP-адресам или выбора определенных ID-адресов разговоров с помощью окна Сетевые беседы в Netmon.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-485">You may do this by either scanning the trace, by filtering by IP addresses, or by selecting specific Conversation IDs using the Network Conversations window in Netmon.</span></span> <span data-ttu-id="e5bfb-486">После того, как вы нашли пакет SYN, раздвинйте TCP (в Netmon) или Протокол управления передачей (в Wireshark) в панели Сведения о кадре.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-486">Once you've found the SYN packet, expand TCP (in Netmon), or Transmission Control Protocol (in Wireshark) in the Frame Details panel.</span></span> <span data-ttu-id="e5bfb-487">Расширйте параметры TCP и MaxSegmentSize.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-487">Expand TCP Options and MaxSegmentSize.</span></span> <span data-ttu-id="e5bfb-488">Найдите соответствующий кадр SYN-ACK и расширйте параметры TCP и MaxSegmentSize.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-488">Locate the related SYN-ACK frame and Expand TCP Options and MaxSegmentSize.</span></span> <span data-ttu-id="e5bfb-489">Меньшее из этих двух значений будет ваш максимальный размер сегмента.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-489">The smaller of the two values will be your Maximum Segment Size.</span></span> <span data-ttu-id="e5bfb-490">На этом рисунке я использую встроенный столбец в Netmon под названием Устранение неполадок TCP.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-490">In this picture, I make use of the built-in Column in Netmon called TCP Troubleshoot.</span></span>

![Трассировка сети фильтруется в Netmon с помощью встроенных столбцов.](../media/e073df13-71f8-497a-83b4-bb9f70bd9833.PNG)

<span data-ttu-id="e5bfb-492">Встроенный столбец находится в верхней части панели **Frame Details.**</span><span class="sxs-lookup"><span data-stu-id="e5bfb-492">The built-in column is at the top of the **Frame Details** panel.</span></span> <span data-ttu-id="e5bfb-493">(Чтобы вернуться к обычному представлению, щелкните **Столбцы** снова и выберите **часовой пояс**.)</span><span class="sxs-lookup"><span data-stu-id="e5bfb-493">(To switch back to your normal view, click **Columns** again, and then choose **Time Zone**.)</span></span>

![Где найти раскрывающийся список "Columns" (Столбцы) в верхней части сводных данных о фрейме, чтобы выбрать пункт "TCP Troubleshoot" (Устранение неполадок TCP).](../media/64fd4baa-a872-4f07-b959-752d7d37fd62.PNG)

<span data-ttu-id="e5bfb-495">Вот фильтрованный след в Wireshark.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-495">Here's a filtered trace in Wireshark.</span></span> <span data-ttu-id="e5bfb-496">Существует фильтр, определенный значению MSS ( `tcp.options.mss` ).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-496">There is a filter specific to the MSS value ( `tcp.options.mss`).</span></span> <span data-ttu-id="e5bfb-497">Кадры рукопожатия SYN, SYN/ACK, ACK связаны в нижней части wireshark, эквивалентной Данным о кадре (так кадр 47 ACK, ссылки на 46 SYN/ACK, ссылки на 43 SYN), чтобы сделать этот вид работы проще.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-497">The frames of a SYN, SYN/ACK, ACK handshake are linked at the bottom of the Wireshark equivalent to Frame Details (so frame 47 ACK, links to 46 SYN/ACK, links to 43 SYN) to make this kind of work easier.</span></span>

![Трассировка, фильтруемая в Wireshark по tcp.options.mss для max Segment Size (MSS).](../media/51e278db-801b-48bc-9b68-87cf92f03fd6.PNG)

<span data-ttu-id="e5bfb-499">Если вам нужно проверить **селективное подтверждение** (следующая тема в этой матрице), не закрывай свой след!</span><span class="sxs-lookup"><span data-stu-id="e5bfb-499">If you need to check **Selective Acknowledgment** (next topic in this matrix), don't close your trace!</span></span>

### <a name="selective-acknowledgment"></a><span data-ttu-id="e5bfb-500">Выборочное подтверждение</span><span class="sxs-lookup"><span data-stu-id="e5bfb-500">Selective Acknowledgment</span></span>

<span data-ttu-id="e5bfb-501">Найдено в syn - SYN/ACK.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-501">Found in the SYN - SYN/ACK.</span></span> <span data-ttu-id="e5bfb-502">Должна быть отчитаться как разрешенная как в SYN, так и в SYN/ACK.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-502">Must be reported as Permitted in both SYN and SYN/ACK.</span></span> <span data-ttu-id="e5bfb-503">Селективное подтверждение (SACK) позволяет более плавную ретрансмиссию данных при пропаже пакета или пакетов.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-503">Selective Acknowledgment (SACK) allows for smoother retransmission of data when a packet or packets go missing.</span></span> <span data-ttu-id="e5bfb-504">Устройства могут отключить эту функцию, что может привести к проблемам с производительностью.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-504">Devices can disable this feature, which can lead to performance problems.</span></span>

<span data-ttu-id="e5bfb-505">Если вы находитесь за прокси-сервером или используете NAT, не забудьте выполнить этот тест от клиента до прокси/egress/NAT, а также от прокси/egress/NAT до Office 365 для наилучших результатов!</span><span class="sxs-lookup"><span data-stu-id="e5bfb-505">If you're behind a proxy, or you are using a NAT, remember to run this test from client to proxy/egress/NAT, and from proxy/egress/NAT to Office 365 for best results!</span></span> <span data-ttu-id="e5bfb-506">Это разные сеансы TCP.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-506">These are different TCP sessions.</span></span>

#### <a name="tools"></a><span data-ttu-id="e5bfb-507">Инструменты</span><span class="sxs-lookup"><span data-stu-id="e5bfb-507">Tools</span></span>

<span data-ttu-id="e5bfb-508">Netmon</span><span class="sxs-lookup"><span data-stu-id="e5bfb-508">Netmon</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="e5bfb-509">Что нужно искать</span><span class="sxs-lookup"><span data-stu-id="e5bfb-509">What to look for</span></span>

<span data-ttu-id="e5bfb-510">Селективное подтверждение (SACK) — это еще один параметр в рукопожатии SYN-SYN/ACK.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-510">Selective Acknowledgment (SACK) is another parameter in the SYN-SYN/ACK handshake.</span></span> <span data-ttu-id="e5bfb-511">Вы можете фильтровать трассировку для SYN - SYN/ACK многими способами.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-511">You can filter your trace for SYN - SYN/ACK many ways.</span></span>

<span data-ttu-id="e5bfb-512">Найдите подключение в следе, который вам интересно увидеть, сканируя след, фильтруя IP-адреса или щелкнув ID-адрес беседы с помощью окна Сетевые беседы в Netmon.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-512">Locate the connection in the trace that you're interested in seeing either by scanning the trace, filtering by IP addresses, or by clicking a Conversation ID using the Network Conversations window in Netmon.</span></span> <span data-ttu-id="e5bfb-513">После того как вы нашли пакет SYN, развиньте TCP в Netmon или Протокол управления передачей в Wireshark в разделе Сведения о кадре.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-513">Once you've found the SYN packet, expand TCP in Netmon, or Transmission Control Protocol in Wireshark in the Frame Details section.</span></span> <span data-ttu-id="e5bfb-514">Расширйте параметры TCP и затем SACK.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-514">Expand TCP Options and then SACK.</span></span> <span data-ttu-id="e5bfb-515">Найдите соответствующий кадр SYN-ACK и расширйте параметры TCP и его поле SACK.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-515">Locate the related SYN-ACK frame and Expand TCP Options and its SACK field.</span></span> <span data-ttu-id="e5bfb-516">Убедитесь, что определенный SACK разрешен как в SYN, так и в SYN/ACK.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-516">Make certain SACK is permitted in both SYN and SYN/ACK.</span></span> <span data-ttu-id="e5bfb-517">Вот значения SACK, как в Netmon и Wireshark.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-517">Here are SACK values as seen in both Netmon and Wireshark.</span></span>

![Селективное подтверждение (SACK) в Netmon в результате tcp.flags.syn == 1.](../media/216f556f-5031-4ed2-b066-a0d9b3251fa2.PNG)

![SACK в Wireshark с фильтром tcp.flags.syn == 1.](../media/0a6e26e5-43dc-403b-adc9-3349a55f4e4b.PNG)

### <a name="dns-geolocation"></a><span data-ttu-id="e5bfb-520">Геолокация DNS</span><span class="sxs-lookup"><span data-stu-id="e5bfb-520">DNS Geolocation</span></span>

<span data-ttu-id="e5bfb-521">Если в мире Office 365 устранять эффекты вызова DNS, скорость подключения.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-521">Where in the world Office 365 tries to resolve your DNS call effects your connection speed.</span></span>

<span data-ttu-id="e5bfb-522">В Outlook Online, после завершения первого DNS-анализа, расположение этого DNS будет использоваться для подключения к ближайшему центру обработки данных.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-522">In Outlook Online, after the first DNS lookup is completed, the location of that DNS will be used to connect to your nearest datacenter.</span></span> <span data-ttu-id="e5bfb-523">Вы будете подключены к серверу Outlook cas, который будет использовать магистрали сети для подключения к центру обработки данных (DC), где хранятся ваши данные.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-523">You will be connected to an Outlook Online CAS server, which will use the backbone network to connect to the datacenter (dC) where your data is stored.</span></span> <span data-ttu-id="e5bfb-524">Это быстрее.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-524">This is faster.</span></span>

<span data-ttu-id="e5bfb-525">При доступе SharePoint Online пользователь, путешествующий за границей, будет направлен в активный центр обработки данных — это центр DC, расположение которого основано на домашней базе клиента SPO (так, dC в США, если пользователь, если он основан на США).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-525">When accessing SharePoint Online, a user traveling abroad will be directed to their active datacenter -- that's the dC whose location is based on their SPO tenant's home-base (so, a dC in the USA if the user if USA-based).</span></span>

<span data-ttu-id="e5bfb-526">Lync Online имеет активные узлы в более чем одном dC одновременно.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-526">Lync online has active nodes in more than one dC at a time.</span></span> <span data-ttu-id="e5bfb-527">Когда запросы отправляются для онлайн-экземпляров Lync, DNS Корпорации Майкрософт определяет, откуда в мире поступил запрос, и возвращает IP-адреса из ближайшего регионального DC, где активен Lync online.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-527">When requests are sent for Lync online instances, Microsoft's DNS will determine where in the world the request came from, and return IP addresses from the nearest regional dC where Lync online is active.</span></span>

> [!TIP]
> <span data-ttu-id="e5bfb-528">Необходимо узнать больше о том, как клиенты подключаются к Office 365?</span><span class="sxs-lookup"><span data-stu-id="e5bfb-528">Need to know more about how clients connect to Office 365?</span></span> <span data-ttu-id="e5bfb-529">Взгляните на справочную [статью "Подключение](/previous-versions//dn741250(v=technet.10)) клиентов" (и ее полезную графику).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-529">Take a look at the [Client Connectivity](/previous-versions//dn741250(v=technet.10)) reference article (and its helpful graphics).</span></span>

#### <a name="tools"></a><span data-ttu-id="e5bfb-530">Инструменты</span><span class="sxs-lookup"><span data-stu-id="e5bfb-530">Tools</span></span>

- <span data-ttu-id="e5bfb-531">Ping</span><span class="sxs-lookup"><span data-stu-id="e5bfb-531">Ping</span></span>
- <span data-ttu-id="e5bfb-532">PsPing</span><span class="sxs-lookup"><span data-stu-id="e5bfb-532">PsPing</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="e5bfb-533">Что нужно искать</span><span class="sxs-lookup"><span data-stu-id="e5bfb-533">What to look for</span></span>

<span data-ttu-id="e5bfb-534">Запросы на разрешение имен с DNS-серверов клиента на DNS-серверы Майкрософт в большинстве случаев должны привести к возвращению Microsoft DNS IP-адреса регионального центра обработки данных (dC).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-534">Requests for name resolution from the client's DNS servers to Microsoft's DNS servers should in most cases result in Microsoft DNS returning the IP address of a regional datacenter (dC).</span></span> <span data-ttu-id="e5bfb-535">Что это значит для вас?</span><span class="sxs-lookup"><span data-stu-id="e5bfb-535">What does this mean for you?</span></span> <span data-ttu-id="e5bfb-536">Если ваша штаб-квартира находится в Бангалоре, Индия, но вы путешествуете по США, когда браузер запрашивает Outlook Online, DNS-серверы Майкрософт должны передать IP-адреса центрам обработки данных в США — региональному центру обработки данных.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-536">If your headquarters are in Bangalore, India, but you are traveling in the United States, when your browser makes a request for Outlook Online, Microsoft's DNS servers should hand you IP addresses to datacenters in the United States -- a regional datacenter.</span></span> <span data-ttu-id="e5bfb-537">Если почта требуется из Outlook, эти данные будут пересекать быструю магистралную сеть Майкрософт между центрами обработки данных.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-537">If mail is needed from Outlook, that data will travel across Microsoft's quick backbone network between the datacenters.</span></span>

<span data-ttu-id="e5bfb-538">DNS работает быстрее, когда разрешение имен делается максимально близко к расположению пользователя.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-538">DNS works fastest when name resolution is done as close to the user location as possible.</span></span> <span data-ttu-id="e5bfb-539">Если вы в Европе, вы хотите перейти в microsoft DNS в Европе и (в идеале) иметь дело с центром обработки данных в Европе.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-539">If you're in Europe, you want to go to a Microsoft DNS in Europe, and (ideally) deal with a datacenter in Europe.</span></span> <span data-ttu-id="e5bfb-540">Производительность от клиента в Европе до DNS и центра обработки данных в Америке будет медленнее.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-540">Performance from a client in Europe going to DNS and a datacenter in America will be slower.</span></span>

<span data-ttu-id="e5bfb-541">Запустите средство Ping outlook.office365.com, чтобы определить, куда в мире будет маршрутить запрос DNS.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-541">Run the Ping tool against outlook.office365.com to determine where in the world your DNS request is being routed.</span></span> <span data-ttu-id="e5bfb-542">Если вы находитесь в Европе, вы должны увидеть ответ от чего-то подобного outlook-emeawest.office365.com.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-542">If you are in Europe, you should see a reply from something like outlook-emeawest.office365.com.</span></span> <span data-ttu-id="e5bfb-543">В Северной и Южной Америке ожидайте чего-то подобного outlook-namnorthwest.office365.com.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-543">In the Americas, expect something like outlook-namnorthwest.office365.com.</span></span>

<span data-ttu-id="e5bfb-544">Откройте командную подсказку на клиентном компьютере (с помощью командного или Windows типа \> \> \> клавиши).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-544">Open the command prompt on the client computer (via Start \> Run \> cmd or Windows key \> type cmd).</span></span> <span data-ttu-id="e5bfb-545">Введите outlook.office365.com и нажмите кнопку ENTER.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-545">Type ping outlook.office365.com and press ENTER.</span></span> <span data-ttu-id="e5bfb-546">Помните, чтобы указать -4, если вы хотите указать для ping через IPv4.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-546">Remember, to specify -4 if you want to specify to ping via IPv4.</span></span> <span data-ttu-id="e5bfb-547">Возможно, вам не удастся получить ответ из пакетов ICMP, но вы должны увидеть имя DNS, на который был направит запрос.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-547">You may fail to get a reply from the ICMP packets, but you should see the name of the DNS to which the request was routed.</span></span> <span data-ttu-id="e5bfb-548">Если вы хотите увидеть номера задержки для этого подключения, попробуйте psPing на IP-адрес сервера, возвращаемого путем пинга.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-548">If you want to see the latency numbers for this connection try PsPing to the IP address of the server that is returned by ping.</span></span>

![Результаты выполнения команды ping для проверки связи с outlook.office365.com, показывающие разрешение в outlook-namnorthwest.](../media/06c944d5-6159-43ec-aa31-757770695e8b.PNG)

![PsPing to the IP address returned by the ping to outlook.office365.com showing average 28 millisecond latency.](../media/f2b25a75-1a87-4479-b8a7-fa4375683507.PNG)

### <a name="office-365-application-troubleshooting"></a><span data-ttu-id="e5bfb-551">Office 365 Устранение неполадок приложения</span><span class="sxs-lookup"><span data-stu-id="e5bfb-551">Office 365 Application Troubleshooting</span></span>

#### <a name="tools"></a><span data-ttu-id="e5bfb-552">Инструменты</span><span class="sxs-lookup"><span data-stu-id="e5bfb-552">Tools</span></span>

- <span data-ttu-id="e5bfb-553">Netmon</span><span class="sxs-lookup"><span data-stu-id="e5bfb-553">Netmon</span></span>
- <span data-ttu-id="e5bfb-554">HTTPWatch</span><span class="sxs-lookup"><span data-stu-id="e5bfb-554">HTTPWatch</span></span>
- <span data-ttu-id="e5bfb-555">Консоль F12 в браузере</span><span class="sxs-lookup"><span data-stu-id="e5bfb-555">F12 Console in the browser</span></span>

<span data-ttu-id="e5bfb-556">В этой сетевой статье мы не используем средства, используемые в устранении неполадок, определенных для приложений.</span><span class="sxs-lookup"><span data-stu-id="e5bfb-556">We don't cover tools used in application-specific troubleshooting in this network-specific article.</span></span> <span data-ttu-id="e5bfb-557">Но вы найдете ресурсы, которые  *можно использовать* [на этой странице](https://support.office.com/article/Network-planning-and-performance-tuning-for-Office-365-e5f1228c-da3c-4654-bf16-d163daee8848).</span><span class="sxs-lookup"><span data-stu-id="e5bfb-557">But you'll find resources you  *can*  use [on this page](https://support.office.com/article/Network-planning-and-performance-tuning-for-Office-365-e5f1228c-da3c-4654-bf16-d163daee8848).</span></span>

## <a name="related-topics"></a><span data-ttu-id="e5bfb-558">Статьи по теме</span><span class="sxs-lookup"><span data-stu-id="e5bfb-558">Related Topics</span></span>

[<span data-ttu-id="e5bfb-559">Управление конечными точками Office 365</span><span class="sxs-lookup"><span data-stu-id="e5bfb-559">Managing Office 365 endpoints</span></span>](https://support.office.com/article/99cab9d4-ef59-4207-9f2b-3728eb46bf9a)

[<span data-ttu-id="e5bfb-560">Вопросы и ответы о конечных точках Office 365</span><span class="sxs-lookup"><span data-stu-id="e5bfb-560">Office 365 endpoints FAQ</span></span>](https://support.office.com/article/d4088321-1c89-4b96-9c99-54c75cae2e6d)