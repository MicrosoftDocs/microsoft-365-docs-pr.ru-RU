---
title: Настройка соединителя для импорта данных о персонале
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
audience: Admin
ms.topic: how-to
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection: M365-security-compliance
description: Администраторы могут настроить соединители данных для импорта данных сотрудников из системы кадровых ресурсов (HR) организации в Microsoft 365. Это позволяет использовать hr-данные в политиках управления рисками, чтобы помочь вам обнаруживать действия определенных пользователей, которые могут представлять внутреннюю угрозу для вашей организации.
ms.openlocfilehash: eb11eb5790ca9c585db8bbb95b41747a72e5c8f1
ms.sourcegitcommit: 27b2b2e5c41934b918cac2c171556c45e36661bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "50911379"
---
# <a name="set-up-a-connector-to-import-hr-data"></a>Настройка соединителя для импорта данных о персонале

Вы можете настроить соединители данных в центре соответствия требованиям Microsoft 365 для импорта данных кадровых ресурсов (HR), связанных с такими событиями, как отставку пользователя или изменение уровня работы пользователя. Затем данные по персоналу [](insider-risk-management.md) можно использовать с помощью решения по управлению рисками для создания индикаторов риска, которые помогут вам личных данных, связанных с возможной вредоносной деятельностью или кражей данных пользователями в организации.

Настройка соединители для кадровой информации, которую политики управления рисками могут использовать для создания индикаторов риска, состоит из создания CSV-файла, который содержит данные hr, создание приложения в Azure Active Directory, используемого для проверки подлинности, создание соединителя данных по персоналу в центре соответствия требованиям Microsoft 365, а затем запуск скрипта (на плановой основе), который передает данные hr в CSV-файлах в облако Microsoft, чтобы оно было доступно инсайдеру. решение по управлению рисками.

## <a name="before-you-begin"></a>Подготовка

- Определите, какие hr-сценарии и данные необходимо импортировать в Microsoft 365. Это поможет определить количество CSV-файлов и соединителов кадров, которые необходимо создать, а также способ создания и структуры CSV-файлов. Импортируемые данные по персоналу определяются политиками управления рисками, которые необходимо реализовать. Дополнительные сведения см. в шаге 1.

- Определите, как извлекать или экспортировать данные из hr-системы организации (и регулярно) и добавлять их в файлы CSV, которые создаются в шаге 1. Сценарий, который вы запустите в шаге 4, будет загружать данные hr в CSV-файлах в облако Майкрософт.

- Пользователю, создававшего соединитель кадров в шаге 3, необходимо уступить роль экспорта импорта почтовых ящиков в Exchange Online. По умолчанию эта роль не назначена ни одной группе ролей в Exchange Online. Вы можете добавить роль экспорта импорта почтовых ящиков в группу ролей управления организацией в Exchange Online. Или можно создать новую группу ролей, назначить роль экспортировать импорт почтовых ящиков, а затем добавить соответствующих пользователей в качестве участников. Дополнительные сведения см. в разделах Создание групп [ролей](/Exchange/permissions-exo/role-groups#create-role-groups) или [изменение](/Exchange/permissions-exo/role-groups#modify-role-groups) групп ролей в статье "Управление группами ролей в Exchange Online".

- Пример сценария, который вы запустите в шаге 4, загрузит hr-данные в облако Майкрософт, чтобы использовать его с помощью решения по управлению рисками. Этот пример сценария не поддерживается ни в одной стандартной программе поддержки Майкрософт или службе. Пример сценария приводится в виде "как есть", без каких-либо гарантий. Кроме того, корпорация Microsoft отказывается от всех подразумеваемых гарантий, включая в том числе все подразумеваемые гарантии пригодности для продажи или определенной цели. Все риски, возникающие в результате использования примера сценария и документации, берет на себя пользователь. Корпорация Майкрософт, ее штатные авторы и другие лица, принимающие участие в создании, подготовке и выпуске сценариев, ни при каких обстоятельствах не несут ответственность за какой-либо ущерб (в том числе, ущерб, вызванный потерей доходов предприятия, остановкой его работы, потерей бизнес-данных и другими материальными потерями), вызванный использованием или неспособностью использовать примеры сценариев и документацию, даже если корпорации Майкрософт известно о возможности нанесения такого ущерба.

## <a name="step-1-prepare-a-csv-file-with-your-hr-data"></a>Шаг 1. Подготовка CSV-файла с данными отдела кадров

На первом этапе необходимо создать CSV-файл, содержащий hr-данные, которые соединитатель импортирует в Microsoft 365. Эти данные будут использоваться решением по инсайдерской опасности для создания потенциальных индикаторов риска. Данные для следующих сценариев управления персоналом можно импортировать в Microsoft 365:

- Отставка сотрудника. Сведения о пользователях, которые покинули организацию.

- Изменения уровня задания. Сведения об изменениях уровня работы для пользователей, таких как акции и понижение.

- Обзоры производительности. Сведения о производительности пользователя.

- Планы повышения производительности. Сведения о планах повышения производительности для пользователей.

Тип импортируемых кадров зависит от политики управления рисками и соответствующего шаблона политики, которую необходимо реализовать. В следующей таблице показано, какой тип данных кадров необходим для каждого шаблона политики:

|  Шаблон политики |  Тип данных по персоналу |
|:-----------------------------------------------|:---------------------------------------------------------------------|
| Кража данных от отбывляющих пользователей                   | Отставки сотрудников                                                 |
| Общие утечки данных                              | Неприменимо                                                        |
| Утечки данных приоритетными пользователями                    | Неприменимо                                                        |
| Утечка данных недовольными пользователями                 | Изменения уровня работы, обзоры производительности, планы улучшения производительности |
| Общие нарушения политики безопасности              | Неприменимо                                                        |
| Нарушения политики безопасности при отбытии пользователей   | Отставки сотрудников                                                 |
| Нарушения политики безопасности приоритетными пользователями    | Неприменимо                                                        |
| Нарушения политики безопасности недовольными пользователями | Изменения уровня работы, обзоры производительности, планы улучшения производительности |
| Оскорбительный язык в электронной почте                     | Неприменимо                                                        |

Дополнительные сведения о шаблонах политики для управления рисками изнутри см. в дополнительных сведениях о политиках управления рисками [insider.](insider-risk-management-policies.md#policy-templates)

Для каждого сценария управления персоналом необходимо предоставить соответствующие данные по персоналу в одном или более CSV-файлах. Количество CSV-файлов, которые можно использовать для реализации управления рисками изнутри, будет рассмотрено в этом разделе.

После создания CSV-файла с требуемой hr-данными храните его на локальном компьютере, на который вы запустите сценарий в шаге 4. Кроме того, необходимо реализовать стратегию обновления, чтобы убедиться, что файл CSV всегда содержит самую текущую информацию, чтобы независимо от запуска скрипта наиболее актуальные данные hr были загружены в облако Майкрософт и доступны для решения по управлению рисками.

> [!IMPORTANT]
> Имена столбцов, описанные в следующих разделах, не являются требуемой параметрами, а только примерами. В CSV-файлах можно использовать любое имя столбца. Однако имена столбцов, которые вы  используете в CSV-файле, должны быть соединяться с типом данных при создании соединитетеля кадров в шаге 3. Также обратите внимание, что примеры CSV-файлов в следующих разделах показываются в представлении NotePad. Гораздо проще просматривать и изменять CSV-файлы в Microsoft Excel.

В последующих разделах описываются необходимые CSV-данные для каждого сценария управления персоналом.

### <a name="csv-file-for-employee-resignation-data"></a>CSV-файл для данных об отставке сотрудников

Вот пример CSV-файла для данных об увольнении сотрудников.

```text
EmailAddress,ResignationDate,LastWorkingDate
sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,2019-04-29T15:18:02.4675041+05:30
pilarp@contoso.com,2019-04-24T09:15:49Z,2019-04-29T15:18:02.7117540
```

В следующей таблице описывается каждый столбец в CSV-файле для данных об увольнении сотрудников.

|  Столбец   |   Описание |
|:------------|:----------------|
|**EmailAddress**| Указывает адрес электронной почты (UPN) прекращенного пользователя.|
| **ResignationDate** | Указывает дату официального прекращения работы пользователя в организации. Например, это может быть дата, когда пользователь дал уведомление о выходе из организации. Эта дата может быть иной, чем дата последнего дня работы. Используйте следующий формат даты: , который `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm` [является форматом даты и времени ISO 8601.](https://www.iso.org/iso-8601-date-and-time-format.html)|
| **LastWorkingDate** | Указывает последний день работы для завершившейся работы пользователя. Используйте следующий формат даты: , который `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm` [является форматом даты и времени ISO 8601.](https://www.iso.org/iso-8601-date-and-time-format.html)|
|||

### <a name="csv-file-for-job-level-changes-data"></a>CSV-файл для изменения данных уровня работы

Вот пример CSV-файла для данных об изменениях уровня работы.

```text
EmailAddress,EffectiveDate,OldLevel,NewLevel
sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,Level 61 – Sr. Manager,Level 60- Manager
pillar@contoso.com,2019-04-23T15:18:02.4675041+05:30,Level 62 – Director,Level 60- Sr. Manager
```

В следующей таблице описывается каждый столбец в CSV-файле для данных об изменениях уровня работы.

|  Столбец | Описание |
|:--------- |:------------- |
| **EmailAddress**  | Указывает адрес электронной почты пользователя (UPN).|
| **EffectiveDate** | Указывает дату официального изменения уровня работы пользователя. Используйте следующий формат даты: , который `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm` [является форматом даты и времени ISO 8601.](https://www.iso.org/iso-8601-date-and-time-format.html)|
| **Замечания**| Указывает замечания, предоставленные оценщиком об изменении уровня работы. Можно ввести ограничение в 200 символов. Этот параметр необязательный. Не нужно включать его в CSV-файл.|
| **OldLevel**| Указывает уровень работы пользователя перед его сменой. Это параметр со свободным текстом, который может содержать иерархическую таксономию для вашей организации. Этот параметр необязательный. Не нужно включать его в CSV-файл.|
| **NewLevel**| Указывает уровень работы пользователя после его изменения. Это параметр со свободным текстом, который может содержать иерархическую таксономию для вашей организации. Этот параметр необязательный. Не нужно включать его в CSV-файл.|
|||

### <a name="csv-file-for-performance-review-data"></a>CSV-файл для данных проверки производительности

Вот пример CSV-файла для данных о производительности.

```text
EmailAddress,EffectiveDate,Remarks,Rating
sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,Met expectations but bad attitude,2-Below expectation
pillar@contoso.com,2019-04-23T15:18:02.4675041+05:30, Multiple conflicts with the team
```

В следующей таблице описывается каждый столбец в CSV-файле для данных проверки производительности.

|  Столбец | Описание |
|:----------|:--------------|
| **EmailAddress**  | Указывает адрес электронной почты пользователя (UPN).|
| **EffectiveDate** | Указывает дату, когда пользователь был официально проинформирован о результатах проверки производительности. Это может быть дата окончания цикла проверки производительности. Используйте следующий формат даты: , который `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm` [является форматом даты и времени ISO 8601.](https://www.iso.org/iso-8601-date-and-time-format.html)|
| **Замечания**| Указывает все замечания, которые оценщик предоставил пользователю для проверки производительности. Это текстовый параметр с ограничением в 200 символов. Этот параметр необязательный. Не нужно включать его в CSV-файл.|
| **Оценка**| Указывает рейтинг, предоставленный для проверки производительности. Это текстовый параметр, который может содержать любой текст в свободной форме, который используется организацией для распознавания оценки. Например, "3 met expectations" или "2 Ниже среднего". Это текстовый параметр с ограничением в 25 символов. Этот параметр необязательный. Не нужно включать его в CSV-файл.|
|||

### <a name="csv-file-for-performance-improvement-plan-data"></a>CSV-файл для данных плана повышения производительности

Вот пример CSV-файла для данных для данных плана повышения производительности.

```text
EmailAddress,EffectiveDate,ImprovementRemarks,PerformanceRating
sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,Met expectation but bad attitude,2-Below expectation
pillar@contoso.com,2019-04-23T15:18:02.4675041+05:30, Multiple conflicts with the team
```

В следующей таблице описывается каждый столбец в CSV-файле для данных проверки производительности.

|  Столбец |  Описание |
|:----------|:---------------|
| **EmailAddress**  | Указывает адрес электронной почты пользователя (UPN).|
| **EffectiveDate** | Указывает дату, когда пользователь был официально проинформирован о плане повышения производительности. Необходимо использовать следующий формат даты: , который является `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm` [форматом даты и времени ISO 8601.](https://www.iso.org/iso-8601-date-and-time-format.html)|
| **Замечания**| Указывает все замечания, предоставленные оценщиком в плане улучшения производительности. Это текстовый параметр с ограничением в 200 символов. Это необязательный параметр. Не нужно включать его в CSV-файл. |
| **Оценка**| Указывает любую оценку или другую информацию, связанную с проверкой производительности. план улучшения производительности. Это текстовый параметр, который может содержать любой свободный текст формы, который ваша организация использует для распознавания оценки. Например, "3 met expectations" или "2 Ниже среднего". Это текстовый параметр с ограничением в 25 символов. Это необязательный параметр. Не нужно включать его в CSV-файл.|
|||

### <a name="determining-how-many-csv-files-to-use-for-hr-data"></a>Определение того, сколько CSV-файлов используется для hr-данных

На шаге 3 можно создать отдельные соединители для каждого типа данных hr или создать единый соединитатель для всех типов данных. Можно использовать отдельные CSV-файлы, содержащие данные для одного сценария управления персоналом (например, примеры CSV-файлов, описанных в предыдущих разделах). Кроме того, можно использовать один CSV-файл, содержащий данные для двух или более сценариев управления персоналом. Ниже указаны некоторые рекомендации, которые помогут определить количество CSV-файлов, которые необходимо использовать для данных hr.

- Если внутренняя политика управления рисками, которую необходимо реализовать, требует нескольких типов данных hr, рассмотрите возможность использования одного CSV-файла, который содержит все необходимые типы данных.

- Метод создания или сбора кадровой информации может определять количество CSV-файлов. Например, если различные типы hr-данных, используемых для настройки hr-соединиттеля, находятся в одной системе управления персоналом в вашей организации, вы можете экспортировать данные в один файл CSV. Но если данные распространяются в различных системах управления персоналом, может быть проще экспортировать данные в различные CSV-файлы. Например, данные об увольнении сотрудников могут располагаться в другой системе управления персоналом, чем данные о уровне работы или производительности. В этом случае может быть проще иметь отдельные CSV-файлы, чем вручную объединять данные в один CSV-файл. Таким образом, то, как вы извлекаете или экспортируете данные из hr-систем, может определить количество CSV-файлов, которые вам необходимы.

- Как правило, количество соединителенов кадров, которые необходимо создать, определяется типами данных в CSV-файле. Например, если CSV-файл содержит все типы данных, необходимые для поддержки реализации управления рисками изнутри, то вам потребуется только один соединитатель кадров. Но если у вас есть два отдельных CSV-файла, каждый из которых содержит один тип данных, вам придется создать два соединители кадров. Исключением является то, что при добавлении столбца **HRScenario** в CSV-файл (см. следующий раздел), можно настроить один соединителю кадров, который может обрабатывать различные CSV-файлы.

### <a name="configuring-a-single-csv-file-for-multiple-hr-data-types"></a>Настройка одного CSV-файла для нескольких типов данных hr

Можно добавить несколько типов данных hr в один CSV-файл. Это полезно, если реализуемая вами внутренняя система управления рисками требует нескольких типов данных hr или типов данных, расположенных в одной системе управления персоналом в организации. Меньшее количество CSV-файлов всегда позволяет создавать и управлять меньшее количество соединителов кадров.

Вот требования к настройке CSV-файла с несколькими типами данных:

- Для каждого типа данных и соответствующего имени столбца в строке заглавной строки необходимо добавить необходимые столбцы (и необязательно, если они используются). Если тип данных не соответствует столбцу, можно оставить значение пустым.

- Чтобы использовать CSV-файл с несколькими типами hr-данных, соединителя кадров необходимо знать, какие строки в CSV-файле содержат данные hr типа. Это достигается путем добавления дополнительного **столбца HRScenario** в CSV-файл. Значения в этом столбце определяют тип hr-данных в каждой строке. Например, значения, соответствующие четырем сценариям управления персоналом, могут быть "Отставка", "Изменение уровня работы", "Проверка производительности" и "План \` \` улучшения \` \` \` \` \` производительности". \`

- Если у вас есть несколько CSV-файлов, содержащих столбец HRScenario**, убедитесь, что каждый файл использует одно и то же имя столбца и те же значения, которые определяют конкретные сценарии управления персоналом.

В следующем примере показан CSV-файл, содержащий **столбец HRScenario.** Значения в столбце HRScenario определяют тип данных в соответствующей строке.

```text
HRScenario,EmailAddress,ResignationDate,LastWorkingDate,EffectiveDate,Remarks,Rating,OldLevel,NewLevel
Resignation,sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,2019-04-29T15:18:02.4675041+05:30,,,,
Resignation,pilarp@contoso.com,2019-04-24T09:15:49Z,2019-04-29T15:18:02.7117540,,,,
Job level change,sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,,,,,Level 61 Sr. Manager, Level 60 Manager
Job level change,pillarp@contoso.com,2019-04-23T15:18:02.4675041+05:30,,,,,Level 62 Director,Level 60 Sr Manager
Performance review,sarad@contoso.com,,,2019-04-23T15:18:02.4675041+05:30,Met expectation but bad attitude,2 Below expectations,,
Performance review,pillarp@contoso.com,,,2019-04-23T15:18:02.4675041+05:30, Multiple conflicts with the team,,
Performance improvement plan,sarad@contoso.com,,,2019-04-23T15:18:02.4675041+05:30,Met expectations but bad attitude,2 Below expectations,,
Performance improvement plan,pillarp@contoso.com,,,2019-04-23T15:18:02.4675041+05:30,Multiple conflicts with the team,,
```

> [!NOTE]
> Вы можете использовать любое имя для столбца, определяемого типом данных hr, так как имя столбца в CSV-файле будет соединяться с столбцом, который определяет тип данных hr при настройках соединиттеля в шаге 3. Кроме того, при настройках соединиттеля будут соединяться значения, используемые для столбца типа данных.

### <a name="adding-the-hrscenario-column-to-a-csv-file-that-contains-a-single-data-type"></a>Добавление столбца HRScenario в CSV-файл, содержащий один тип данных

На основе кадровой системы организации и способов экспорта данных hr в CSV-файл может потребоваться создать несколько CSV-файлов, содержащих один тип данных hr. В этом случае можно создать единый соединителя кадров для импорта данных из различных CSV-файлов. Для этого достаточно добавить столбец HRScenario в CSV-файл и указать тип данных hr. Затем можно запустить сценарий для каждого CSV-файла, но использовать один и тот же ИД задания для соединитетеля. См. [шаг 4](#step-4-run-the-sample-script-to-upload-your-hr-data).

## <a name="step-2-create-an-app-in-azure-active-directory"></a>Шаг 2. Создание приложения в Azure Active Directory

Следующий шаг — создание и регистрация нового приложения в Azure Active Directory (Azure AD). Приложение будет соответствовать разъему HR, который вы создаете в шаге 3. Создание этого приложения позволит Azure AD проверить подлинность hr-соединиттеля при запуске и попытках получить доступ к организации. Это приложение также будет использоваться для проверки подлинности скрипта, который вы запустите в шаге 4, чтобы загрузить свои hr-данные в облако Майкрософт. При создании этого приложения Azure AD обязательно сохраните следующую информацию. Эти значения будут использоваться в шаге 3 и шаге 4.

- ID приложения Azure AD (также называемый *ИД приложения* или *клиентский id)*

- Секрет приложения Azure AD (также называемый секрет *клиента)*

- Tenant Id (также называемый *ИД каталога)*

Пошаговая инструкция по созданию приложения в Azure AD см. в примере Регистрация приложения с [платформой удостоверений Майкрософт.](/azure/active-directory/develop/quickstart-register-app)

## <a name="step-3-create-the-hr-connector"></a>Шаг 3. Создание соединитетеля кадров

Следующий шаг — создание соединитетеля кадров в центре соответствия требованиям Microsoft 365. После запуска скрипта в шаге 4, создавающийся соединитатель кадров будет гнать данные hr из CSV-файла в организацию Microsoft 365. Перед созданием соединитетеля убедитесь, что у вас есть список сценариев hr и соответствующие имена столбцов CSV для каждого из них. При настройке соединиттеля необходимо соединять данные, необходимые для каждого сценария, с фактическими именами столбцов в CSV-файле. Кроме того, можно загрузить пример CSV-файла при настройке соединителю, и мастер поможет вам составить карту имени столбцов с требуемых типов данных.

После завершения этого шага обязательно скопируйте ID задания, созданный при создании соединитетеля. При запуске скрипта используется ИД задания.

1. Перейдите [https://compliance.microsoft.com](https://compliance.microsoft.com/) к и нажмите **соединители данных** в левом nav.

2. На странице **Соединители данных** в **отделе кадров** нажмите **кнопку Просмотр**.

3. На **пользовательской странице HR** нажмите **кнопку Добавить соединителю**.

4. На странице **Настройка подключения сделайте** следующее, а затем нажмите **кнопку Далее:**

   1. Введите или введите ID приложения Azure AD для приложения Azure, созданного в шаге 2.

   1. Введите имя для hr-соединиттеля.

5. На странице сценарии hr выберите один или несколько сценариев, для импортируемых данных, а затем нажмите **кнопку Далее**.

6. На странице метода сопоставления файлов выберите один из следующих параметров и нажмите **кнопку Далее**.

   - **Загрузите пример файла**. Если вы выбрали этот параметр, щелкните **Загрузите** пример файла, чтобы загрузить CSV-файл, который вы подготовили в шаге 1. Этот параметр позволяет быстро выбрать имена столбцов в CSV-файле из выпадаемого списка, чтобы сооставить их с типами данных для выбранных ранее сценариев управления персоналом.

   ИЛИ

   - **Вручную предоставить сведения о сопоставлении.** При выборе этого параметра необходимо ввести имя столбцов в CSV-файле, чтобы сооставить их с типами данных для выбранных ранее сценариев управления персоналом.

7. На странице Сведения о сопоставлении файлов сделайте один из следующих, в зависимости от того, загрузили ли вы пример CSV-файла и настраиваете ли соединитектор для одного hr-сценария или для нескольких сценариев. Если вы загрузили пример файла, не нужно введите имена столбцов. Вы выбираете их из списка выпаданий.

    - Если на предыдущем шаге был выбран один сценарий управления персоналом, введите имена загонщика столбцов (также называемые параметрами) из CSV-файла, созданного в шаге 1 в каждом из соответствующих полей. Имена столбцов, которые вы введите, не являются чувствительными к делу, но не забудьте включить пробелы, если имена столбцов в файле CSV включают пробелы. Как было объяснено ранее, имена, которые вы введите в этих полях, должны соответствовать именам параметров в вашем CSV-файле. Например, на следующем скриншоте показаны имена параметров из примера CSV-файла для сценария кадровой отставки сотрудников, показанного в шаге 1.

    - Если вы выбрали несколько типов данных в шаге выше, необходимо ввести имя столбца идентификатора, которое определит тип данных hr в вашем CSV-файле. После ввода имени столбца идентификатора введите значение, которое идентифицирует этот тип данных hr, и введите имена загонщика столбцов для выбранных типов данных из файла CSV(ы), созданного в шаге 1, в каждом из соответствующих полей для каждого выбранного типа данных. Как было объяснено ранее, имена, которые вы введите в этих полях, должны соответствовать именам столбцов в CSV-файле.

8. На странице **Обзор** просмотрите параметры и нажмите **кнопку Готово** для создания соединитетеля.

   Отображается страница состояния, которая подтверждает, что соединитектор был создан. На этой странице содержатся две важные вещи, которые необходимо выполнить на следующем шаге, чтобы запустить пример сценария для отправки кадровой информации.

   ![Просмотр страницы с ИД задания и ссылкой на github для примера сценария](../media/HRConnector_Confirmation.png)

   1. **ID задания.** Для запуска сценария на следующем этапе вам потребуется этот ID задания. Вы можете скопировать его на этой странице или на странице вылетов соединители.

   1. **Ссылка на пример сценария.** Щелкните **здесь** ссылку, чтобы перейти на сайт GitHub, чтобы получить доступ к примеру сценария (ссылка открывает новое окно). Держите это окно открытым, чтобы можно было скопировать сценарий в шаге 4. Кроме того, вы можете закладки назначения или скопировать URL-адрес, чтобы вы могли получить доступ к нему снова при запуске сценария. Эта ссылка также доступна на странице вылетов соединители.

9. Нажмите кнопку **Готово**.

   Новый соединитатель отображается в списке на вкладке **Соединители.**

10. Щелкните только что созданный отдел кадров, чтобы отобразить страницу вылетов, которая содержит свойства и другие сведения о соединителе.

   ![Страница flyout для нового соединитетеля кадров](../media/HRConnectorWizard7.png)

Если вы еще этого не сделали, вы можете скопировать значения для **ID-задания Azure App и** **connector.** Они необходимы для запуска сценария на следующем шаге. Вы также можете скачать сценарий со страницы вылетов (или скачать его по ссылке на следующем шаге.)

Вы также можете нажать **кнопку Изменить,** чтобы изменить ID приложения Azure или имена загона столбцов, определенные на странице **сопоставления файлов.**

## <a name="step-4-run-the-sample-script-to-upload-your-hr-data"></a>Шаг 4. Запустите пример сценария, чтобы загрузить данные hr

Последний шаг в настройке соединитетеля кадров — запустить пример сценария, который будет загружать данные hr в CSV-файл (созданный в шаге 1) в облако Microsoft. В частности, скрипт загружает данные в соединителю управления персоналом. После запуска скрипта соединитатель кадров, созданный в шаге 3, импортирует hr-данные в организацию Microsoft 365, к которой можно получить доступ с помощью других средств обеспечения соответствия требованиям, например решения по управлению рисками insider. После запуска сценария подумайте о планировании задачи, которая будет автоматически запускаться ежедневно, чтобы наиболее актуальные данные о прекращении работы сотрудников были загружены в облако Майкрософт. См. [расписание автоматического запуска скрипта.](#optional-step-6-schedule-the-script-to-run-automatically)

1. Перейдите к окну, которое осталось открытым с предыдущего шага, чтобы получить доступ к сайту GitHub с помощью примера сценария. Кроме того, откройте сайт с закладкой или используйте скопированные URL-адреса.

2. Нажмите **кнопку Raw,** чтобы отобразить сценарий в текстовом представлении.

3. Скопируйте все строки в примере сценария и сохраните их в текстовом файле.

4. При необходимости измените пример сценария для организации.

5. Сохраните текстовый файл в виде Windows PowerShell скрипта с помощью суффикса имени файла, например `.ps1` `HRConnector.ps1` .

6. Откройте командную подсказку на локальном компьютере и перейдите в каталог, в котором сохранен сценарий.

7. Запустите следующую команду, чтобы загрузить данные hr в CSV-файле в облако Майкрософт; Например:

    ```powershell
    .\HRConnector.ps1 -tenantId <tenantId> -appId <appId>  -appSecret <appSecret>  -jobId <jobId>  -csvFilePath '<csvFilePath>'
    ```

   В следующей таблице описываются параметры, которые необходимо использовать с помощью этого скрипта, и их необходимые значения. Сведения, полученные в предыдущих действиях, используются в значениях для этих параметров.

   | Параметр | Описание |
   |:-----|:-----|:-----|
   |`tenantId`|Это Id для организации Microsoft 365, полученный в шаге 2. Вы также можете получить id клиента для организации на лезвии **Обзор** в центре администрирования Azure AD. Это используется для идентификации организации.|
   |`appId` |Это Id приложения Azure AD для приложения, созданного в Azure AD в шаге 2. Это используется Azure AD для проверки подлинности при попытке скрипта получить доступ к организации Microsoft 365. | 
   |`appSecret`|Это секрет приложения Azure AD для приложения, созданного в Azure AD в шаге 2. Это также используется для проверки подлинности.|
   |`jobId`|Это ИД задания для hr-соединиттеля, созданного в шаге 3. Это используется для связывать данные по персоналу, которые загружаются в облако Майкрософт, с соединитетелем кадров.|
   |`csvFilePath`|Это путь файла для CSV-файла (хранимый в той же системе, что и сценарий), созданный в шаге 1. Старайтесь избегать пробелов в пути файла; в противном случае используйте одиночные кавычка.|
   |||

   Вот пример синтаксиса для скрипта соединитель кадров с использованием фактических значений для каждого параметра:

   ```powershell
    .\HRConnector.ps1 -tenantId d5723623-11cf-4e2e-b5a5-01d1506273g9 -appId 29ee526e-f9a7-4e98-a682-67f41bfd643e -appSecret MNubVGbcQDkGCnn -jobId b8be4a7d-e338-43eb-a69e-c513cd458eba -csvFilePath 'C:\Users\contosoadmin\Desktop\Data\employee_termination_data.csv'
    ```

   Если загрузка будет успешной, скрипт отображает сообщение **Upload Successful.**

   > [!NOTE]
   > Если у вас возникли проблемы с выполнением [](/powershell/module/microsoft.powershell.core/about/about_execution_policies) предыдущей команды из-за политик выполнения, см. в инструкции по настройке политик выполнения политики выполнения и [Set-ExecutionPolicy.](/powershell/module/microsoft.powershell.security/set-executionpolicy)

## <a name="step-5-monitor-the-hr-connector"></a>Шаг 5. Мониторинг соединители кадров

После создания соединиттеля управления персоналом и запуска скрипта для отправки данных по персоналу можно просмотреть соединители и загрузить состояние в центре соответствия требованиям Microsoft 365. Если вы запланировать автоматический запуск скрипта на регулярной основе, вы также можете просмотреть текущее состояние после последнего запуска сценария.

1. Перейдите [https://compliance.microsoft.com](https://compliance.microsoft.com) и щелкните **соединители данных** в левом nav.

2. Щелкните **вкладку Соединители,** а затем выберите соединителет, чтобы отобразить страницу вылетов. На этой странице содержатся свойства и сведения о соединители.

   ![Страница для вылета соединитетеля кадров со свойствами и состоянием](../media/HRConnectorFlyout1.png)

3. В **статье Progress** щелкните ссылку **Журнал** загрузки, чтобы открыть (или сохранить) журнал состояния соединиттеля. В этом журнале содержатся сведения о каждом запуске сценария и отправке данных из CSV-файла в облако Майкрософт. 

   ![Файл журнала соединителя кадров отображает строки номеров из загруженного CSV-файла](../media/HRConnectorLogFile.png)

   Поле указывает количество строк в загруженном `RecordsSaved` CSV-файле. Например, если файл CSV содержит четыре строки, то значение полей составляет 4, если сценарий успешно загрузил все строки в `RecordsSaved` CSV-файле.

Если вы еще не запускали сценарий в шаге 4, ссылка на скачивание скрипта отображается в **статье Последний импорт**. Вы можете скачать сценарий, а затем выполнить действия для запуска сценария.

## <a name="optional-step-6-schedule-the-script-to-run-automatically"></a>(Необязательный) Шаг 6. Запланировать автоматический запуск сценария

Чтобы убедиться, что последние данные о персонале организации доступны для таких средств, как решение по управлению рисками, рекомендуется запланировать автоматический запуск скрипта, например один раз в день. Это также требует обновления данных о персонале в CSV-файле по аналогичному (если не одному) расписанию, чтобы в нем содержались последние сведения о сотрудниках, покидавших организацию. Цель заключается в том, чтобы загрузить самые актуальные данные по персоналу, чтобы соединители hr могли сделать их доступными для решения по управлению рисками.

Вы можете использовать приложение Scheduler задач в Windows, чтобы автоматически запускать сценарий каждый день.

1. На локальном компьютере нажмите кнопку Windows **Start** и введите **план-график задач.**

2. Щелкните **приложение Scheduler** задач, чтобы открыть его.

3. В разделе **Действия** нажмите кнопку **Создать задачу**.

4. На **вкладке General** введите описательное имя для запланированной задачи; например, **сценарий соединитетеля кадров**. Вы также можете добавить необязательное описание.

5. В **параметрах Безопасности** сделайте следующее:

   1. Определите, следует ли запускать сценарий только в том случае, если вы вошли на компьютер или запустите его при входе в систему или нет.

   1. Убедитесь, что **выбран почтовый** ящик Run с наивысшими привилегиями.

6. Выберите **вкладку Триггеры,** нажмите **кнопку New** и затем сделайте следующие вещи:

   1. В **параметрах** выберите параметр **Daily,** а затем выберите дату и время для первого запуска сценария. Сценарий будет каждый день в указанное время.

   1. В **расширенных параметрах** убедитесь, что выбран почтовый ящик **Включен.**

   1. Нажмите кнопку **ОК**.

7. Выберите **вкладку Действия,** **нажмите кнопку New** и затем сделайте следующие действия:

   ![Параметры действий для создания новой запланированной задачи для скрипта соединители hr](../media/HRConnectorScheduleTask1.png)

   1. В **списке "Действие"** убедитесь, что **выбрана** программа Start.

   1. В поле **Program/script** щелкните **Обзор** и перейдите к следующему расположению и выберите его таким образом, чтобы путь отображался в поле: `C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe` .

   1. В поле **Добавление аргументов (необязательный)** вклейте ту же команду скрипта, которую вы запустили в шаге 4. Пример: `.\HRConnector.ps1 -tenantId "d5723623-11cf-4e2e-b5a5-01d1506273g9" -appId "c12823b7-b55a-4989-faba-02de41bb97c3" -appSecret "MNubVGbcQDkGCnn"  -jobId "e081f4f4-3831-48d6-7bb3-fcfab1581458" -csvFilePath "C:\Users\contosoadmin\Desktop\Data\employee_termination_data.csv"`

   1. В поле **Начните (необязательно)** вложите расположение папки скрипта, который вы запустили в шаге 4. Например, `C:\Users\contosoadmin\Desktop\Scripts`.

   1. Нажмите **кнопку Ок,** чтобы сохранить параметры для нового действия.

8. В **окне Создать задачу** **щелкните Ок,** чтобы сохранить запланированную задачу. Возможно, вам будет предложено ввести учетные данные учетных данных учетных записей пользователей.

   Новая задача отображается в библиотеке планиров задач.

   ![Новая задача отображается в библиотеке планиров задач](../media/HRConnectorTaskSchedulerLibrary.png)

   При последнем запуске сценария и при следующем его запуске отображается. Вы можете дважды щелкнуть задачу, чтобы изменить ее.

   Вы также можете проверить последний раз, когда сценарий был на странице вылетов соответствующего hr-соединиттеля в центре соответствия требованиям.

## <a name="existing-hr-connectors"></a>Существующие соединители кадров

20 июля 2020 г. мы выпустили дополнительные сценарии, поддерживаемые соединитетелями кадров. Это сценарии управления персоналом, описанные ранее в этой статье. Любой соединитатель кадров, созданный до этой даты, поддерживает только сценарий отставки сотрудника. Если до 20 июля 2020 г. был создан соединитель кадров, мы перенаселили его таким образом, чтобы он продолжил перенос кадровой информации в облако Майкрософт. Для поддержания этой функции не нужно ничего делать. Вы можете продолжать использовать соединители без каких-либо сбоев.

Если вы хотите реализовать дополнительные сценарии управления персоналом, создайте новый соединители кадров и настройте его для выпущенных дополнительных сценариев кадров. Вам также потребуется создать один или несколько новых CSV-файлов, содержащих данные для поддержки дополнительных сценариев управления персоналом. После создания нового соединитетеля управления персоналом запустите скрипт с помощью ID задания нового соединиттеля и CSV-файла (s) с данными для дополнительных сценариев управления персоналом.