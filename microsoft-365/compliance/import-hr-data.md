---
title: Настройка соединителя для импорта данных о персонале
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
audience: Admin
ms.topic: how-to
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection: M365-security-compliance
description: Администраторы могут настроить соединитель данных для импорта данных о сотрудниках из системы отдела кадров (HR) своей организации в Microsoft 365. Это позволяет использовать данные о ПЕРСОНАЛе в политиках по управлению рисками для оценки активности для определенных пользователей, которые могут представлять внутреннюю угрозу организации.
ms.openlocfilehash: 78832d74a7d61577e5ec49c290e19bdec758a0b3
ms.sourcegitcommit: abf63669daf12993ad3353e4b578f41c8910b20f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/27/2020
ms.locfileid: "47289254"
---
# <a name="set-up-a-connector-to-import-hr-data-preview"></a>Настройка соединителя для импорта данных отдела кадров (Предварительная версия)

Вы можете настроить соединитель данных в центре соответствия требованиям Microsoft 365 для импорта данных отдела кадров (HR), связанных с событиями, такими как ресигнатион пользователя или изменение на уровне задания пользователя. Эти данные о ПЕРСОНАЛе можно использовать в [решении по управлению рисками](insider-risk-management.md) , чтобы создать индикаторы риска, которые могут помочь в идентификации возможных вредоносных действий или кражи данных пользователями внутри Организации.

Настройка соединителя для данных о ПЕРСОНАЛе, которые могут использоваться политиками системы оценки риска для создания показателей риска, состоит в создании CSV-файла, содержащего данные о HR, создание приложения в Azure Active Directory, используемого для проверки подлинности, создания соединителя данных HR в центре соответствия требованиям Microsoft 365 и последующего запуска сценария (по расписанию), который обеспечивает данные отдела кадров в CSV-файлах в Microsoft Cloud, чтобы она была доступна для участников программы предварительной оценки решение по управлению рисками.

## <a name="before-you-begin"></a>Перед началом работы

- Определите, какие сценарии и данные о ПЕРСОНАЛе необходимо импортировать в Microsoft 365. Это поможет определить, сколько CSV-файлов и соединителей необходимо создать, а также как создать и структурировать CSV-файлы. Импортируемые данные о HRе определяются политиками управления рисками для оценки, которые необходимо реализовать. Для получения дополнительных сведений посетите шаг 1.

- Определите способ извлечения и экспорта данных из системы отдела кадров Организации (и регулярно) и добавьте его в CSV-файлы, созданные на этапе 1. Скрипт, который вы запускаете на шаге 4, будет отправлять данные HR в CSV-файлах в Microsoft Cloud.

- Ваша организация должна предоставить согласие, чтобы разрешить службе импорта Office 365 доступ к данным в Организации. Чтобы согласиться с этим запросом, перейдите на [эту страницу](https://login.microsoftonline.com/common/oauth2/authorize?client_id=570d0bec-d001-4c4e-985e-3ab17fdc3073&response_type=code&redirect_uri=https://portal.azure.com/&nonce=1234&prompt=admin_consent), войдите с помощью учетных данных глобального администратора Microsoft 365 и примите запрос. Необходимо выполнить это действие, прежде чем вы сможете успешно создать соединитель кадров в действии 3.

- Пользователю, создающему соединитель HR в действии 3, должна быть назначена роль импорта почтовых ящиков в Exchange Online. По умолчанию эта роль не назначена ни одной группе ролей в Exchange Online. Вы можете добавить роль экспорта для импорта почтовых ящиков в группу ролей Управление организацией в Exchange Online. Вы также можете создать новую группу ролей, назначить роль импорта почтовых ящиков, а затем добавить соответствующих пользователей в качестве участников. Для получения дополнительных сведений обратитесь к разделу [Создание](https://docs.microsoft.com/Exchange/permissions-exo/role-groups#create-role-groups) групп ролей или [изменение групп ролей](https://docs.microsoft.com/Exchange/permissions-exo/role-groups#modify-role-groups) статьи "Управление группами ролей в Exchange Online".

- Пример скрипта, выполняемого в действии 4, будет отправлять данные о ПЕРСОНАЛе в облако Майкрософт, чтобы их можно было использовать в решении по управлению рисками для оценки. Этот пример скрипта не поддерживается ни в одной из стандартных программ или услуг поддержки Майкрософт. Пример сценария предоставляется без каких-либо гарантий. Кроме того, корпорация Майкрософт отказывается от всех подразумеваемых гарантий, включая, но не ограничиваясь указанным, все подразумеваемые гарантии пригодности для продажи или определенной цели. Весь риск, возникающий из примера использования или производительности примера сценария и документации, остается без вас. Корпорация Майкрософт, ее штатные авторы и другие лица, принимающие участие в создании, подготовке и выпуске сценариев, ни при каких обстоятельствах не несут ответственность за какой-либо ущерб (в том числе, ущерб, вызванный потерей доходов предприятия, остановкой его работы, потерей бизнес-данных и другими материальными потерями), вызванный использованием или неспособностью использовать примеры сценариев и документацию, даже если корпорации Майкрософт известно о возможности нанесения такого ущерба.

## <a name="step-1-prepare-a-csv-file-with-your-hr-data"></a>Шаг 1: Подготовка CSV-файла к данным отдела кадров

Первым шагом является создание CSV-файла, содержащего данные о HR, которые соединитель будет импортировать в Microsoft 365. Эти данные будут использоваться решением для оценки риска, чтобы создать потенциальные индикаторы риска. Данные для следующих сценариев HR можно импортировать в Microsoft 365:

- Ресигнатион сотрудников. Сведения о пользователях, которые оставили вашу организацию.

- Изменения на уровне задания. Сведения об изменениях уровня задания для пользователей, например, повышения и понижения роли.

- Обзор производительности. Сведения о производительности пользователей.

- Планы улучшения производительности. Сведения о планах улучшения производительности для пользователей.

Тип импортируемых данных о ПЕРСОНАЛе зависит от политики управления рисками для предварительной оценки и соответствующим шаблоном политики, который необходимо реализовать. В следующей таблице показано, какой тип данных HR необходим для каждого шаблона политики:

| **Шаблон политики**| **Тип данных HR**|
|:-----------------------------------------------|:---------------------------------------------------------------------|
| Хищение данных за счет посторонних пользователей                   | Переписывание сотрудников                                                 |
| Общие утечки данных                              | Неприменимо                                                        |
| Утечки данных по приоритетным пользователям                    | Неприменимо                                                        |
| Утечки данных пользователями дисгрунтлед                 | Изменения на уровне задания, обзоры производительности, планы улучшения производительности |
| Общие нарушения политики безопасности              | Неприменимо                                                        |
| Нарушения политики безопасности за счет посторонних пользователей   | Переписывание сотрудников                                                 |
| Нарушения политики безопасности по приоритету пользователей    | Неприменимо                                                        |
| Нарушения политики безопасности пользователями дисгрунтлед | Изменения на уровне задания, обзоры производительности, планы улучшения производительности |
| Оскорбительный язык в сообщении электронной почты                     | Неприменимо                                                        |

Дополнительные сведения о шаблонах политик для управления рисками можно найти в статье рекомендации по [управлению](insider-risk-management-policies.md#policy-templates)рисками для участников.

Для каждого сценария HR вам потребуется предоставить соответствующие данные отдела кадров в один или несколько CSV-файлов. Количество CSV-файлов, используемых для реализации управления рисками для оценки, обсуждается далее в этом разделе.

После создания CSV-файла с необходимыми данными HR сохраните его на локальном компьютере, на котором выполняется сценарий на шаге 4. Кроме того, следует реализовать стратегию обновления, чтобы убедиться, что CSV-файл всегда содержит актуальные сведения, чтобы вы могли выполнить сценарий, последние данные отдела кадров будут передаваться в облако Майкрософт и доступны для решения по управлению рисками для оценки.

> [!IMPORTANT]
> Имена столбцов, описанные в следующих разделах, не являются обязательными параметрами, а только примеры. В CSV-файлах можно использовать любое имя столбца. Однако имена столбцов, которые используются в CSV-файле, *должны* быть сопоставлены с типом данных при создании соединителя кадров на шаге 3. Кроме того, обратите внимание на то, что примеры CSV-файлов в следующих разделах отображаются в представлении "Блокнот". Более простой просмотр и редактирование CSV-файлов в Microsoft Excel.

В следующих разделах описываются необходимые данные CSV для каждого сценария HR.

### <a name="csv-file-for-employee-resignation-data"></a>CSV-файл для данных ресигнатион сотрудников

Ниже приведен пример CSV-файла для ресигнатион данных сотрудников.

```text
EmailAddress,ResignationDate,LastWorkingDate
sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,2019-04-29T15:18:02.4675041+05:30
pilarp@contoso.com,2019-04-24T09:15:49Z,2019-04-29T15:18:02.7117540
```

В следующей таблице описаны все столбцы в CSV-файле для данных ресигнатион Employees.

| **Столбец**  |  **Описание**|
|:------------|:----------------|
|**EmailAddress**| Указывает адрес электронной почты (UPN) завершенного пользователя.|
| **ресигнатиондате** | Указывает дату, когда сотрудник пользователя официально прекратил работу в Организации. Например, это может быть Дата, когда пользователь выдает уведомление о выходе из вашей организации. Эта дата может отличаться от даты последнего дня работы человека. Необходимо использовать следующий формат даты: `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm` , представляющий собой [Формат даты и времени ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html).|
| **ластворкингдате** | Указывает последний день работы для прерванного пользователя. Необходимо использовать следующий формат даты: `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm` , представляющий собой [Формат даты и времени ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html).|
|||

### <a name="csv-file-for-job-level-changes-data"></a>CSV-файл для изменения данных на уровне задания

Ниже приведен пример CSV-файла для изменения данных на уровне задания.

```text
EmailAddress,EffectiveDate,OldLevel,NewLevel
sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,Level 61 – Sr. Manager,Level 60- Manager
pillar@contoso.com,2019-04-23T15:18:02.4675041+05:30,Level 62 – Director,Level 60- Sr. Manager
```

В следующей таблице описаны все столбцы в CSV-файле для изменения данных на уровне задания.

| **Столбец**|**Описание**|
|:--------- |:------------- |
| **EmailAddress**  | Указывает адрес электронной почты пользователя (UPN).|
| **EffectiveDate** | Указывает дату официального изменения уровня задания пользователя. Необходимо использовать следующий формат даты: `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm` , представляющий собой [Формат даты и времени ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html).|
| **Замечания**| Указывает, какие примечания предоставляются оценщиком об изменении уровня должности. Это текстовый параметр с предельным числом 200 символов. Это необязательный параметр. Нет необходимости включать его в CSV-файл.|
| **олдлевел**| Задает уровень задания пользователя перед его изменением. Это параметр свободного текста, который может содержать иерархию таксономии для Организации. Это необязательный параметр. Нет необходимости включать его в CSV-файл.|
| **невлевел**| Задает уровень задания пользователя после его изменения. Это параметр свободного текста, который может содержать иерархию таксономии для Организации. Это необязательный параметр. Нет необходимости включать его в CSV-файл.|
|||

### <a name="csv-file-for-performance-review-data"></a>CSV-файл для данных проверки производительности

Ниже приведен пример CSV-файла для данных о производительности.

```text
EmailAddress,EffectiveDate,Remarks,Rating
sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,Met expectations but bad attitude,2-Below expectation
pillar@contoso.com,2019-04-23T15:18:02.4675041+05:30, Multiple conflicts with the team
```

В следующей таблице описаны все столбцы в CSV-файле для данных анализа производительности.

| **Столбец**|**Описание**|
|:----------|:--------------|
| **EmailAddress**  | Указывает адрес электронной почты пользователя (UPN).|
| **EffectiveDate** | Указывает дату, когда пользователь официально информируется о результатах проверки производительности. Это может быть Дата, когда закончился цикл проверки производительности. Необходимо использовать следующий формат даты: `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm` , представляющий собой [Формат даты и времени ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html).|
| **Замечания**| Указывает все замечания, предоставленные пользователю для оценки производительности. Это текстовый параметр с предельным числом 200 символов. Это необязательный параметр. Нет необходимости включать его в CSV-файл.|
| **Оценка**| Указывает рейтинг, предоставленный для оценки производительности. Это текстовый параметр, который может содержать любой текст произвольной формы, который используется в Организации для распознавания оценки. Например, "3 соответствует ожиданиям" или "2 ниже среднего". Это текстовый параметр, длина которого не превышает 25 символов. Это необязательный параметр. Нет необходимости включать его в CSV-файл.|
|||

### <a name="csv-file-for-performance-improvement-plan-data"></a>CSV-файл для данных плана улучшения производительности

Ниже приведен пример CSV-файла для данных плана улучшения производительности.

```text
EmailAddress,EffectiveDate,ImprovementRemarks,PerformanceRating
sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,Met expectation but bad attitude,2-Below expectation
pillar@contoso.com,2019-04-23T15:18:02.4675041+05:30, Multiple conflicts with the team
```

В следующей таблице описаны все столбцы в CSV-файле для данных анализа производительности.

| **Столбец**| **Описание**|
|:----------|:---------------|
| **EmailAddress**  | Указывает адрес электронной почты пользователя (UPN).|
| **EffectiveDate** | Указывает дату, когда пользователь официально информируется о плане улучшения производительности. Необходимо использовать следующий формат даты: `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm` , представляющий собой [Формат даты и времени ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html).|
| **Замечания**| Указывает все замечания, предоставленные средством оценки плана улучшения производительности. Это текстовый параметр с предельным числом 200 символов. Это необязательный параметр. Нет необходимости включать его в CSV-файл. |
| **Оценка**| Указывает любую оценку или другие сведения, связанные с проверкой производительности. план улучшения производительности. Это текстовый параметр, который может содержать любой произвольный текст формы, который использует Организация для распознавания оценки. Например, "3 соответствует ожиданиям" или "2 ниже среднего". Это текстовый параметр, длина которого не превышает 25 символов. Это необязательный параметр. Нет необходимости включать его в CSV-файл.|
|||

### <a name="determining-how-many-csv-files-to-use-for-hr-data"></a>Определение количества CSV-файлов, используемых для данных отдела кадров

На шаге 3 можно создать отдельные соединители для каждого типа данных HR или создать один соединитель для всех типов данных. Можно использовать отдельные CSV-файлы, содержащие данные для одного сценария отдела кадров (например, примеры CSV-файлов, описанных в предыдущих разделах). Кроме того, можно использовать один CSV-файл, содержащий данные для двух или более сценариев отдела кадров. Ниже приведены рекомендации по определению количества CSV-файлов, используемых для данных отдела кадров.

- Если для политики управления рисками, которую вы хотите реализовать, требуется несколько типов данных HR, рекомендуется использовать один CSV-файл, содержащий все необходимые типы данных.

- В методе для создания или сбора данных о HR может быть определено количество CSV-файлов. Например, если различные типы данных о КАДРах, используемые для настройки соединителя кадров, находятся в одной системе управления персоналом в Организации, вы можете экспортировать данные в один CSV-файл. Но если данные распределены по разным системам управления персоналом, то можно будет упростить экспорт данных в другие CSV-файлы. Например, данные о сотрудниках ресигнатион могут находиться в разных системах отдела кадров, чем данные на уровне задания или анализа производительности. В этом случае может оказаться проще иметь отдельные CSV-файлы вместо того, чтобы вручную объединять данные в один CSV-файл. Таким образом, способ извлечения и экспорта данных из систем отдела кадров может определять, как нужно количество CSV-файлов.

- Как правило, количество КАДРОВых соединителей, которые необходимо создать, определяется типами данных в CSV-файле. Например, если CSV-файл содержит все типы данных, необходимые для поддержки реализации управления рисками для оценки, то необходим только один соединитель HR. Но если у вас есть два отдельных CSV-файла, каждый из которых содержит один тип данных, необходимо создать два разъема HR. Исключением является то, что при добавлении столбца **хрсценарио** в CSV-файл (см. следующий раздел) можно настроить один соединитель кадров, который может ОБРАБАТЫВАТЬ различные CSV-файлы.

### <a name="configuring-a-single-csv-file-for-multiple-hr-data-types"></a>Настройка одного CSV-файла для нескольких типов данных HR

Вы можете добавить несколько типов данных HR в один CSV-файл. Это полезно, если для реализуемого решения по управлению рисками требуется несколько типов данных HR или типы данных находятся в одной системе управления персоналом в Организации. Меньшее количество CSV-файлов всегда позволяет использовать меньшее количество кадров для создания и управления.

Ниже приведены требования к настройке CSV-файла с несколькими типами данных:

- Необходимо добавить обязательные столбцы (и необязательно, если они используются) для каждого типа данных и соответствующего имени столбца в строке заголовков. Если тип данных не соответствует столбцу, значение можно оставить пустым.

- Чтобы использовать CSV-файл с несколькими типами данных HR, в соединителе HR необходимо знать, какие строки в CSV-файле содержат данные типа HR. Это достигается путем добавления дополнительного столбца **хрсценарио** в CSV-файл. Значения в этом столбце определяют тип данных HR в каждой строке. Например, значения, соответствующие четырем сценариям управления персоналом, могут быть \` ресигнатион \` , \` изменением на уровне задания \` , \` обзором производительности \` и \` планом улучшения производительности \` .

- Если у вас есть несколько CSV-файлов, содержащих столбец Хрсценарио * *, убедитесь, что каждый файл использует одно и то же имя столбца и одинаковые значения, определяющие конкретные сценарии для отдела кадров.

В следующем примере показан CSV-файл, содержащий столбец **хрсценарио** . Значения в столбце Хрсценарио определяют тип данных в соответствующей строке.

```text
HRScenario,EmailAddress,ResignationDate,LastWorkingDate,EffectiveDate,Remarks,Rating,OldLevel,NewLevel
Resignation,sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,2019-04-29T15:18:02.4675041+05:30,,,,
Resignation,pilarp@contoso.com,2019-04-24T09:15:49Z,2019-04-29T15:18:02.7117540,,,,
Job level change,sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,,,,,Level 61 Sr. Manager, Level 60 Manager
Job level change,pillarp@contoso.com,2019-04-23T15:18:02.4675041+05:30,,,,,Level 62 Director,Level 60 Sr Manager
Performance review,sarad@contoso.com,,,2019-04-23T15:18:02.4675041+05:30,Met expectation but bad attitude,2 Below expectations,,
Performance review,pillarp@contoso.com,,,2019-04-23T15:18:02.4675041+05:30, Multiple conflicts with the team,,
Performance improvement plan,sarad@contoso.com,,,2019-04-23T15:18:02.4675041+05:30,Met expectations but bad attitude,2 Below expectations,,
Performance improvement plan,pillarp@contoso.com,,,2019-04-23T15:18:02.4675041+05:30,Multiple conflicts with the team,,
```

> [!NOTE]
> Можно использовать любое имя столбца, который определяет тип данных HR, так как сопоставление имени столбца в CSV-файле выполняется в виде столбца, который определяет тип данных HR при настройке соединителя на шаге 3. Кроме того, при настройке соединителя будут сопоставлены значения, используемые для столбца типа данных.

### <a name="adding-the-hrscenario-column-to-a-csv-file-that-contains-a-single-data-type"></a>Добавление столбца Хрсценарио в CSV-файл, который содержит один тип данных

В зависимости от того, какие системы отдела кадров вашей организации и как экспортировать данные HR в CSV-файл, может потребоваться создать несколько CSV-файлов, содержащих один тип данных HR. В этом случае вы по-прежнему можете создать один соединитель кадров для импорта данных из разных CSV-файлов. Для этого необходимо добавить в CSV-файл столбец Хрсценарио и указать тип данных HR. Затем можно выполнить сценарий для каждого CSV-файла, но использовать для соединителя один и тот же идентификатор задания. См. [Шаг 4](#step-4-run-the-sample-script-to-upload-your-hr-data).

## <a name="step-2-create-an-app-in-azure-active-directory"></a>Шаг 2: создание приложения в Azure Active Directory

Следующий шаг — создание и регистрация нового приложения в Azure Active Directory (Azure AD). Приложение будет соответствовать соединителю HR, созданному на шаге 3. Создание этого приложения позволит Azure AD выполнить проверку подлинности для соединителя HR, когда он работает, и пытается получить доступ к Организации. Это приложение также будет использоваться для проверки подлинности скрипта, выполняемого на шаге 4, для отправки данных отдела кадров в Microsoft Cloud. Во время создания приложения Azure AD обязательно сохраните следующие сведения. Эти значения будут использоваться на этапе 3 и 4.

- Идентификатор приложения Azure AD (также называемый *идентификатором приложения* или *идентификатором клиента*)

- Секрет приложения Azure AD (также называемый *секретом клиента*)

- Идентификатор клиента (также называемый *идентификатором каталога*)

Пошаговые инструкции по созданию приложения в Azure AD приведены в статье [Регистрация приложения с помощью платформы удостоверений Майкрософт](https://docs.microsoft.com/azure/active-directory/develop/quickstart-register-app).

## <a name="step-3-create-the-hr-connector"></a>Шаг 3: Создание соединителя кадров

Следующий шаг — создание соединителя кадров в центре соответствия требованиям Microsoft 365. После выполнения сценария, созданного на шаге 4, созданный соединитель кадров будет отправит данные отдела кадров из CSV-файла в организацию Microsoft 365. Прежде чем создавать соединитель, убедитесь, что у вас есть список сценариев HR и соответствующие имена столбцов CSV для каждого из них. При настройке соединителя необходимо сопоставить данные, необходимые для каждого сценария, с реальными именами столбцов в вашем CSV-файле. Кроме того, вы можете отправить пример CSV-файла при настройке соединителя, и мастер поможет сопоставить имена столбцов с требуемыми типами данных.

После выполнения этого действия не забудьте скопировать идентификатор задания, созданный при создании соединителя. При запуске скрипта вы будете использовать идентификатор задания.

1. [https://compliance.microsoft.com](https://compliance.microsoft.com/)В левой панели навигации выберите элемент **соединители данных и нажмите кнопку соединители данных** .

2. На странице **Data Connectors (Preview) (Предварительная версия)** в разделе **HR**нажмите кнопку **Просмотр**.

3. На **настраиваемой странице HR** нажмите кнопку **Добавить соединитель**.

4. На странице **Настройка подключения** выполните следующие действия, а затем нажмите кнопку **Далее**.

   а) Введите или вставьте идентификатор приложения Azure AD для приложения Azure, созданного в шаге 2.

   б) Введите имя для соединителя кадров.

5. На странице "сценарии в отделе кадров" выберите один или несколько сценариев отдела кадров, для которых нужно импортировать данные, а затем нажмите кнопку **Далее**.

6. На странице способ сопоставления файлов выберите один из следующих параметров и нажмите кнопку **Далее**.

   - **Отправьте пример файла**. При выборе этого параметра щелкните **Отправить пример файла** , чтобы отправить CSV-файл, подготовленный на шаге 1. С помощью этого параметра можно быстро выбрать имена столбцов в CSV-файле из раскрывающегося списка, чтобы сопоставить их типам данных для сценариев кадров, которые вы ранее выбрали.

   OR

   - **Предоставьте сведения о сопоставлении вручную**. Если выбран этот параметр, необходимо ввести имя столбца в CSV-файле, чтобы сопоставить их с типами данных для сценариев HR, которые вы ранее выбирали.

7. На странице "сведения о сопоставлении файлов" выполните одно из следующих действий в зависимости от того, был ли загружен пример CSV-файла и настроен ли соединитель для одного сценария отдела кадров или для нескольких сценариев. Если вы отправили файл примера, вам не придется вводить имена столбцов. Вы выбираете их из раскрывающегося списка.

    - Если вы выбрали один сценарий HR на предыдущем шаге, введите имена заголовков столбцов (также называемые *параметрами*) из CSV-файла, созданного на шаге 1, в соответствующие поля. Имена столбцов, которые вы вводите, не учитывают регистр, но не забудьте указать пробелы, если имена столбцов в CSV-файле содержат пробелы. Как было сказано выше, имена, введенные в этих полях, должны быть соответствующими именам в CSV-файле. Например, на следующем снимке экрана показаны имена параметров из примера CSV-файла для сценария ресигнатион HR, показанного на шаге 1.

    - Если на шаге выше выбрано несколько типов данных, необходимо ввести имя столбца идентификатора, который будет определять тип данных HR в CSV-файле. После ввода имени столбца идентификатора введите значение, определяющее тип данных HR, и введите имена заголовков столбцов для выбранных типов данных из CSV-файлов, созданных на шаге 1, в каждом из соответствующих полей для каждого выбранного типа данных. Как описывалось ранее, имена, введенные в этих полях, должны быть соответствующими именам столбцов в CSV-файле.

8. На странице " **Проверка** " Проверьте параметры и нажмите кнопку **Готово** , чтобы создать соединитель.

   Отображается страница состояния, которая подтверждает, что соединитель был создан. Эта страница содержит две важные вещи, которые необходимо выполнить, чтобы выполнить пример сценария для отправки данных отдела кадров.

   ![Страница проверки с ИДЕНТИФИКАТОРом задания и ссылкой на GitHub для примера сценария](../media/HRConnector_Confirmation.png)

   а) **Идентификатор задания.** Этот код задания потребуется для запуска скрипта на следующем шаге. Вы можете скопировать его с этой страницы или из всплывающей страницы соединителя.

   б) **Ссылка на пример скрипта.** Щелкните ссылку **здесь** , чтобы перейти на сайт GitHub для доступа к образцу скрипта (ссылка открывает новое окно). Оставьте это окно открытым, чтобы можно было скопировать скрипт на шаге 4. Кроме того, вы можете создать закладку для назначения или скопировать URL-адрес, чтобы получить доступ к нему при запуске скрипта. Эта ссылка также доступна на всплывающей странице соединителя.

9. Нажмите кнопку **Готово**.

   Новый соединитель отображается в списке на вкладке **соединители** .

10. Щелкните соединитель кадров, который вы только что создали для отображения всплывающей страницы, содержащей свойства и другие сведения о соединителе.

   ![Всплывающая страница для нового соединителя кадров](../media/HRConnectorWizard7.png)

Если вы еще не сделали это, вы можете скопировать значения **идентификатора приложения Azure** и **идентификатора задания соединителя**. Они понадобятся вам для запуска скрипта на следующем шаге. Вы также можете скачать скрипт со всплывающей страницы (или скачать его, используя ссылку на следующем шаге).

Вы также можете нажать кнопку **изменить** , чтобы изменить идентификатор приложения Azure или имена заголовков столбцов, определенных на странице **сопоставления файлов** .

## <a name="step-4-run-the-sample-script-to-upload-your-hr-data"></a>Шаг 4: выполнение примера сценария для отправки данных отдела кадров

Последний шаг при настройке соединителя кадров — выполнение примера сценария, который отправляет данные HR в CSV-файл (созданный на шаге 1) в Microsoft Cloud. В частности, сценарий передает данные в соединитель HR. После выполнения скрипта соединитель кадров, созданный на шаге 3, импортирует данные отдела кадров в организацию Microsoft 365, к которой он может получить доступ с помощью других средств обеспечения соответствия, таких как решение по управлению рисками для оценки. После выполнения сценария рассмотрите возможность планирования задачи для ежедневного запуска, чтобы последние данные о прекращении работы сотрудников передавались в облако Майкрософт. Просмотрите [расписание автоматического запуска скрипта](#optional-step-6-schedule-the-script-to-run-automatically).

1. Откройте окно, слева от предыдущего шага, чтобы получить доступ к сайту GitHub с помощью примера скрипта. В качестве альтернативного варианта откройте сайт с закладками или воспользуйтесь скопированным URL-адресом.

2. Нажмите кнопку **RAW** , чтобы отобразить скрипт в текстовом представлении.

3. Скопируйте все строки в примере сценария и сохраните их в текстовом файле.

4. При необходимости измените пример сценария для Организации.

5. Сохраните текстовый файл в виде файла сценария Windows PowerShell, используя суффикс имени файла `.ps1` , например `HRConnector.ps1` .

6. Откройте командную строку на локальном компьютере и перейдите к каталогу, в котором был сохранен сценарий.

7. Выполните следующую команду, чтобы отправить данные отдела кадров в CSV-файл в Microsoft Cloud; Например:

    ```powershell
    .\HRConnector.ps1 -tenantId <tenantId> -appId <appId>  -appSecret <appSecret>  -jobId <jobId>  -csvFilePath '<csvFilePath>'
    ```

   В следующей таблице описаны параметры, которые необходимо использовать с этим сценарием и их обязательные значения. Сведения, полученные на предыдущих этапах, используются в значениях этих параметров.

   |**Параметр**|**Описание**
   |:-----|:-----|:-----|
   |`tenantId`|Это идентификатор вашей организации Microsoft 365, полученной на шаге 2. Вы также можете получить идентификатор клиента для своей организации в колонке **Обзор** в центре администрирования Azure AD. Используется для идентификации Организации.|
   |`appId` |Это идентификатор приложения Azure AD для приложения, созданного в Azure AD в действии 2. Это используется Azure AD для проверки подлинности при попытке сценария получить доступ к организации Microsoft 365. | 
   |`appSecret`|Это секрет приложения Azure AD для приложения, созданного в Azure AD в действии 2. Он также используется для проверки подлинности.|
   |`jobId`|Это идентификатор задания для соединителя HR, созданного на шаге 3. Используется для связывания данных отдела кадров, которые передаются в облако Майкрософт с помощью соединителя HR.|
   |`csvFilePath`|Это путь к CSV-файлу (который хранится в той же системе, что и скрипт), созданном на шаге 1. Старайтесь не использовать пробелы в пути к файлу; в противном случае используйте одинарные кавычки.|
   |||

   Ниже приведен пример синтаксиса сценария HR Connector с использованием фактических значений для каждого параметра:

   ```powershell
    .\HRConnector.ps1 -tenantId d5723623-11cf-4e2e-b5a5-01d1506273g9 -appId 29ee526e-f9a7-4e98-a682-67f41bfd643e -appSecret MNubVGbcQDkGCnn -jobId b8be4a7d-e338-43eb-a69e-c513cd458eba -csvFilePath 'C:\Users\contosoadmin\Desktop\Data\employee_termination_data.csv'
    ```

   Если отправка выполнена успешно, сценарий отображает сообщение об **успешном выполнении отправки** .

   > [!NOTE]
   > Если у вас возникли проблемы с выполнением предыдущей команды из-за политик выполнения, ознакомьтесь со статьями [о политиках выполнения](https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_execution_policies) и [Set-ExecutionPolicy](https://docs.microsoft.com/powershell/module/microsoft.powershell.security/set-executionpolicy) для получения инструкций по настройке политик выполнения.

## <a name="step-5-monitor-the-hr-connector"></a>Шаг 5: мониторинг соединителя кадров

После создания соединителя HR и запуска сценария для отправки данных HR можно просмотреть соединитель и состояние отправки в центре соответствия требованиям Microsoft 365. Если вы планируете регулярное выполнение скрипта, вы также можете просмотреть текущее состояние после последнего запуска сценария.

1. Перейдите к разделу [https://compliance.microsoft.com](https://compliance.microsoft.com) **соединители данных** в левой панели навигации и нажмите кнопку соединители данных.

2. Перейдите на вкладку **соединители** и выберите соединитель кадров, чтобы отобразить всплывающую страницу, содержащую свойства и информацию о соединителе.

   ![Всплывающая страница соединителя HR со свойствами и состоянием](../media/HRConnectorFlyout1.png)

3. В разделе **ход выполнения**щелкните ссылку **Журнал скачивания** , чтобы открыть (или сохранить) журнал состояний для соединителя. Этот журнал содержит сведения о каждом запуске скрипта и передает данные из CSV-файла в Microsoft Cloud. 

   ![Файл журнала соединителей HR отображает числовые строки из CSV-файла, которые были отправлены](../media/HRConnectorLogFile.png)

   В этом `RecordsSaved` поле указывается число строк в CSV-файле, который был отправлен. Например, если CSV-файл содержит четыре строки, то значение этих `RecordsSaved` полей равно 4, если сценарий успешно отправил все строки в CSV-файле.

Если вы еще не запустили сценарий на шаге 4, в разделе **Последний импорт**отображается ссылка для скачивания сценария. Чтобы запустить скрипт, можно скачать его и выполнить указанные ниже действия.

## <a name="optional-step-6-schedule-the-script-to-run-automatically"></a>Необязательно Шаг 6: Планирование автоматического запуска скрипта

Чтобы гарантировать, что последние данные о HR из вашей организации доступны для таких средств, как решение для управления рисками, рекомендуется автоматически запускать сценарий регулярно, например, раз в день. При этом также необходимо обновить данные отдела кадров в CSV-файле в соответствии с расписанием (если это не то же), чтобы оно содержало последние сведения о сотрудниках, которые покинут вашу организацию. Задача заключается в том, чтобы отправить наиболее актуальные данные о HR, чтобы соединитель кадров мог сделать его доступным для решения по управлению рисками для оценки.

Вы можете использовать приложение планировщика заданий в Windows для автоматического запуска скрипта каждый день.

1. На локальном компьютере нажмите кнопку " **Пуск** " Windows и введите **планировщик задач**.

2. Щелкните приложение **планировщика заданий** , чтобы открыть его.

3. В разделе **действия** выберите команду **создать задачу**.

4. На вкладке **Общие** введите описательное имя запланированной задачи. Например, **сценарий HR Connector**. Кроме того, можно добавить необязательное описание.

5. В разделе **Параметры безопасности**выполните следующие действия:

   а) Определите, следует ли запускать сценарий только при входе в систему или при выполнении входа в систему.

   б) Убедитесь, что установлен флажок **запускать с максимальными привилегиями** .

6. Перейдите на вкладку **триггеры** , нажмите кнопку **создать**, а затем выполните следующие действия:

   а) В разделе **Параметры**выберите параметр **ежедневно** , а затем выберите дату и время для первого запуска скрипта. Скрипт будет ежедневно в одно и то же время.

   б) В разделе **Дополнительные параметры**убедитесь, что установлен флажок **включен** .

   в. Нажмите кнопку **ОК**.

7. Перейдите на вкладку **действия** , нажмите кнопку **создать**, а затем выполните следующие действия:

   ![Параметры действий для создания новой запланированной задачи для сценария с соединителем для отдела кадров](../media/HRConnectorScheduleTask1.png)

   а) В раскрывающемся списке **действий** убедитесь, что выбран пункт **запустить программу** .

   б) В поле **Программа/сценарий** нажмите кнопку **Обзор**и перейдите к следующему расположению и выберите его, чтобы отобразить путь в поле: `C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe` .

   в. В поле **Добавить аргументы (необязательно)** вставьте ту же команду сценария, что была выполнена в шаге 4. Пример: `.\HRConnector.ps1 -tenantId "d5723623-11cf-4e2e-b5a5-01d1506273g9" -appId "c12823b7-b55a-4989-faba-02de41bb97c3" -appSecret "MNubVGbcQDkGCnn"  -jobId "e081f4f4-3831-48d6-7bb3-fcfab1581458" -csvFilePath "C:\Users\contosoadmin\Desktop\Data\employee_termination_data.csv"`

   г. В поле **Запуск в (необязательно)** вставьте путь к папке сценария, который был выполнен на шаге 4. Например, `C:\Users\contosoadmin\Desktop\Scripts`.

   д. Нажмите кнопку **ОК** , чтобы сохранить параметры для нового действия.

8. В окне **Создание задачи** нажмите кнопку **ОК** , чтобы сохранить запланированную задачу. Возможно, вам будет предложено ввести учетные данные учетной записи пользователя.

   Новая задача отображается в библиотеке планировщика задач.

   ![Новая задача отображается в библиотеке планировщика задач](../media/HRConnectorTaskSchedulerLibrary.png)

   Время последнего запуска сценария и его последующего запланированного запуска. Можно дважды щелкнуть задачу, чтобы изменить ее.

   Кроме того, вы можете проверить время последнего запуска сценария на всплывающей странице соответствующего соединителя кадров в центре соответствия требованиям.

## <a name="existing-hr-connectors"></a>Существующие соединители для отдела кадров

20 июля 2020 мы выпускали дополнительные сценарии, которые поддерживаются соединителями отдела кадров. Это сценарии для кадров, описанные ранее в этой статье. Любой соединитель HR, созданный до этой даты, поддерживает только сценарий ресигнатион для сотрудников. Если вы создали соединитель кадров до 20 июля 2020, мы перенесли его таким образом, чтобы он продолжал перенести данные о ПЕРСОНАЛе в облако Майкрософт. Вам не нужно ничего делать для поддержки этой функции. Вы можете продолжить использование соединителя без недостаточного перерыва.

Если вы хотите внедрить дополнительные сценарии для отдела кадров, создайте новый соединитель кадров и настройте его для дополнительных сценариев отдела кадров, которые были выпущены. Кроме того, вам потребуется создать один или несколько новых CSV-файлов, содержащих данные для поддержки дополнительных сценариев отдела кадров. После создания нового соединителя HR выполните сценарий, используя идентификатор нового соединителя и CSV-файл с данными для дополнительных сценариев работы с персоналом.
