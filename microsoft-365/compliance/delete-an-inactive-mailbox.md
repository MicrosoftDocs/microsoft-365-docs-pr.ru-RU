---
title: Удаление неактивного почтового ящика
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: 9/5/2017
audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
ms.collection: M365-security-compliance
search.appverid:
- MOE150
- MET150
ms.assetid: f5caf497-5e8d-4b7a-bfff-d02942f38150
ms.custom:
- seo-marvel-apr2020
description: Если вам больше не нужно сохранять содержимое неактивного почтового ящика Microsoft 365, вы можете окончательно удалить неактивный почтовый ящик.
ms.openlocfilehash: 05357ce1b3e10394854844f15ec6a18c1c427d5b
ms.sourcegitcommit: 973f5449784cb70ce5545bc3cf57bf1ce5209218
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2020
ms.locfileid: "44817898"
---
# <a name="delete-an-inactive-mailbox"></a>Удаление неактивного почтового ящика

Неактивный почтовый ящик используется для хранения электронной почты бывшего сотрудника после увольнения. Если больше нет необходимости хранить контент неактивного почтового ящика, можно окончательно удалить его, выключив режим хранения. Кроме того, возможно, что к неактивному почтовому ящику применяются несколько инцидентов удержания. Например, неактивный почтовый ящик может находиться в режиме хранения для судебного разбирательства или хранения на месте. Кроме того, к неактивному почтовому ящику может применяться политика хранения (созданная в Центре безопасности и соответствия требованиям в Office 365 или Microsoft 365). Чтобы удалить неактивный почтовый ящик, необходимо удалить из неактивного почтового ящика все политики удержания и хранения. После удаления политик удержания и хранения неактивный почтовый ящик помечается для удаления и окончательно удаляется после его обработки.
  
> [!IMPORTANT]
> Так как мы продолжаем вкладывать средства в различные способы сохранения содержимого почтовых ящиков, мы объявляем о завершении In-Place в Центре администрирования Exchange. Это означает, что для создания неактивного почтового ящика следует использовать хранение для судебного разбирательства и политики хранения. С 1 июля 2020 г. вы не сможете создавать новые In-Place в Exchange Online. Но вы по-прежнему сможете изменить срок удержания In-Place неактивного почтового ящика. Однако с 1 октября 2020 г. изменить срок удержания будет нельзя. Удалить неактивный почтовый ящик можно только путем удаления In-Place удержания. Существующие неактивные почтовые ящики, которые находятся на In-Place удержания, будут по-прежнему сохраняться, пока удержание не будет снято. Дополнительные сведения об отоимлении In-Place, см. в поддомене "Вымещать устаревшие средства [eDiscovery".](legacy-ediscovery-retirement.md)
  
Описание того, что происходит после удаления инцидента удержания для неактивного почтового ящика, см. в статье [Дополнительные сведения](#more-information).
  
## <a name="before-you-delete-an-inactive-mailbox"></a>Перед удалением неактивного почтового ящика

- Чтобы отключить судебное удержание для неактивного почтового ящика, необходимо использовать Exchange Online PowerShell. Вы не можете сделать этого в Центре администрирования Exchange (EAC). Пошаговые инструкции см. в статье [Подключение к Exchange Online с помощью удаленной оболочки PowerShell](https://go.microsoft.com/fwlink/?linkid=396554). С помощью Exchange Online PowerShell или EAC можно удалить удержание In-Place неактивного почтового ящика. 
    
- Вы можете скопировать содержимое неактивного почтового ящика в другой почтовый ящик, прежде чем удалить инцидент удержания и сам почтовый ящик. Дополнительные сведения см. в сведениях о восстановлении [неактивного почтового ящика в Office 365.](restore-an-inactive-mailbox.md)
    
- Если вы удалите удержание или политику хранения из неактивного почтового ящика, а срок хранения для этого почтового ящика истек, почтовый ящик будет окончательно удален. После удаления его невозможно будет восстановить. Прежде чем удалять инцидент удержания, убедитесь, что вам больше не требуется содержимое почтового ящика. Если вы захотите повторно активировать неактивный почтовый ящик, его можно восстановить. Дополнительные сведения см. в сообщении ["Восстановление неактивного почтового ящика" в Office 365.](recover-an-inactive-mailbox.md)
    
- Дополнительные сведения о неактивных почтовых ящиках см. в сведениях о неактивных почтовых [ящиках в Office 365.](inactive-mailboxes-in-office-365.md)
    
## <a name="step-1-identify-the-holds-on-an-inactive-mailbox"></a>Этап 1. Определение инцидентов удержания для неактивного почтового ящика

Как было сказано ранее, к неактивному почтовому ящику может быть наложено хранение для судебного разбирательства, In-Place удержание или политика хранения. Первый шаг состоит в определении инцидентов удержания неактивного почтового ящика.
  
Выполните следующую команду, чтобы отобразить сведения об удержании для всех неактивных почтовых ящиков в организации.
  
```powershell
Get-Mailbox -InactiveMailboxOnly | FL DisplayName,Name,IsInactiveMailbox,LitigationHoldEnabled,InPlaceHolds
```

Значение **True** свойства **LitigationHoldEnabled** указывает, что неактивный почтовый ящик находится на хранении для судебного разбирательства. Если для неактивного почтового ящика включено хранение на месте, GUID удержания отображается как значение свойства **InPlaceHolds**. Например, в следующих результатах для двух неактивных почтовых ящиков видно, что хранение для судебного разбирательства включено для ящика Ann Beebe и что два инцидента хранения на месте применены к ящику Pilar Pinilla. 
  
```text
DisplayName           : Ann Beebe
Name                  : annb
IsInactiveMailbox     : True
LitigationHoldEnabled : True
InPlaceHolds          : {}
...
DisplayName           : Pilar Pinilla
Name                  : pilarp
IsInactiveMailbox     : True
LitigationHoldEnabled : False
InPlaceHolds          : {c0ba3ce811b6432a8751430937152491, ba6f4ba25b62490aaaa253eea27426ab}
```

> [!TIP]
> Если для неактивного почтового ящика применено множество инцидентов хранения на месте, будут показаны не все идентификаторы GUID хранения. Чтобы отобразить все In-Place GUID для удержания, можно выполнить следующую команду:  `Get-Mailbox -InactiveMailboxOnly -Identity <identity of inactive mailbox> | Select-Object -ExpandProperty InPlaceHolds`
  
## <a name="step-2-remove-a-hold-from-an-inactive-mailbox"></a>Действие 2. Удаление инцидента удержания неактивного почтового ящика

После определения типа удержания или количества инцидентов удержания для неактивного почтового ящика следующий шаг  снятие удержаний. Как указывалось ранее, вам необходимо удалить все инциденты удержания, чтобы окончательно удалить неактивный почтовый ящик. 
  
### <a name="remove-a-litigation-hold"></a>Отключение хранения для судебного разбирательства

Как было сказано выше, необходимо отключить режим хранения для судебного разбирательства для неактивного почтового ящика с помощью Windows PowerShell. Для этого не может использоваться EAC. Выполните следующую команду, чтобы отключить хранение для судебного разбирательства.
  
```powershell
Set-Mailbox -InactiveMailbox -Identity <identity of inactive mailbox> -LitigationHoldEnabled $false
```

> [!TIP]
> Лучший способ идентификации неактивного почтового ящика — использовать его различающееся имя или идентификатор GUID Exchange. Используя одно из этих значений, вы не укажете по ошибке неверный почтовый ящик. 
  
### <a name="remove-in-place-holds"></a>Отключение хранения на месте

 Отключить хранение на месте для неактивного почтового ящика можно двумя способами: 
  
- **Удаление объекта In-Place hold** Если неактивный почтовый ящик, который вы хотите окончательно удалить, является единственным исходным почтовым ящиком для удержания In-Place, вы можете просто удалить In-Place удержания. 
    
    > [!NOTE]
    > Перед этим необходимо отключить хранение на месте. При попытке удаления объекта с включенным хранением на месте появится сообщение об ошибке. 
  
- **Удалить неактивный почтовый ящик как исходный почтовый ящик хранения на месте**. Если вы хотите сохранить другие исходные почтовые ящики для хранения на месте, можно удалить неактивный почтовый ящик из списка исходных почтовых ящиков и сохранить объект хранения на месте. 
    
#### <a name="use-the-eac-to-delete-an-in-place-hold"></a>Использование Центра администрирования Exchange для отключения хранения на месте

1. Если вы знаете имя хранения на месте, которое требуется удалить, можно перейти к следующему шагу. В противном случае выполните следующую команду, чтобы получить имя хранения на месте, назначенного неактивному почтовому ящику, который требуется удалить. Используйте GUID хранения на месте, полученный в [Действие 1. Определение инцидентов удержания для неактивного почтового ящика](#step-1-identify-the-holds-on-an-inactive-mailbox).
    
   ```powershell
   Get-MailboxSearch -InPlaceHoldIdentity <In-Place Hold GUID> | FL Name
   ```

2. In the EAC, go to **Compliance management** \> **In-Place eDiscovery &amp; Hold**.
    
3. Выберите In-Place удержания, который нужно удалить,  и нажмите значок ![ ](../media/ebd260e4-3556-4fb0-b0bb-cc489773042c.gif) редактирования.
    
4. On the **In-Place eDiscovery &amp; Hold** properties page, click **In-Place Hold**, uncheck the **Place content matching the search query in selected mailboxes on hold** box, and then click **Save**.
    
5. On the **In-Place eDiscovery &amp; Hold** page, select the In-Place Hold again, and then click **Delete**![Delete icon](../media/87565fbb-5147-4f22-9ed7-1c18ce664392.png).
    
6. В окне предупреждения щелкните **Да**, чтобы удалить инцидент хранения на месте. 
    
#### <a name="use-exchange-online-powershell-to-delete-an-in-place-hold"></a>Удаление удержания In-Place Exchange Online PowerShell

1. Создайте переменную, содержащую свойства инцидента хранения на месте, который требуется удалить. Используйте GUID хранения на месте, полученный в [Действие 1. Определение инцидентов удержания для неактивного почтового ящика](#step-1-identify-the-holds-on-an-inactive-mailbox).
    
   ```powershell
   $InPlaceHold = Get-MailboxSearch -InPlaceHoldIdentity <In-Place Hold GUID>
   ```

2. Отключите хранение на месте.
    
   ```powershell
   Set-MailboxSearch $InPlaceHold.Name -InPlaceHoldEnabled $false
   ```

3. Затем удалите инцидент хранения на месте.
    
   ```powershell
   Remove-MailboxSearch $InPlaceHold.Name
   ```

#### <a name="use-the-eac-to-remove-an-inactive-mailbox-from-an-in-place-hold"></a>Использование Центра администрирования Exchange для отключения хранения на месте неактивного почтового ящика

1. Если вы знаете имя инцидента хранения на месте для неактивного почтового ящика, можно перейти к следующему шагу. В противном случае выполните следующую команду, чтобы получить имя. Используйте GUID хранения на месте, полученный в [Действие 1. Определение инцидентов удержания для неактивного почтового ящика](#step-1-identify-the-holds-on-an-inactive-mailbox).
    
   ```powershell
   Get-MailboxSearch -InPlaceHoldIdentity <In-Place Hold GUID> | FL Name
   ```

2. In the EAC, go to **Compliance management** \> **In-Place eDiscovery &amp; Hold**.
    
3. Выберите удержание In-Place, которое помещается на неактивный  почтовый ящик, и нажмите значок ![ редактирования. ](../media/ebd260e4-3556-4fb0-b0bb-cc489773042c.gif)
    
4. On the **In-Place eDiscovery &amp; Hold** properties page, click **Sources**.
    
5. В списке исходных почтовых ящиков щелкните имя неактивного почтового ящика, который требуется удалить, а затем нажмите кнопку **Удалить**![Значок "Удалить"](../media/adf01106-cc79-475c-8673-065371c1897b.gif).
    
6. Чтобы сохранить изменения, нажмите кнопку **Сохранить**. Появится сообщение о том, что операция успешно завершена. 
    
7. Повторите шаги с 1 по 6, чтобы удалить другие инциденты хранения на месте для неактивного почтового ящика.
    
#### <a name="use-exchange-online-powershell-to-remove-an-inactive-mailbox-from-an-in-place-hold"></a>Использование Exchange Online PowerShell для удаления неактивного почтового ящика из In-Place удержания

Если инцидент хранения на месте содержит большое количество исходных почтовых ящиков, возможно, что неактивный почтовый ящик не будет показан на странице **Источники** в Центре администрирования Exchange. При редактировании инцидента хранения на месте на странице **Источники** отображаются до 3000 почтовых ящиков. Если неактивный почтовый ящик не  указан на странице "Источники", вы можете удалить его из In-Place exchange Online PowerShell. 
  
1. Создайте переменную, содержащую свойства инцидента хранения на месте, примененного к неактивному почтовому ящику. Используйте GUID хранения на месте, полученный в [Действие 1. Определение инцидентов удержания для неактивного почтового ящика](#step-1-identify-the-holds-on-an-inactive-mailbox).
    
    ```powershell
    $InPlaceHold = Get-MailboxSearch -InPlaceHoldIdentity <In-Place Hold GUID>
    ```

2. Убедитесь, что неактивный почтовый ящик указан как исходный почтовый ящик для хранения на месте. 
    
   ```powershell
   $InPlaceHold.Sources
   ```

   **Примечание.** Свойство *Sources* удержания In-Place определяет исходные почтовые ящики по их свойствам *LegacyExchangeDN.* Поскольку это свойство уникально идентифицирует неактивные почтовые ящики, использование свойства *Sources* хранения на месте предотвращает удаление неверного почтового ящика. Это также позволяет избежать проблем, если у двух почтовых ящиков одинаковый псевдоним или SMTP-адрес. 
   
3. Удалите неактивный почтовый ящик из списка исходных почтовых ящиков в переменной. Обязательно используйте свойство **LegacyExchangeDN** неактивного почтового ящика, возвращаемое командой на предыдущем шаге. 
    
    ```powershell
    $InPlaceHold.Sources.Remove("<LegacyExchangeDN of the inactive mailbox>")
    ```

    Например, следующая команда удаляет неактивный почтовый ящик для пользователя Pilar Pinilla.
    
    ```powershell
    $InPlaceHold.Sources.Remove("/o=contoso/ou=Exchange Administrative Group (FYDIBOHF23SPDLT)/cn=Recipients/ cn=9c8dfff651ec4908950f5df60cbbda06-pilarp")
    ```

4. Убедитесь, что неактивный почтовый ящик удален из списка исходных почтовых ящиков в переменной.
    
   ```powershell
   $InPlaceHold.Sources
   ```

5. Измените инцидент хранения на месте, используя обновленный список исходных почтовых ящиков, в который не входит неактивный почтовый ящик.
    
   ```powershell
   Set-MailboxSearch $InPlaceHold.Name -SourceMailboxes $InPlaceHold.Sources
   ```

6. Убедитесь, что неактивный почтовый ящик удален из списка исходных почтовых ящиков для хранения на месте.
    
   ```powershell
   Get-MailboxSearch $InPlaceHold.Name | FL Sources
   ```

## <a name="more-information"></a>Дополнительные сведения

- **Неактивный почтовый ящик  это тип обратимо удаленного почтового ящика.** В Exchange Online обратимо удаленный почтовый ящик  это удаленный ящик, который можно восстановить в течение определенного периода. Срок хранения обратимо удаленного почтового ящика в Exchange Online составляет 30 дней. Это значит, что почтовый ящик можно восстановить в течение 30 дней после обратимого удаления. Через 30 дней обратимо удаленный почтовый ящик помечается для окончательного удаления без возможности восстановления. 
    
- **Что произойдет после отключения удержания неактивного почтового ящика?** Почтовый ящик рассматривается как другие удаленные почтовые ящики и помечается для постоянного удаления по истечении 30-дневного периода хранения этого почтового ящика. Этот период хранения начинается с даты первого неактивного почтового ящика. Эта дата называется "мягко удаленной" датой, которая является датой удаления соответствующей учетной записи пользователя или при удалении почтового ящика Exchange Online с помощью **cmdlet Remove-Mailbox.** Дата мягкого удаления не является датой, в которую удаляется удержание. 
    
- **Неактивный почтовый ящик окончательно удаляется сразу после снятия с удержания?** Если неактивный почтовый ящик был обратимо удален более 30 дней назад, он не будет удален окончательно сразу после снятия с удержания. Почтовый ящик будет отмечен для окончательного удаления и удален при следующей обработке. 
    
- **Как период хранения обратимо удаленного почтового ящика влияет на неактивные почтовые ящики?** Если дата мягкого удаления неактивного почтового ящика превышает 30 дней до даты удаления удержания, почтовый ящик помечается для постоянного удаления. Но если дата обратимого удаления неактивного почтового ящика попадает в последние 30 дней и вы удалите инцидент удержания, почтовый ящик можно восстановить до истечения срока хранения обратимо удаленного почтового ящика. Подробные сведения см. в сведениях об удалении и восстановлении [почтовых ящиков пользователей в Exchange Online.](https://go.microsoft.com/fwlink/?linkid=856835) После истечения срока хранения обратимо удаленных почтовых ящиков вы можете восстановить неактивный почтовый ящик. Дополнительные сведения см. в сообщении ["Восстановление неактивного почтового ящика" в Office 365.](recover-an-inactive-mailbox.md)
    
- **Как отобразить сведения о неактивном почтовом ящике после снятия с удержания?** После снятия удержания и возврата неактивного почтового ящика в обратимый почтовый ящик он не возвращается с помощью параметра *InactiveMailboxOnly* с помощью параметра **Get-Mailbox.** Однако вы можете отобразить сведения о почтовом ящике с помощью команды **Get-Mailbox -SoftDeletedMailbox**. Например: 
    
  ```text
  Get-Mailbox -SoftDeletedMailbox -Identity pilarp | FL Name,Identity,LitigationHoldEnabled,In
  Placeholds,WhenSoftDeleted,IsInactiveMailbox
  Name                   : pilarp
  Identity               : Soft Deleted Objects\pilarp
  LitigationHoldEnabled  : False
  InPlaceHolds           : {}
  WhenSoftDeleted        : 10/30/2014 1:19:04 AM
  IsInactiveMailbox      : False
  ```

  В примере выше свойство *WhenSoftDeleted* определяет дату мягкого удаления, которая в данном примере — 30 октября 2014 г. Если этот неактивный почтовый ящик ранее был неактивным, для которого было удалено удержание, он будет окончательно удален через 30 дней после значения свойства *WhenSoftDeleted.* В этом случае почтовый ящик окончательно удаляется после 30 ноября 2014 г.

