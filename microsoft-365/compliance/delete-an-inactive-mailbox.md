---
title: Удаление неактивного почтового ящика
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
ms.collection: M365-security-compliance
search.appverid:
- MOE150
- MET150
ms.assetid: f5caf497-5e8d-4b7a-bfff-d02942f38150
ms.custom:
- seo-marvel-apr2020
description: Если вам больше не нужно сохранять содержимое Microsoft 365 неактивного почтового ящика, можно навсегда удалить неактивный почтовый ящик.
ms.openlocfilehash: 077a71bfdd82721e0992e5d14073aa037b7cfd1b
ms.sourcegitcommit: d3f8c69519c593b1580cfa7187ce085a99b8a846
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/30/2021
ms.locfileid: "52100828"
---
# <a name="delete-an-inactive-mailbox"></a>Удаление неактивного почтового ящика

Неактивный почтовый ящик используется для сохранения электронной почты бывшего сотрудника после того, как он покинет организацию. Если больше нет необходимости хранить контент неактивного почтового ящика, можно окончательно удалить его, выключив режим хранения. Кроме того, возможно, что к неактивному почтовому ящику применяются несколько инцидентов удержания. Например, неактивный почтовый ящик может находиться в режиме хранения для судебного разбирательства или хранения на месте. Кроме того, к неактивному почтовому ящику может применяться политика хранения (созданная в центре безопасности и соответствия требованиям Office 365 или Microsoft 365). Чтобы удалить его, необходимо удалить все политики хранения и хранения из неактивного почтового ящика. После удаления политик хранения и хранения неактивный почтовый ящик помечается для удаления и удаляется после обработки.
  
> [!IMPORTANT]
> По мере того как мы продолжаем инвестировать в различные способы сохранения контента почтовых ящиков, мы объявляем об уходе In-Place в центре администрирования Exchange. Это означает, что для создания неактивного почтового ящика необходимо использовать политики хранения и хранения для судебного разбирательства. С 1 июля 2020 г. вы не сможете создавать новые In-Place в Exchange Online. Но вы все равно сможете изменить продолжительность удержания In-Place, размещенного на неактивном почтовом ящике. Однако с 1 октября 2020 г. вы не сможете изменить продолжительность удержания. Удалить неактивный почтовый ящик можно только путем удаления In-Place Hold. Существующие неактивные почтовые ящики, In-Place удержание, будут сохраняться до удаления удержания. Дополнительные сведения об уходе из In-Place содержится в см. в In-Place устаревших средств [eDiscovery.](legacy-ediscovery-retirement.md)
  
Описание того, что происходит после удаления инцидента удержания для неактивного почтового ящика, см. в статье [Дополнительные сведения](#more-information).
  
## <a name="before-you-delete-an-inactive-mailbox"></a>Перед удалением неактивного почтового ящика

- Чтобы удалить удержание судебного разбирательства из неактивного почтового ящика, необходимо использовать Exchange Online PowerShell. Вы не можете сделать этого в Центре администрирования Exchange (EAC). Пошаговые инструкции см. в статье [Подключение к Exchange Online с помощью удаленной оболочки PowerShell](/powershell/exchange/connect-to-exchange-online-powershell).

- Вы можете скопировать содержимое неактивного почтового ящика в другой почтовый ящик, прежде чем удалить инцидент удержания и сам почтовый ящик. Дополнительные сведения см. [в материале Восстановление неактивного](restore-an-inactive-mailbox.md)почтового ящика в Office 365.

- Если вы удалите политику удержания или хранения из неактивного почтового ящика, а срок хранения почтового ящика с мягким удалением для почтового ящика истек, почтовый ящик будет окончательно удален. После удаления его невозможно будет восстановить. Прежде чем удалять инцидент удержания, убедитесь, что вам больше не требуется содержимое почтового ящика. Если вы хотите активировать неактивный почтовый ящик, его можно восстановить. Дополнительные сведения см. [в материале Восстановление неактивного почтового ящика в Office 365.](recover-an-inactive-mailbox.md)

- Дополнительные сведения о неактивных почтовых ящиках см. в [Office 365.](inactive-mailboxes-in-office-365.md)

## <a name="step-1-identify-the-holds-on-an-inactive-mailbox"></a>Этап 1. Определение инцидентов удержания для неактивного почтового ящика

Как уже говорилось ранее, политика удержания, In-Place хранения или хранения может быть размещена на неактивном почтовом ящике. Первый шаг состоит в определении инцидентов удержания неактивного почтового ящика.
  
Выполните следующую команду, чтобы отобразить сведения об удержании для всех неактивных почтовых ящиков в организации.
  
```powershell
Get-Mailbox -InactiveMailboxOnly | FL DisplayName,Name,IsInactiveMailbox,LitigationHoldEnabled,InPlaceHolds
```

Значение **True** свойства **LitigationHoldEnabled** указывает, что неактивный почтовый ящик находится на хранении для судебного разбирательства. Если для неактивного почтового ящика включено хранение на месте, GUID удержания отображается как значение свойства **InPlaceHolds**. Например, в следующих результатах для двух неактивных почтовых ящиков покажут, что в Ann Beebe размещено удержание судебного разбирательства и что политика хранения и хранения In-Place для Pilar Pinilla.
  
```text
DisplayName           : Ann Beebe
Name                  : annb
IsInactiveMailbox     : True
LitigationHoldEnabled : True
InPlaceHolds          : {}
...
DisplayName           : Pilar Pinilla
Name                  : pilarp
IsInactiveMailbox     : True
LitigationHoldEnabled : False
InPlaceHolds          : {c0ba3ce811b6432a8751430937152491, mbxba6f4ba25b62490aaaa253eea27426ab}
```

> [!TIP]
> Если на неактивном почтовом ящике In-Place много политик хранения или удержания, не все In-Place GUID hold будут отображаться. Для отображения всех GUID-объектов в свойстве InPlaceHolds можно выполнить следующую команду:  `Get-Mailbox -InactiveMailboxOnly -Identity <identity of inactive mailbox> | Select-Object -ExpandProperty InPlaceHolds`
  
Дополнительные сведения о выявлении удержаний см. в [сообщении How to identify the type of hold placed on a mailbox.](identify-a-hold-on-an-exchange-online-mailbox.md)

## <a name="step-2-remove-a-hold-from-an-inactive-mailbox"></a>Действие 2. Удаление инцидента удержания неактивного почтового ящика

После определения типа удержания или количества инцидентов удержания для неактивного почтового ящика следующий шаг  снятие удержаний. Как указывалось ранее, вам необходимо удалить все инциденты удержания, чтобы окончательно удалить неактивный почтовый ящик.
  
### <a name="remove-a-litigation-hold"></a>Отключение хранения для судебного разбирательства

Как было сказано выше, необходимо отключить режим хранения для судебного разбирательства для неактивного почтового ящика с помощью Windows PowerShell. Для этого не может использоваться EAC. Выполните следующую команду, чтобы отключить хранение для судебного разбирательства.
  
```powershell
Set-Mailbox -InactiveMailbox -Identity <identity of inactive mailbox> -LitigationHoldEnabled $false
```

> [!TIP]
> Лучший способ идентификации неактивного почтового ящика  использовать его различающееся имя или идентификатор GUID Exchange. Используя одно из этих значений, вы не укажете по ошибке неверный почтовый ящик. 
  
### <a name="remove-an-inactive-mailbox-from-a-retention-policy"></a>Удаление неактивного почтового ящика из политики хранения

Процедура удаления неактивного почтового ящика из политики хранения Microsoft 365 зависит от того, является ли политика хранения, назначенная неактивному почтовому ящику, широкой организацией или явной. о типе политики хранения, назначенной неактивному почтовому ящику.

- Политики хранения для всей организации, присвоенные всем почтовым ящикам организации. Чтобы получить **сведения** о политиках хранения в организации, используйте в Exchange Online PowerShell.

- Определенные политики хранения расположения, присвоенные определенным почтовым ящикам. Это политики, которые назначены расположениям контента определенных пользователей. Чтобы получить сведения о политиках хранения, присвоенных определенным неактивным почтовым ящикам, используйте в Exchange Online PowerShell комлет **Get-Mailbox -IncludeInactiveMailbox.**

#### <a name="remove-an-inactive-mailbox-from-an-organization-wide-retention-policy"></a>Удаление неактивного почтового ящика из политики хранения всей организации

Запустите следующую команду в Exchange Online PowerShell, чтобы исключить неактивный почтовый ящик из политики хранения по всей организации.

```powershell
Set-Mailbox <identity of inactive mailbox> -ExcludeFromOrgHolds <retention policy GUID without prefix or suffix>
```

Дополнительные сведения о политиках хранения для всей организации, применяемых к неактивному почтовому ящику, и получении GUID [](identify-a-hold-on-an-exchange-online-mailbox.md#get-organizationconfig)для политики хранения см. в разделе "Get-OrganizationConfig" в разделе Как определить тип удержания, размещенного на почтовом ящике.

Кроме того, можно выполнить следующую команду, чтобы удалить неактивный почтовый ящик из всех политик всей организации:

```powershell
Set-Mailbox <identity of inactive mailbox> -ExcludeFromAllOrgHolds
```

#### <a name="remove-an-inactive-mailbox-from-a-specific-location-retention-policy"></a>Удаление неактивного почтового ящика из определенной политики хранения местоположения

Запустите следующую команду в [центре & PowerShell,](/powershell/exchange/connect-to-scc-powershell) чтобы удалить неактивный почтовый ящик из явной политики хранения.

```powershell
Set-RetentionCompliancePolicy -Identity <retention policy GUID without prefix or suffix> -AddExchangeLocationException <identity of inactive mailbox>
```

Дополнительные сведения о конкретных политиках хранения расположения, применяемых к неактивному почтовому ящику, и получении GUID для политики хранения см. в разделе "Get-Mailbox" в разделе Как определить тип удержания, размещенного на почтовом [ящике.](identify-a-hold-on-an-exchange-online-mailbox.md#get-mailbox)

### <a name="remove-in-place-holds"></a>Отключение хранения на месте

 Отключить хранение на месте для неактивного почтового ящика можно двумя способами: 
  
- **Удаление объекта In-Place Hold**. Если неактивный почтовый ящик, который необходимо окончательно удалить, является единственным исходным почтовым ящиком для In-Place Hold, можно просто удалить объект In-Place Hold. 

    > [!NOTE]
    > Перед этим необходимо отключить хранение на месте. При попытке удаления объекта с включенным хранением на месте появится сообщение об ошибке. 
  
- **Удалите неактивный почтовый ящик** в качестве источника почтового ящика In-Place hold . Если вы хотите сохранить другие исходные почтовые ящики для хранения на месте, можно удалить неактивный почтовый ящик из списка исходных почтовых ящиков и сохранить объект хранения на месте.

#### <a name="delete-an-in-place-hold"></a>Удаление In-Place удержания

1. Создайте переменную, содержащую свойства инцидента хранения на месте, который требуется удалить. Используйте GUID хранения на месте, полученный в [Действие 1. Определение инцидентов удержания для неактивного почтового ящика](#step-1-identify-the-holds-on-an-inactive-mailbox).

   ```powershell
   $InPlaceHold = Get-MailboxSearch -InPlaceHoldIdentity <In-Place Hold GUID>
   ```

2. Отключите хранение на месте.

   ```powershell
   Set-MailboxSearch $InPlaceHold.Name -InPlaceHoldEnabled $false
   ```

3. Затем удалите инцидент хранения на месте.

   ```powershell
   Remove-MailboxSearch $InPlaceHold.Name
   ```

#### <a name="remove-an-inactive-mailbox-from-an-in-place-hold"></a>Удаление неактивного почтового ящика из In-Place Hold

Если инцидент хранения на месте содержит большое количество исходных почтовых ящиков, возможно, что неактивный почтовый ящик не будет показан на странице **Источники** в Центре администрирования Exchange. При редактировании инцидента хранения на месте на странице **Источники** отображаются до 3000 почтовых ящиков. Если неактивный почтовый ящик не  указан на странице Источники, вы можете использовать Exchange Online PowerShell, чтобы удалить его из In-Place Hold. 
  
1. Создайте переменную, содержащую свойства инцидента хранения на месте, примененного к неактивному почтовому ящику. Используйте GUID хранения на месте, полученный в [Действие 1. Определение инцидентов удержания для неактивного почтового ящика](#step-1-identify-the-holds-on-an-inactive-mailbox).

    ```powershell
    $InPlaceHold = Get-MailboxSearch -InPlaceHoldIdentity <In-Place Hold GUID>
    ```

2. Убедитесь, что неактивный почтовый ящик указан как исходный почтовый ящик для хранения на месте. 

   ```powershell
   $InPlaceHold.Sources
   ```

   > [!NOTE]
   > Свойство *Sources* хранения на месте определяет исходные почтовые ящики по свойству *LegacyExchangeDN*. Поскольку это свойство уникально идентифицирует неактивные почтовые ящики, использование свойства *Sources* хранения на месте предотвращает удаление неверного почтового ящика. Это также позволяет избежать проблем, если у двух почтовых ящиков одинаковый псевдоним или SMTP-адрес. 

3. Удалите неактивный почтовый ящик из списка исходных почтовых ящиков в переменной. Обязательно используйте свойство **LegacyExchangeDN** неактивного почтового ящика, возвращаемое командой на предыдущем шаге. 

    ```powershell
    $InPlaceHold.Sources.Remove("<LegacyExchangeDN of the inactive mailbox>")
    ```

    Например, следующая команда удаляет неактивный почтовый ящик для пользователя Pilar Pinilla.

    ```powershell
    $InPlaceHold.Sources.Remove("/o=contoso/ou=Exchange Administrative Group (FYDIBOHF23SPDLT)/cn=Recipients/ cn=9c8dfff651ec4908950f5df60cbbda06-pilarp")
    ```

4. Убедитесь, что неактивный почтовый ящик удален из списка исходных почтовых ящиков в переменной.

   ```powershell
   $InPlaceHold.Sources
   ```

5. Измените инцидент хранения на месте, используя обновленный список исходных почтовых ящиков, в который не входит неактивный почтовый ящик.

   ```powershell
   Set-MailboxSearch $InPlaceHold.Name -SourceMailboxes $InPlaceHold.Sources
   ```

6. Убедитесь, что неактивный почтовый ящик удален из списка исходных почтовых ящиков для хранения на месте.

   ```powershell
   Get-MailboxSearch $InPlaceHold.Name | FL Sources
   ```

## <a name="more-information"></a>Дополнительные сведения

- **Неактивный почтовый ящик  это тип обратимо удаленного почтового ящика.** В Exchange Online обратимо удаленный почтовый ящик  это удаленный ящик, который можно восстановить в течение определенного периода. Ранее неактивный почтовый ящик будет доступен в качестве мягкого удаленного почтового ящика в Exchange Online 183 дня. Это означает, что почтовый ящик можно восстановить в течение 183 дней после мягкого удаления. Через 183 дня удаленный электронный почтовый ящик помечен для постоянного удаления и не может быть восстановлен.

- **Что происходит после удаления удержания на неактивном почтовом ящике?** Почтовый ящик рассматривается, как и другие удаленные электронные почтовые ящики, и по истечении 183-дневного периода хранения электронных почтовых ящиков помечен для постоянного удаления. Этот период хранения начинается с даты первого неактивного действия почтового ящика. Эта дата называется датой мягкого удаления, которая является датой удаления соответствующей учетной записи пользователя или удалением почтового ящика Exchange Online с помощью cmdlet **Remove-Mailbox.** Дата мягкого удаления не является датой удаления удержания.

- **Неактивный почтовый ящик окончательно удаляется сразу после снятия с удержания?** Ранее неактивный почтовый ящик будет доступен в состоянии мягкого удаления в течение 183 дней. Через 183 дня почтовый ящик будет помечен для постоянного удаления.

- **Как отобразить сведения о неактивном почтовом ящике после снятия с удержания?** После удаления удержания и возврата неактивного почтового ящика в электронный удаленный почтовый ящик он не возвращается с помощью параметра *InactiveMailboxOnly* с помощью cmdlet **Get-Mailbox.** Однако вы можете отобразить сведения о почтовом ящике с помощью команды **Get-Mailbox -SoftDeletedMailbox**. Например:

  ```text
  Get-Mailbox -SoftDeletedMailbox -Identity pilarp | FL Name,Identity,LitigationHoldEnabled,In
  Placeholds,WhenSoftDeleted,IsInactiveMailbox,WasInactiveMailbox,InactiveMailboxRetireTime
  Name                   : pilarp
  Identity               : Soft Deleted Objects\pilarp
  LitigationHoldEnabled  : False
  InPlaceHolds           : {}
  WhenSoftDeleted        : 6/16/2020 1:19:04 AM
  IsInactiveMailbox      : False
  WasInactiveMailbox     : True
  InactiveMailboxRetireTime : 9/30/2020 11:16:23 PM
  ```

  В вышеуказанной примере свойство *WhenSoftDeleted* определяет дату мягкого удаления, которая в этом примере — 16 июня 2020 г. Свойство *WasInactiveMailbox* перечислены как потому, что ранее оно было `True` неактивным почтовым ящиком. Почтовый ящик будет окончательно удален через 183 дня после 30 сентября 2020 г.

