---
title: Использование аудита общего доступа в журнале аудита
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- SPO160
- MOE150
- BCS160
- MET150
ms.collection:
- M365-security-compliance
- SPO_Content
ms.assetid: 50bbf89f-7870-4c2a-ae14-42635e0cfc01
description: Администратор может узнать, как использовать аудит общего доступа в журнале аудита Microsoft 365, чтобы определить ресурсы, доступ к которым предоставлен пользователям вне Организации.
ms.custom: seo-marvel-apr2020
ms.openlocfilehash: d26a8022f8d59aeb56a03c50ae546777c882ef7a
ms.sourcegitcommit: 973f5449784cb70ce5545bc3cf57bf1ce5209218
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2020
ms.locfileid: "44819299"
---
# <a name="use-sharing-auditing-in-the-audit-log"></a><span data-ttu-id="acca1-103">Использование аудита общего доступа в журнале аудита</span><span class="sxs-lookup"><span data-stu-id="acca1-103">Use sharing auditing in the audit log</span></span>

<span data-ttu-id="acca1-104">Общий доступ — это ключевое действие в SharePoint Online и OneDrive для бизнеса, которое широко используется в организациях.</span><span class="sxs-lookup"><span data-stu-id="acca1-104">Sharing is a key activity in SharePoint Online and OneDrive for Business, and it's widely used in organizations.</span></span> <span data-ttu-id="acca1-105">Администраторы могут использовать аудит общего доступа в журнале аудита, чтобы определить, как общий доступ используется в Организации.</span><span class="sxs-lookup"><span data-stu-id="acca1-105">Administrators can use sharing auditing in the audit log to determine how sharing is used in their organization.</span></span> 
  
## <a name="the-sharepoint-sharing-schema"></a><span data-ttu-id="acca1-106">Схема общего доступа SharePoint</span><span class="sxs-lookup"><span data-stu-id="acca1-106">The SharePoint Sharing schema</span></span>

<span data-ttu-id="acca1-107">События общего доступа (не включая события, связанные с общими политиками и ссылками для совместного доступа) отличаются от событий, связанных с файлами и папками, одним из основных способов: один пользователь выполняет действие, которое оказывает действие на другом пользователе.</span><span class="sxs-lookup"><span data-stu-id="acca1-107">Sharing events (not including events related to sharing policy and sharing links) are different from file- and folder-related events in one primary way: one user is performing an action that has an effect on another user.</span></span> <span data-ttu-id="acca1-108">Например, когда пользователь ресурса A предоставляет пользователю б доступ к файлу.</span><span class="sxs-lookup"><span data-stu-id="acca1-108">For example, when a resource User A gives User B access to a file.</span></span> <span data-ttu-id="acca1-109">В этом примере пользователь а является *действующим пользователем* , а пользователь б — *конечным пользователем*.</span><span class="sxs-lookup"><span data-stu-id="acca1-109">In this example, User A is the  *acting user*  and User B is the  *target user*.</span></span> <span data-ttu-id="acca1-110">В схеме файлов SharePoint действие действующего пользователя влияет только на сам файл.</span><span class="sxs-lookup"><span data-stu-id="acca1-110">In the SharePoint File schema, the acting user's action only affects the file itself.</span></span> <span data-ttu-id="acca1-111">Когда пользователь а открывает файл, в событии **филеакцессед** требуются только сведения о действующем пользователе.</span><span class="sxs-lookup"><span data-stu-id="acca1-111">When User A opens a file, the only information needed in the **FileAccessed** event is the acting user.</span></span> <span data-ttu-id="acca1-112">Чтобы устранить это различие, существует отдельная схема, называемая *схемой общего доступа SharePoint*, которая захватывает дополнительные сведения о событиях общего доступа.</span><span class="sxs-lookup"><span data-stu-id="acca1-112">To address this difference, there is a separate schema, called the  *SharePoint Sharing schema*, that captures more information about sharing events.</span></span> <span data-ttu-id="acca1-113">Это гарантирует, что администраторы могут видеть, кто предоставил общий доступ к ресурсу, а также к пользователю, к которому предоставлен общий доступ к ресурсу.</span><span class="sxs-lookup"><span data-stu-id="acca1-113">This ensures that administrators have visibility into who shared a resource and the user the resource was shared with.</span></span> 
  
<span data-ttu-id="acca1-114">Схема общего доступа предоставляет два дополнительных поля в записи аудита, связанные с событиями общего доступа:</span><span class="sxs-lookup"><span data-stu-id="acca1-114">The Sharing schema provides two additional fields in an audit record related to sharing events:</span></span> 
  
- <span data-ttu-id="acca1-115">**Таржетусерорграуптипе:** Определяет, является ли целевой пользователь или группа участником, гостем, Шарепоинтграуп, SecurityGroup или партнером.</span><span class="sxs-lookup"><span data-stu-id="acca1-115">**TargetUserOrGroupType:** Identifies whether the target user or group is a Member, Guest, SharePointGroup, SecurityGroup, or Partner.</span></span>

- <span data-ttu-id="acca1-116">**Таржетусерорграупнаме:** Сохранение имени участника-пользователя или группы, которым предоставлен общий доступ к ресурсу (пользователь б в предыдущем примере).</span><span class="sxs-lookup"><span data-stu-id="acca1-116">**TargetUserOrGroupName:** Stores the UPN or name of the target user or group that a resource was shared with (User B in the previous example).</span></span> 

<span data-ttu-id="acca1-117">Эти два поля в дополнение к другим свойствам из схемы журнала аудита, таким как User, Operation и Date, могут сообщить полное описание *того* *, какой* пользователь предоставил ресурс, с *которым* и *когда*.</span><span class="sxs-lookup"><span data-stu-id="acca1-117">These two fields, in addition to other properties from the audit log schema such as User, Operation, and Date can tell the full story about  *which*  user shared  *what*  resource with  *whom*  and  *when*.</span></span> 
  
<span data-ttu-id="acca1-118">Существует еще одно свойство схемы, которое важно для общего описания.</span><span class="sxs-lookup"><span data-stu-id="acca1-118">There's another schema property that's important to the sharing story.</span></span> <span data-ttu-id="acca1-119">При экспорте результатов поиска в журнале аудита в столбце **аудитдата** в ЭКСПОРТИРУЕМом CSV-файле хранятся сведения о событиях общего доступа.</span><span class="sxs-lookup"><span data-stu-id="acca1-119">When you export audit log search results, the **AuditData** column in the exported CSV file stores information about sharing events.</span></span> <span data-ttu-id="acca1-120">Например, если пользователь предоставляет доступ к сайту другому пользователю, это достигается путем добавления конечного пользователя в группу SharePoint.</span><span class="sxs-lookup"><span data-stu-id="acca1-120">For example, when a user shares a site with another user, this is accomplished by adding the target user to a SharePoint group.</span></span> <span data-ttu-id="acca1-121">В столбце **аудитдата** эта информация захватывается для предоставления контекста администраторам.</span><span class="sxs-lookup"><span data-stu-id="acca1-121">The **AuditData** column captures this information to provide context for administrators.</span></span> <span data-ttu-id="acca1-122">Инструкции по анализу сведений в столбце **аудитдата** приведены в [шаге 2](#step-2-use-the-powerquery-editor-to-format-the-exported-audit-log) .</span><span class="sxs-lookup"><span data-stu-id="acca1-122">See [Step 2](#step-2-use-the-powerquery-editor-to-format-the-exported-audit-log) for instructions on how to parse the information in the **AuditData** column.</span></span>

## <a name="sharepoint-sharing-events"></a><span data-ttu-id="acca1-123">События общего доступа к SharePoint</span><span class="sxs-lookup"><span data-stu-id="acca1-123">SharePoint sharing events</span></span>

<span data-ttu-id="acca1-124">Общий доступ определяется, когда пользователь ( *действующий* пользователь) хочет предоставить ресурс другому пользователю ( *конечному* пользователю).</span><span class="sxs-lookup"><span data-stu-id="acca1-124">Sharing is defined by when a user (the *acting* user) wants to share a resource with another user (the *target* user).</span></span> <span data-ttu-id="acca1-125">Записи аудита, связанные с предоставлением общего доступа к ресурсу с внешним пользователем (пользователь, который находится за пределами вашей организации и не имеет гостевой учетной записи в Azure Active Directory), идентифицируются по следующим событиям, которые регистрируются в журнале аудита:</span><span class="sxs-lookup"><span data-stu-id="acca1-125">Audit records related to sharing a resource with an external user (a user who is outside of your organization and doesn't have a guest account in your organization's Azure Active Directory) are identified by the following events, which are logged in the audit log:</span></span>

- <span data-ttu-id="acca1-126">**Шарингинвитатионкреатед:** Пользователь в Организации попытался предоставить общий доступ к ресурсу (вероятно, к сайту) с внешним пользователем.</span><span class="sxs-lookup"><span data-stu-id="acca1-126">**SharingInvitationCreated:** A user in your organization tried to share a resource (likely a site) with an external user.</span></span> <span data-ttu-id="acca1-127">В результате внешнее приглашение к совместному использованию отправляется конечному пользователю.</span><span class="sxs-lookup"><span data-stu-id="acca1-127">This results in an external sharing invitation sent to the target user.</span></span> <span data-ttu-id="acca1-128">В данный момент доступ к ресурсу не предоставляется.</span><span class="sxs-lookup"><span data-stu-id="acca1-128">No access to the resource is granted at this point.</span></span>

- <span data-ttu-id="acca1-129">**Шарингинвитатионакцептед:** Внешний пользователь принял приглашение к совместному использованию, отправленное действующим пользователем, и теперь получил доступ к ресурсу.</span><span class="sxs-lookup"><span data-stu-id="acca1-129">**SharingInvitationAccepted:** The external user has accepted the sharing invitation sent by the acting user and now has access to the resource.</span></span>

- <span data-ttu-id="acca1-130">**Анонимауслинккреатед:** Для ресурса создается Анонимная ссылка (также называемая ссылкой "кому угодно").</span><span class="sxs-lookup"><span data-stu-id="acca1-130">**AnonymousLinkCreated:** An anonymous link (also called an "Anyone" link) is created for a resource.</span></span> <span data-ttu-id="acca1-131">Так как можно создать и скопировать анонимную ссылку, разумно предположить, что к любому документу, к которому применена Анонимная ссылка, предоставлен доступ конечному пользователю.</span><span class="sxs-lookup"><span data-stu-id="acca1-131">Because an anonymous link can be created and then copied, it's reasonable to assume that any document that has an anonymous link has been shared with a target user.</span></span>

- <span data-ttu-id="acca1-132">**Анонимауслинкусед:** Как следует из названия, это событие записывается в журнал при использовании анонимной ссылки для доступа к ресурсу.</span><span class="sxs-lookup"><span data-stu-id="acca1-132">**AnonymousLinkUsed:** As the name implies, this event is logged when an anonymous link is used to access a resource.</span></span> 

- <span data-ttu-id="acca1-133">**Секурелинккреатед:** Пользователь создал ссылку "определенные пользователи" для предоставления общего доступа к ресурсу определенному человеку.</span><span class="sxs-lookup"><span data-stu-id="acca1-133">**SecureLinkCreated:** A user has created a "specific people link" to share a resource with a specific person.</span></span> <span data-ttu-id="acca1-134">Конечный пользователь может быть пользователем, который является внешним по отношению к вашей организации.</span><span class="sxs-lookup"><span data-stu-id="acca1-134">This target user may be someone who is external to your organization.</span></span> <span data-ttu-id="acca1-135">Лицо, которому предоставлен общий доступ к ресурсу, определено в записи аудита для события **аддедтосекурелинк** .</span><span class="sxs-lookup"><span data-stu-id="acca1-135">The person that the resource is shared with is identified in the audit record for the **AddedToSecureLink** event.</span></span> <span data-ttu-id="acca1-136">Метки времени для этих двух событий практически идентичны.</span><span class="sxs-lookup"><span data-stu-id="acca1-136">The time stamps for these two events are nearly identical.</span></span>

- <span data-ttu-id="acca1-137">**Аддедтосекурелинк:** Пользователь добавлен в определенную ссылку "люди".</span><span class="sxs-lookup"><span data-stu-id="acca1-137">**AddedToSecureLink:** A user was added to a specific people link.</span></span> <span data-ttu-id="acca1-138">Используйте поле **таржетусерорграупнаме** в этом событии, чтобы определить пользователя, добавленного в соответствующую ссылку на пользователей.</span><span class="sxs-lookup"><span data-stu-id="acca1-138">Use the **TargetUserOrGroupName** field in this event to identify the user added to the corresponding specific people link.</span></span> <span data-ttu-id="acca1-139">Конечный пользователь может быть пользователем, который является внешним по отношению к вашей организации.</span><span class="sxs-lookup"><span data-stu-id="acca1-139">This target user may be someone who is external to your organization.</span></span>

## <a name="sharing-auditing-work-flow"></a><span data-ttu-id="acca1-140">Общий доступ к рабочему процесс аудита</span><span class="sxs-lookup"><span data-stu-id="acca1-140">Sharing auditing work flow</span></span>
  
<span data-ttu-id="acca1-141">Когда пользователь (действующий пользователь) хочет предоставить доступ к ресурсу другому пользователю (конечному пользователю), SharePoint (или OneDrive для бизнеса), сначала проверяется, связан ли адрес электронной почты конечного пользователя с учетной записью пользователя в каталоге Организации.</span><span class="sxs-lookup"><span data-stu-id="acca1-141">When a user (the acting user) wants to share a resource with another user (the target user), SharePoint (or OneDrive for Business) first checks if the email address of the target user is already associated with a user account in the organization's directory.</span></span> <span data-ttu-id="acca1-142">Если целевой пользователь находится в каталоге (с соответствующей учетной записью пользователя гостя), SharePoint выполняет следующие действия:</span><span class="sxs-lookup"><span data-stu-id="acca1-142">If the target user is in the directory (and has a corresponding guest user account), SharePoint does the following things:</span></span>
  
-  <span data-ttu-id="acca1-143">Немедленно назначает разрешения конечного пользователя на доступ к ресурсу, добавляя конечного пользователя в соответствующую группу SharePoint и записывает событие **аддедтограуп** .</span><span class="sxs-lookup"><span data-stu-id="acca1-143">Immediately assigns the target user permissions to access the resource by adding the target user to the appropriate SharePoint group, and logs an **AddedToGroup** event.</span></span> 
    
- <span data-ttu-id="acca1-144">Отправляет уведомление о совместном доступе на адрес электронной почты целевого пользователя.</span><span class="sxs-lookup"><span data-stu-id="acca1-144">Sends a sharing notification to the email address of the target user.</span></span>
    
- <span data-ttu-id="acca1-145">Заносит в журнал событие **общего доступа** .</span><span class="sxs-lookup"><span data-stu-id="acca1-145">Logs a **SharingSet** event.</span></span> <span data-ttu-id="acca1-146">Это событие имеет понятное имя "общий файл, папка или сайт" в разделе **действия запросов на общий доступ и доступ** в средстве выбора действий средства поиска журнала аудита.</span><span class="sxs-lookup"><span data-stu-id="acca1-146">This event has a friendly name of "Shared file, folder, or site" under **Sharing and access request activities** in the activities picker of the audit log search tool.</span></span> <span data-ttu-id="acca1-147">На [шаге 1](#step-1-search-for-sharing-events-and-export-the-results-to-a-csv-file)Просмотрите снимок экрана.</span><span class="sxs-lookup"><span data-stu-id="acca1-147">See the screenshot in [Step 1](#step-1-search-for-sharing-events-and-export-the-results-to-a-csv-file).</span></span> 
    
<span data-ttu-id="acca1-148">Если учетная запись пользователя конечного пользователя не находится в каталоге, SharePoint выполняет следующие действия:</span><span class="sxs-lookup"><span data-stu-id="acca1-148">If a user account for the target user isn't in the directory, SharePoint does the following:</span></span> 
    
   - <span data-ttu-id="acca1-149">Записывает в журнал одно из следующих событий в зависимости от того, как общий доступ к ресурсу:</span><span class="sxs-lookup"><span data-stu-id="acca1-149">Logs one of the following events, based on how the resource is shared:</span></span>
   
      - <span data-ttu-id="acca1-150">**AnonymousLinkCreated**</span><span class="sxs-lookup"><span data-stu-id="acca1-150">**AnonymousLinkCreated**</span></span>
   
      - <span data-ttu-id="acca1-151">**SecureLinkCreated**</span><span class="sxs-lookup"><span data-stu-id="acca1-151">**SecureLinkCreated**</span></span>
   
      - <span data-ttu-id="acca1-152">**AddedToSecureLink**</span><span class="sxs-lookup"><span data-stu-id="acca1-152">**AddedToSecureLink**</span></span> 

      - <span data-ttu-id="acca1-153">**Шарингинвитатионкреатед** (это событие записывается в журнал, только когда общий ресурс является сайтом)</span><span class="sxs-lookup"><span data-stu-id="acca1-153">**SharingInvitationCreated** (this event is logged only when the shared resource is a site)</span></span>
    
   - <span data-ttu-id="acca1-154">Когда целевой пользователь принимает приглашение к совместному использованию, отправленное им (щелкнув ссылку в приглашении), SharePoint заносит в журнал событие **шарингинвитатионакцептед** и назначает целевому пользователю разрешения на доступ к ресурсу.</span><span class="sxs-lookup"><span data-stu-id="acca1-154">When the target user accepts the sharing invitation that's sent to them (by clicking the link in the invitation), SharePoint logs a **SharingInvitationAccepted** event and assigns the target user permissions to access the resource.</span></span> <span data-ttu-id="acca1-155">Если конечному пользователю отправляется Анонимная ссылка, событие **анонимауслинкусед** записывается после того, как целевой пользователь применяет ссылку для доступа к ресурсу.</span><span class="sxs-lookup"><span data-stu-id="acca1-155">If the target user is sent an anonymous link, the **AnonymousLinkUsed** event is logged after the target user uses the link to access the resource.</span></span> <span data-ttu-id="acca1-156">Для безопасных ссылок событие **филеакцессед** записывается, когда внешний пользователь использует ссылку для доступа к ресурсу.</span><span class="sxs-lookup"><span data-stu-id="acca1-156">For secure links, a **FileAccessed** event is logged when an external user uses the link to access the resource.</span></span>

<span data-ttu-id="acca1-157">Кроме того, регистрируется дополнительная информация о целевом пользователе, например идентификатор пользователя, которому будет предложено приглашение, и пользователя, который принимает приглашение.</span><span class="sxs-lookup"><span data-stu-id="acca1-157">Additional information about the target user is also logged, such as the identity of the user the invitation is to and the user who accepts the invitation.</span></span> <span data-ttu-id="acca1-158">В некоторых случаях эти пользователи (или адреса электронной почты) могут различаться.</span><span class="sxs-lookup"><span data-stu-id="acca1-158">In some case, these users (or email addresses) can be different.</span></span> 

## <a name="how-to-identify-resources-shared-with-external-users"></a><span data-ttu-id="acca1-159">Как определить ресурсы, к которым предоставлен доступ внешним пользователям</span><span class="sxs-lookup"><span data-stu-id="acca1-159">How to identify resources shared with external users</span></span>

<span data-ttu-id="acca1-160">Для администраторов распространенным требованием является создание списка всех ресурсов, к которым предоставлен доступ пользователям за преданной Организацией.</span><span class="sxs-lookup"><span data-stu-id="acca1-160">A common requirement for administrators is creating a list of all resources that have been shared with users outside of the organization.</span></span> <span data-ttu-id="acca1-161">С помощью аудита общего доступа в Office 365 администраторы могут создать этот список.</span><span class="sxs-lookup"><span data-stu-id="acca1-161">By using sharing auditing in Office 365, administrators can generate this list.</span></span> <span data-ttu-id="acca1-162">Ниже приведено описание процедуры.</span><span class="sxs-lookup"><span data-stu-id="acca1-162">Here's how.</span></span>
  
### <a name="step-1-search-for-sharing-events-and-export-the-results-to-a-csv-file"></a><span data-ttu-id="acca1-163">Шаг 1: Поиск событий общего доступа и экспорт результатов в CSV-файл</span><span class="sxs-lookup"><span data-stu-id="acca1-163">Step 1: Search for sharing events and export the results to a CSV file</span></span>

<span data-ttu-id="acca1-164">Первый шаг — Поиск событий общего доступа в журнале аудита.</span><span class="sxs-lookup"><span data-stu-id="acca1-164">The first step is to search the audit log for sharing events.</span></span> <span data-ttu-id="acca1-165">Дополнительные сведения (в том числе необходимые разрешения), связанные с поиском в журнале аудита, можно найти в статье [Поиск в журнале аудита в центре безопасности & соответствия требованиям](search-the-audit-log-in-security-and-compliance.md).</span><span class="sxs-lookup"><span data-stu-id="acca1-165">For more information (including the required permissions) about searching the audit log, see [Search the audit log in the Security & Compliance Center](search-the-audit-log-in-security-and-compliance.md).</span></span>
  
1. <span data-ttu-id="acca1-166">Перейдите по ссылке [https://protection.office.com](https://protection.office.com).</span><span class="sxs-lookup"><span data-stu-id="acca1-166">Go to [https://protection.office.com](https://protection.office.com).</span></span>
    
2. <span data-ttu-id="acca1-167">Выполните вход с помощью рабочей или учебной учетной записи.</span><span class="sxs-lookup"><span data-stu-id="acca1-167">Sign in using your work or school account.</span></span>
    
3. <span data-ttu-id="acca1-168">В левой панели центра безопасности & центр соответствия требованиям выберите **Поиск**  > **Поиск по журналу аудита**.</span><span class="sxs-lookup"><span data-stu-id="acca1-168">In the left pane of the Security & Compliance Center, click **Search**  > **Audit log search**.</span></span>
    
    <span data-ttu-id="acca1-169">Откроется страница **Поиск в журнале аудита**.</span><span class="sxs-lookup"><span data-stu-id="acca1-169">The **Audit log search** page is displayed.</span></span> 
    
4. <span data-ttu-id="acca1-170">В разделе **действия**щелкните **действия общего доступа и доступа к запросам** на поиск событий, связанных с общим доступом.</span><span class="sxs-lookup"><span data-stu-id="acca1-170">Under **Activities**, click **Sharing and access request activities** to search for sharing-related events.</span></span> 
    
    ![В разделе действия выберите действия общего доступа и запросов на доступ](../media/46bb25b7-1eb2-4adf-903a-cc9ab58639f9.png)
  
5.  <span data-ttu-id="acca1-172">Выберите диапазон дат и времени, чтобы найти события общего доступа, произошедшие в течение этого периода.</span><span class="sxs-lookup"><span data-stu-id="acca1-172">Select a date and time range to find the sharing events that occurred within that period.</span></span> 
    
6. <span data-ttu-id="acca1-173">Нажмите кнопку **Поиск** , чтобы выполнить поиск.</span><span class="sxs-lookup"><span data-stu-id="acca1-173">Click **Search** to run the search.</span></span> 
    
7. <span data-ttu-id="acca1-174">После завершения поиска и отображения результатов нажмите кнопку **Экспорт результатов** \> **скачать все результаты**.</span><span class="sxs-lookup"><span data-stu-id="acca1-174">When the search is finished running and the results are displayed, click **Export results** \> **Download all results**.</span></span>
    
    <span data-ttu-id="acca1-175">После выбора варианта экспорта в нижней части окна появится сообщение, предлагающее открыть или сохранить CSV-файл.</span><span class="sxs-lookup"><span data-stu-id="acca1-175">After you select the export option, a message at the bottom of the window prompts you to open or save the CSV file.</span></span>
    
8. <span data-ttu-id="acca1-176">Нажмите кнопку **сохранить** \> **Сохранить как** и сохраните CSV-файл в папке на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="acca1-176">Click **Save** \> **Save as** and save the CSV file to a folder on your local computer.</span></span> 

### <a name="step-2-use-the-powerquery-editor-to-format-the-exported-audit-log"></a><span data-ttu-id="acca1-177">Шаг 2: использование редактора Поверкуери для форматирования экспортированного журнала аудита</span><span class="sxs-lookup"><span data-stu-id="acca1-177">Step 2: Use the PowerQuery Editor to format the exported audit log</span></span>

<span data-ttu-id="acca1-178">Следующий шаг — использование функции преобразования JSON в редакторе Power Query в Excel для разделения каждого свойства в столбце **аудитдата** (который состоит из многозначного объекта JSON) в отдельный столбец.</span><span class="sxs-lookup"><span data-stu-id="acca1-178">The next step is to use the JSON transform feature in the Power Query Editor in Excel to split each property in the **AuditData** column (which consists of a multi-property JSON object) into its own column.</span></span> <span data-ttu-id="acca1-179">Это позволяет фильтровать столбцы, чтобы просматривать записи, связанные с общим доступом.</span><span class="sxs-lookup"><span data-stu-id="acca1-179">This lets you filter columns to view records related to sharing</span></span>

<span data-ttu-id="acca1-180">Пошаговые инструкции приведены в разделе "шаг 2: форматирование экспортированного журнала аудита с помощью редактора Power Query Editor" в разделе [Экспорт, Настройка и просмотр записей журнала аудита](export-view-audit-log-records.md#step-2-format-the-exported-audit-log-using-the-power-query-editor).</span><span class="sxs-lookup"><span data-stu-id="acca1-180">For step-by-step instructions, see "Step 2: Format the exported audit log using the Power Query Editor" in [Export, configure, and view audit log records](export-view-audit-log-records.md#step-2-format-the-exported-audit-log-using-the-power-query-editor).</span></span>

### <a name="step-3-filter-the-csv-file-for-resources-shared-with-external-users"></a><span data-ttu-id="acca1-181">Шаг 3: Фильтрация CSV-файла для ресурсов, к которым предоставлен доступ внешним пользователям</span><span class="sxs-lookup"><span data-stu-id="acca1-181">Step 3: Filter the CSV file for resources shared with external users</span></span>

<span data-ttu-id="acca1-182">Следующий шаг — фильтрация CSV для различных событий, связанных с общим доступом, описанных ранее в разделе Общие сведения о [событиях SharePoint](#sharepoint-sharing-events) .</span><span class="sxs-lookup"><span data-stu-id="acca1-182">The next step is to filter the CSV for the different sharing-related events that were previously described in the [SharePoint sharing events](#sharepoint-sharing-events) section.</span></span> <span data-ttu-id="acca1-183">Кроме того, можно отфильтровать столбец **таржетусерорграуптипе** , чтобы отобразить все записи, для которых значение этого свойства — " **гость**".</span><span class="sxs-lookup"><span data-stu-id="acca1-183">Alternatively, you can filter the **TargetUserOrGroupType** column to display all records where the value of this property is **Guest**.</span></span> 

<span data-ttu-id="acca1-184">После выполнения инструкций, приведенных на предыдущем шаге, для подготовки CSV-файла с помощью редактора Поверкуери выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="acca1-184">After you've followed the instructions in the previous step to prepare the CSV file by using the PowerQuery editor, do the following:</span></span>
    
1. <span data-ttu-id="acca1-185">Откройте файл Excel, созданный в шаге 2.</span><span class="sxs-lookup"><span data-stu-id="acca1-185">Open the Excel file that you created in Step 2.</span></span> 

2. <span data-ttu-id="acca1-186">На вкладке **Главная** нажмите кнопку **Сортировка & фильтр**, а затем нажмите кнопку **Фильтр**.</span><span class="sxs-lookup"><span data-stu-id="acca1-186">On the **Home** tab, click **Sort & Filter**, and then click **Filter**.</span></span>
    
3. <span data-ttu-id="acca1-187">В раскрывающемся списке **Отсортировать & фильтра** в столбце **операции** выберите Очистить все, а затем выберите одно или несколько указанных ниже событий, связанных с общим доступом, а затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="acca1-187">In the **Sort & Filter** dropdown list on the **Operations** column, clear all selections, then select one or more the following sharing-related events and then click **Ok**.</span></span>
 
   - <span data-ttu-id="acca1-188">**SharingInvitationCreated**</span><span class="sxs-lookup"><span data-stu-id="acca1-188">**SharingInvitationCreated**</span></span>
   
   - <span data-ttu-id="acca1-189">**AnonymousLinkCreated**</span><span class="sxs-lookup"><span data-stu-id="acca1-189">**AnonymousLinkCreated**</span></span>
   
   - <span data-ttu-id="acca1-190">**SecureLinkCreated**</span><span class="sxs-lookup"><span data-stu-id="acca1-190">**SecureLinkCreated**</span></span>
   
   - <span data-ttu-id="acca1-191">**AddedToSecureLink**</span><span class="sxs-lookup"><span data-stu-id="acca1-191">**AddedToSecureLink**</span></span> 
    
    <span data-ttu-id="acca1-192">Excel отображает строки для выбранных событий.</span><span class="sxs-lookup"><span data-stu-id="acca1-192">Excel displays the rows for the events you selected.</span></span>
    
4. <span data-ttu-id="acca1-193">Перейдите к столбцу с именем **таржетусерорграуптипе** и выберите его.</span><span class="sxs-lookup"><span data-stu-id="acca1-193">Go to the column named **TargetUserOrGroupType** and select it.</span></span> 
    
5. <span data-ttu-id="acca1-194">В раскрывающемся списке **сортировать & фильтр** снимите флажок все, а затем выберите **таржетусерорграуптипе: гость**и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="acca1-194">In the **Sort & Filter** dropdown list, clear all selections, then select **TargetUserOrGroupType:Guest**, and click **Ok**.</span></span>
    
    <span data-ttu-id="acca1-195">Теперь в Excel отображаются строки для событий общего доступа и конечных пользователей за пределами Организации, так как внешние пользователи определяются значением **таржетусерорграуптипе: гость**.</span><span class="sxs-lookup"><span data-stu-id="acca1-195">Now Excel displays the rows for sharing events AND where the target user is outside of your organization, because external users are identified by the value **TargetUserOrGroupType:Guest**.</span></span> 
  
> [!TIP]
> <span data-ttu-id="acca1-196">Для отображаемых записей аудита в столбце **ObjectID** указывается ресурс, к которому предоставлен общий доступ конечному пользователю; например `ObjectId:https:\/\/contoso-my.sharepoint.com\/personal\/sarad_contoso_com\/Documents\/Southwater Proposal.docx` :.</span><span class="sxs-lookup"><span data-stu-id="acca1-196">For the audit records that are displayed, the **ObjectId** column identifies the resource that was shared with the target user; for example  `ObjectId:https:\/\/contoso-my.sharepoint.com\/personal\/sarad_contoso_com\/Documents\/Southwater Proposal.docx`.</span></span>
