---
title: Настройка соединители для импорта данных отдела кадров в облако для государственных органов США
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
audience: Admin
ms.topic: how-to
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection: M365-security-compliance
ROBOTS: NOINDEX, NOFOLLOW
description: Администраторы в облаке для государственных организаций США могут настроить соединители данных для импорта данных сотрудников из системы управления персоналом (HR) организации в Microsoft 365. Это позволяет использовать данные о персонале в политиках управления внутренними рисками, чтобы помочь вам обнаруживать действия определенных пользователей, которые могут представлять внутреннюю угрозу для вашей организации.
ms.openlocfilehash: 80998422eba32fe7f9118166f76a61d2d4bd8894
ms.sourcegitcommit: 6fc6aaa2b7610e148f41018abd229e3c55b2f3d0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "49619925"
---
# <a name="set-up-a-connector-to-import-hr-data-in-us-government"></a>Настройка соединители для импорта данных о персонале в правительства США

Вы можете настроить соединители данных в Центре соответствия требованиям Microsoft 365 для импорта данных отдела кадров (HR) в организацию для государственных организаций США. Данные, связанные с персоналом, включают дату, отправленную сотрудником, и дату последнего дня сотрудника. Затем эти данные отдела кадров могут использоваться решениями Майкрософт для защиты информации, такими как решение для управления рисками внутри [организации,](insider-risk-management.md)для защиты организации от вредоносных действий или кражи данных внутри организации. Настройка соединителя управления персоналом состоит из создания приложения в Azure Active Directory, используемого для проверки подлинности соединителя, создания CSV-файлов сопоставления, которые содержат ваши данные о персонале, создания соединителя данных в Центре соответствия требованиям и выполнения сценария (на запланированной основе), который будет использовать данные о персонале в CSV-файле в Microsoft Cloud. Затем соединители данных используются средством управления рисками внутри организации для доступа к данным отдела кадров, импортируемым в организацию Microsoft 365 для государственных организаций США.

## <a name="before-you-begin"></a>Перед началом работы

- Пользователю, который создает соединитель отдела кадров на шаге 3, должна быть назначена роль импорта и экспорта почтовых ящиков в Exchange Online. По умолчанию эта роль не назначена ни одной группе ролей в Exchange Online. Вы можете добавить роль "Импорт и экспорт почтового ящика" в группу ролей "Управление организацией" в Exchange Online. Можно также создать новую группу ролей, назначить роль "Импорт и экспорт почтового ящика" и добавить соответствующих пользователей в качестве участников. Дополнительные сведения см. в [](https://docs.microsoft.com/Exchange/permissions-exo/role-groups#modify-role-groups) разделах ["Создание](https://docs.microsoft.com/Exchange/permissions-exo/role-groups#create-role-groups) групп ролей" или "Изменение групп ролей" статьи "Управление группами ролей в Exchange Online".

- Необходимо определить, как извлекать или экспортировать данные из системы управления персоналом организации (на регулярной основе) и добавлять их в CSV-файл, описанный в шаге 2. Сценарий, который вы запустите в шаге 4, загрузит данные о персонале в CSV-файле в Облако Майкрософт.

- Пример скрипта, который вы запустите в шаге 4, будет загружать данные о персонале в Microsoft Cloud, чтобы их могли использовать другие инструменты Майкрософт, такие как решение для управления рисками внутри организации. Этот пример сценария не поддерживается ни в одной стандартной программе или службе поддержки Майкрософт. Пример сценария приводится в виде "как есть", без каких-либо гарантий. Кроме того, корпорация Microsoft отказывается от всех подразумеваемых гарантий, включая в том числе все подразумеваемые гарантии пригодности для продажи или определенной цели. Все риски, возникающие в результате использования примера сценария и документации, берет на себя пользователь. Корпорация Майкрософт, ее штатные авторы и другие лица, принимающие участие в создании, подготовке и выпуске сценариев, ни при каких обстоятельствах не несут ответственность за какой-либо ущерб (в том числе, ущерб, вызванный потерей доходов предприятия, остановкой его работы, потерей бизнес-данных и другими материальными потерями), вызванный использованием или неспособностью использовать примеры сценариев и документацию, даже если корпорации Майкрософт известно о возможности нанесения такого ущерба.

## <a name="step-1-create-an-app-in-azure-active-directory"></a>Шаг 1. Создание приложения в Azure Active Directory

Сначала необходимо создать и зарегистрировать новое приложение в Azure Active Directory (Azure AD). Приложение будет соответствовать соединители отдела кадров, которые вы создали на шаге 3. Создание этого приложения позволит Azure AD проходить проверку подлинности соединители отдела кадров при запуске и попытке доступа к организации. Это приложение также будет использоваться для проверки подлинности скрипта, который вы запустите в шаге 4 для отправки данных о персонале в Microsoft Cloud. Во время создания этого приложения Azure AD обязательно сохраните следующие сведения. Эти значения будут использоваться на последующих шагах.

- ИД приложения Azure AD (также называемый *ИД приложения* или ид *клиента)*

- Секрет приложения Azure AD (также называемый *секретом клиента)*

- ИД клиента (также называемый *ид каталога)*

Пошаговая инструкция по созданию приложения в Azure AD см. в записи "Регистрация приложения с помощью платформы удостоверений [Майкрософт".](https://docs.microsoft.com/azure/active-directory/develop/quickstart-register-app)

## <a name="step-2-prepare-a-csv-file-with-your-hr-data"></a>Шаг 2. Подготовка CSV-файла с данными отдела кадров

Далее необходимо создать CSV-файл, содержащий сведения о сотрудниках, уехавших из организации. Как поясняется в разделе "Перед началом работы", необходимо определить, как создать этот CSV-файл из системы управления персоналом организации. В следующем примере показан завершенный CSV-файл (открытый в блокноте), содержащий три необходимых параметра (столбцы). В Microsoft Excel намного проще редактировать CSV-файл.

```text
EmailAddress,TerminationDate,LastWorkingDate
sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,2019-04-29T15:18:02.4675041+05:30
pilarp@contoso.com,2019-04-24T09:15:49Z,2019-04-29T15:18:02.7117540
```

В первой строке (строке колонок) CSV-файла указаны необходимые имена столбцов. Имя, используемая в каждом столбце, за вами (предложения в предыдущем примере). Однако те же имена столбцов, которые  вы используете в CSV-файле, должны быть указаны при создании соединители отдела кадров на шаге 3. Не включай пробелы в имена столбцов.

В следующей таблице описан каждый столбец в CSV-файле:

| Столбец | Описание |
|:-----|:-----|
| **EmailAddress** <br/> |Указывает адрес электронной почты сотрудника, завершив работу.|
| **TerminationDate** <br/> |Указывает дату официального прекращения работы человека в организации. Например, это может быть дата, когда сотрудник предоставил уведомление о выходе из организации. Эта дата может быть не такой, как дата последнего дня работы человека. Используйте следующий формат даты: `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm` is the [ISO 8601 date and time format](https://www.iso.org/iso-8601-date-and-time-format.html).|
|**LastWorkingDate**|Указывает последний день работы для сотрудника, завершив работу. Используйте следующий формат `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm` даты: is the [ISO 8601 date and time format](https://www.iso.org/iso-8601-date-and-time-format.html).|
|||

После создания CSV-файла с нужными данными о персонале храните его в той же системе, что и сценарий, который вы запустите в шаге 4. Не забудьте реализовать стратегию обновления, чтобы CSV-файл всегда содержит самые актуальные сведения. Это гарантирует, что при любом запуске сценария в облако Майкрософт будут загружены самые актуальные данные об увольнении сотрудников.

## <a name="step-3-create-the-hr-connector"></a>Шаг 3. Создание соединители отдела кадров

Следующим шагом является создание соединители отдела кадров в Центре соответствия требованиям Microsoft 365. После запуска скрипта на шаге 4 создаваемая вами соединиталь управления персоналом будет вместить данные о персонале из CSV-файла в вашу организацию Microsoft 365. На этом этапе обязательно скопируйте ИД задания, которое создается при создании соединители. При запуске сценария вы будете использовать этот ИД задания.

1. Go to [https://compliance.microsoft.com](https://compliance.microsoft.com) and then click Data **connectors** in the left nav.

2. На странице **"Соединители данных" в** **отделе** кадров щелкните **"Просмотреть".**

3. На странице **отдела кадров** нажмите кнопку **"Добавить соединителю".**

4. На странице **"Учетные данные проверки** подлинности" сделайте следующее и нажмите кнопку **"Далее".**

   1. Введите или введите и введите ИД приложения Azure AD для приложения Azure, созданного на шаге 1.

   1. Введите имя для соединители отдела кадров.

5. На  странице сопоставления файлов введите имена трех колонок (также называемых параметрами) из CSV-файла, созданного на шаге 2, в каждом из соответствующих полей. Имена не чувствительны к делу. Как объяснялось ранее, имена, которые вы введите в этих полях, должны совпадать с именами параметров в CSV-файле. Например, на следующем снимке экрана показаны имена параметров из примера в примере CSV-файла, показанного на шаге 2.

   ![Имена заголовков столбцов совпадают с именами в CSV-файле](../media/HRConnectorWizard3.png)

6. На странице **"Проверка"** просмотрите параметры и нажмите кнопку **"Готово",** чтобы создать соединители.

   Отобразилась страница состояния, подтверждая, что соединитегор создан. На этой странице содержатся два важных шага, которые необходимо выполнить на следующем этапе, чтобы запустить пример сценария для отправки данных о персонале.

   ![Страница просмотра с ИД задания и ссылкой на github для примера сценария](../media/HRConnector_Confirmation.png)

   1. **ИД задания.** Этот ИД задания потребуется для запуска сценария на следующем этапе. Вы можете скопировать его с этой страницы или со страницы flyout соединители.
   
   1. **Ссылка на пример сценария.** Щелкните **ссылку** здесь, чтобы перейти на сайт GitHub, чтобы получить доступ к примеру сценария (ссылка открывает новое окно). Не открывай это окно, чтобы можно было скопировать сценарий на шаге 4. Кроме того, вы можете закладки назначения или скопировать URL-адрес для повторного доступа к нему в шаге 4. Эта ссылка также доступна на странице flyout соединители.

7. Нажмите кнопку **Готово**.

   Новый соединитер отображается в списке на вкладке **"Соединители".** 

8. Щелкните созданный соединиталь управления персоналом, чтобы отобразить только что созданную страницу с свойствами и другими сведениями о соединителе.

   ![Flyout page for new HR connector](../media/HRConnectorWizard7.png)

   Если вы еще не сделали этого, вы можете скопировать значения для **ИД** приложения Azure и ид задания **соединители.** Они необходимы для запуска скрипта на следующем этапе. Вы также можете скачать сценарий со страницы flyout (или скачать его по ссылке на следующем шаге).)

   Вы также  можете нажать кнопку "Изменить", чтобы изменить ИД приложения Azure или имена столбцов, определенные на странице **сопоставления** файлов.

## <a name="step-4-run-the-sample-script-to-upload-your-hr-data"></a>Шаг 4. Запуск примера сценария для отправки данных о персонале

Последним шагом при настройке соединители отдела кадров является запуск примера сценария, который будет загружать данные о персонале в CSV-файле (созданном на шаге 2) в Microsoft Cloud. В частности, сценарий загружает данные в соединителю управления персоналом. После выполнения скрипта созданный в шаге 3 соединител управления персоналом импортирует данные отдела кадров в организацию Microsoft 365, где к ним можно получить доступ с помощью других средств обеспечения соответствия требованиям, таких как решение для управления рисками для программы оценки рисков. После запуска сценария рассмотрите возможность планирования автоматического запуска задачи на ежедневной основе, чтобы наиболее актуальные данные о завершении работы сотрудников загружались в Microsoft Cloud. См. [расписание автоматического запуска сценария.](#optional-step-6-schedule-the-script-to-run-automatically)

1. Перейдите к окну, которое вы открыли на предыдущем шаге, чтобы получить доступ к сайту GitHub с помощью примера сценария. Кроме того, откройте сайт с закладкой или используйте скопированные URL-адреса.

2. Нажмите **кнопку "Необработанные",** чтобы отобразить сценарий в текстовом представлении.

3. Скопируйте все строки примера сценария и сохраните их в текстовый файл.

4. При необходимости измените пример сценария для организации.

5. Сохраните текстовый файл в Windows PowerShell с помощью суффикса имени файла, например `.ps1` `HRConnector.ps1` .

6. Откройте командную подсказку на локальном компьютере и перейдите в каталог, в котором сохранен сценарий.

7. Чтобы отправить данные о персонале в CSV-файле в Microsoft Cloud, запустите следующую команду. Например:

    ```powershell
    .\HRConnector.ps1 -tenantId <tenantId> -appId <appId>  -appSecret <appSecret>  -jobId <jobId>  -csvFilePath '<csvFilePath>'
    ```

   В следующей таблице описываются параметры, которые необходимо использовать с этим сценарием, и их необходимые значения. Сведения, полученные на предыдущих шагах, используются в значениях этих параметров.

   | Параметр | Описание |
   |:-----|:-----|:-----|
   |`tenantId`|ИД вашей организации Microsoft 365, полученный на шаге 1. Вы также можете получить ид клиента для своей организации в blade **Overview** в Центре администрирования Azure AD. Это используется для идентификации организации.|
   |`appId` |ИД приложения Azure AD, созданного в Azure AD на шаге 1. Этот сценарий используется Azure AD для проверки подлинности при попытке доступа к вашей организации Microsoft 365. |
   |`appSecret`|Секрет приложения Azure AD для приложения, созданного в Azure AD на шаге 1. Это также используется для проверки подлинности.|
   |`jobId`|ИД задания для соединители отдела кадров, созданного на шаге 3. Он используется для связи данных о персонале, которые загружаются в Microsoft Cloud, с соединитетелем управления персоналом.|
   |`csvFilePath`|Путь к CSV-файлу (который хранится в той же системе, что и сценарий), созданному на шаге 2. Старайтесь избегать пробелов в пути к файлу; в противном случае используйте одиночные кавычка.|
   |||
   
   Вот пример синтаксиса для скрипта соединители отдела кадров с использованием фактических значений для каждого параметра:

   ```powershell
    .\HRConnector.ps1 -tenantId d5723623-11cf-4e2e-b5a5-01d1506273g9 -appId 29ee526e-f9a7-4e98-a682-67f41bfd643e -appSecret MNubVGbcQDkGCnn -jobId b8be4a7d-e338-43eb-a69e-c513cd458eba -csvFilePath 'C:\Users\contosoadmin\Desktop\Data\employee_termination_data.csv'
    ```

   Если отправка будет успешной, сценарий отобразит сообщение **об успешной отправке.**

   > [!NOTE]
   > Если возникают проблемы с выполнением предыдущей [](https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_execution_policies) команды из-за политик выполнения, см. инструкции по настройке политик выполнения в политиках выполнения и [Set-ExecutionPolicy.](https://docs.microsoft.com/powershell/module/microsoft.powershell.security/set-executionpolicy)

## <a name="step-5-monitor-the-hr-connector"></a>Шаг 5. Отслеживание соединители отдела кадров

После создания соединители отдела кадров и запуска скрипта для отправки данных о персонале вы можете просмотреть его и отправить состояние в Центре соответствия требованиям Microsoft 365. Если сценарий будет запускаться регулярно, можно также просмотреть текущее состояние после последнего запуска сценария.

1. Go to [https://compliance.microsoft.com](https://compliance.microsoft.com) and click **Data connectors** in the left nav.

2. Перейдите **на вкладку** "Соединители", а затем выберите соединители отдела кадров, чтобы отобразить страницу отображения. На этой странице содержатся свойства и сведения о соединители.

   ![Flyout page hr connector with properties and status](../media/HRConnectorFlyout1.png)

3. В **окне**"Ход выполнения" **щелкните** ссылку на журнал загрузки, чтобы открыть (или сохранить) журнал состояния соединитела. Этот журнал содержит сведения о каждом запуске сценария и отправке данных из CSV-файла в облако Майкрософт. 

   ![Файл журнала соединителя отдела кадров отображает строки номеров из CSV-файла, которые были загружены](../media/HRConnectorLogFile.png)

   Поле указывает количество строк в `RecordsSaved` загруженном CSV-файле. Например, если CSV-файл содержит четыре строки, то значение этих полей будет 4, если сценарий успешно загрузил все строки `RecordsSaved` в CSV-файле.

Если вы еще не запускали сценарий на шаге 4, в области "Последний импорт" отображается ссылка для скачивания **сценария.** Вы можете скачать сценарий, а затем выполнить действия, которые необходимо выполнить на шаге 4, чтобы запустить его.

## <a name="optional-step-6-schedule-the-script-to-run-automatically"></a>(Необязательно) Шаг 6. Запланировать автоматический запуск сценария

Чтобы убедиться, что последние данные о персонале из вашей организации доступны для таких средств, как решение для управления рисками внутри организации, рекомендуется запланировать автоматический запуск сценария на регулярной основе, например один раз в день. Для этого также необходимо обновить данные о персонале в CSV-файле по аналогичному (если не тому же) расписанию, чтобы они содержат последние сведения о сотрудниках, уехавших из вашей организации. Целью является отправка самых актуальных данных о персонале, чтобы соединители отдела кадров могли сделать их доступными для решения по управлению рисками внутри организации.

Вы можете использовать приложение планировщика задач в Windows, чтобы автоматически запускать сценарий каждый день.

1. На локальном компьютере  нажмите кнопку "Начните" в Windows, а затем введите **планировать задачи.**

2. Щелкните **приложение планировщика** задач, чтобы открыть его.

3. В разделе **"Действия"** щелкните **"Создать задачу".**

4. На **вкладке "Общие"** введите описательное имя запланированной задачи; например, **сценарий соединители отдела кадров.** Вы также можете добавить необязательное описание.

5. В **области "Параметры безопасности"** сделайте следующее:

   1. Определите, следует ли запускать сценарий только при входе на компьютер или при входе в систему.
   
   1. Убедитесь, что **для запуска с самыми** высокими привилегиями выбран этот контрольный ящик.

6. Выберите **вкладку "Триггеры",** нажмите **кнопку "Новый"** и сделайте следующее:

   1. В **области "Параметры"** выберите параметр **"Ежедневно",** а затем выберите дату и время для первого запуска сценария. Сценарий будет ежедневно работать в одно и то же время.
   
   1. В **области "Дополнительные параметры"** убедитесь, что выбран этот параметр. 
   
   1. Нажмите кнопку **ОК**.

7. Выберите **вкладку "Действия",** нажмите **кнопку "Новый"** и сделайте следующее:

   ![Параметры действий для создания новой запланированной задачи для скрипта соединители отдела кадров](../media/HRConnectorScheduleTask1.png)

   1. **Убедитесь,** что в списке действий **выбран** запуск программы.

   1. В **окне "Программа/сценарий"** нажмите кнопку **"Обзор",** перейдите в следующее расположение и выберите его, чтобы путь отобразился в `C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe` поле:

   1. В поле **"Добавить аргументы" (необязательно)** в поле "Добавить аргументы" в поле "Шаг 4" в поле "Добавить аргументы" в paste the same script command that you ran in Step 4. Пример: `.\HRConnector.ps1 -tenantId "d5723623-11cf-4e2e-b5a5-01d1506273g9" -appId "c12823b7-b55a-4989-faba-02de41bb97c3" -appSecret "MNubVGbcQDkGCnn"  -jobId "e081f4f4-3831-48d6-7bb3-fcfab1581458" -csvFilePath "C:\Users\contosoadmin\Desktop\Data\employee_termination_data.csv"`

   1. В поле **"Начните (необязательно)** вложите расположение папки сценария, который вы запустили на шаге 4. Например, `C:\Users\contosoadmin\Desktop\Scripts`.

   1. Нажмите **кнопку** "ОК", чтобы сохранить параметры нового действия.

8. В **окне "Создание задачи"** нажмите **кнопку "ОК",** чтобы сохранить запланированную задачу. Вам может быть предложено ввести учетные данные учетной записи пользователя.

   Новая задача отображается в библиотеке планировщика задач.

   ![Новая задача отображается в библиотеке планировщика задач](../media/HRConnectorTaskSchedulerLibrary.png)

   Отображается время последнего запуска сценария и его запланированного запуска. Можно дважды щелкнуть задачу, чтобы изменить ее.

   Вы также можете проверить, когда сценарий в последний раз запустился на странице с соответствующим соединитетелем отдела кадров в Центре соответствия требованиям.
