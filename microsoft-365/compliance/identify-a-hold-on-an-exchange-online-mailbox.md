---
title: Как определить тип удержания, примененного для почтового ящика Exchange Online
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
ms.collection: M365-security-compliance
localization_priority: Normal
search.appverid:
- MET150
ms.assetid: 6057daa8-6372-4e77-a636-7ea599a76128
ms.custom:
- seo-marvel-apr2020
description: Узнайте, как определить различные типы удержаний, которые могут быть размещены в почтовом ящике Exchange Online в Microsoft 365.
ms.openlocfilehash: ea7beb34107fb5eaf61c56ece7bde8070e6467a6
ms.sourcegitcommit: e8b9a4f18330bc09f665aa941f1286436057eb28
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/14/2020
ms.locfileid: "45126810"
---
# <a name="how-to-identify-the-type-of-hold-placed-on-an-exchange-online-mailbox"></a>Как определить тип удержания, примененного для почтового ящика Exchange Online

В этой статье объясняется, как определить удержания, размещенные в почтовых ящиках Exchange Online в Microsoft 365.

Microsoft 365 предлагает несколько способов предотвращения окончательного удаления содержимого почтовых ящиков в Организации. Это позволяет организации хранить контент для удовлетворения нормативных требований, а также во время юридических и других видов расследований. Ниже приведен список функций хранения (также называемых *удержаниями*) в Office 365:

- ** [Удержание для судебного разбирательства](create-a-litigation-hold.md):** Удержания, которые применяются к почтовым ящикам пользователей в Exchange Online.

- ** [удержание eDiscovery](create-ediscovery-holds.md):** Удержания, связанные с основным вариантом обнаружения электронных данных в центре безопасности и соответствия требованиям. удержания электронных данных можно применять к почтовым ящикам пользователей и к соответствующему почтовому ящику для групп Microsoft 365 и Microsoft Teams.

- ** [Удержание на месте](https://docs.microsoft.com/Exchange/security-and-compliance/create-or-remove-in-place-holds):** Удержания, применяемые к почтовым ящикам пользователей с помощью средства обнаружения электронных данных & на месте в центре администрирования Exchange в Exchange Online.

- ** [Политики хранения Microsoft 365](retention.md):** Можно настроить для сохранения (или сохранения) содержимого в почтовых ящиках пользователей в Exchange Online и в соответствующем почтовом ящике для групп Microsoft 365 и Microsoft Teams. Вы также можете создать политику хранения для сохранения бесед в Skype для бизнеса, которые хранятся в почтовых ящиках пользователей.

  Существует два типа политик хранения Microsoft 365, которые можно назначить почтовым ящикам.

    - **Политики хранения для определенных расположений:** Это политики, назначенные расположению содержимого определенных пользователей. С помощью командлета **Get-Mailbox** в Exchange Online PowerShell можно получить сведения о политиках хранения, назначенных для определенных почтовых ящиков.

    - **Политики хранения на уровне Организации:** Это политики, назначенные для всех расположений контента в Организации. Командлет **Get-OrganizationConfig** в Exchange Online PowerShell используется для получения сведений о политиках хранения на уровне Организации.
    
  Для получения дополнительных сведений см раздел [применение политики хранения ко всей организации или разделу конкретных расположений](create-retention-policies.md#applying-a-retention-policy-to-an-entire-organization-or-specific-locations) .

- **[Метки хранения microsoft 365](retention.md):** если пользователь применяет метку хранения Microsoft 365 (которая настроена для сохранения контента или сохранения контента) в любую папку или элемент в своем почтовом ящике, хранение помещается в почтовом ящике так, как если *бы* почтовый ящик был включен на хранение для судебного разбирательства или назначено политике хранения Microsoft 365. Дополнительную информацию можно узнать в статье [Идентификация почтовых ящиков на удержании, так как к разделу папки или элемента в этой статье применена метка хранения](#identifying-mailboxes-on-hold-because-a-retention-label-has-been-applied-to-a-folder-or-item) .

Чтобы управлять почтовыми ящиками на удержании, может потребоваться определить тип удержания, размещаемого в почтовом ящике, чтобы можно было выполнять такие задачи, как изменение срока хранения, временное или окончательное удаление удержания или исключение почтового ящика из политики хранения Microsoft 365. В этих случаях первым шагом является определение типа удержания, который находился в почтовом ящике. Так как несколько удержаний (и различных типов удержаний) могут быть размещены в одном почтовом ящике, необходимо определить все удержания, размещенные в почтовом ящике, если вы хотите удалить или изменить удержание.

## <a name="step-1-obtain-the-guid-for-holds-placed-on-a-mailbox"></a>Шаг 1: получение GUID для удержаний, размещенных в почтовом ящике

Вы можете выполнить следующие два командлета в Exchange Online PowerShell, чтобы получить идентификатор GUID удержаний, размещенных в почтовом ящике. После получения идентификатора GUID вы можете использовать его, чтобы определить конкретное удержание на шаге 2. Удержание для судебного разбирательства не идентифицируется по идентификатору GUID. Судебное удержание включено или отключено для почтового ящика.

- **Get/Mailbox:** Используйте этот командлет, чтобы определить, включено ли хранение для судебного разбирательства для почтового ящика, а также для получения идентификаторов GUID для удержания электронных данных на месте, хранения на месте и политик хранения Microsoft 365, специально назначенных почтовому ящику. Выходные данные этого командлета также указывают на то, что почтовый ящик явно исключен из политики хранения на уровне Организации.

- **Get — OrganizationConfig:** Используйте этот командлет, чтобы получить идентификаторы GUID для политик хранения на уровне Организации.

Сведения о том, как подключиться к Exchange Online PowerShell, см. в статье [Подключение к Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell?view=exchange-ps).

### <a name="get-mailbox"></a>Get-Mailbox

Выполните следующую команду, чтобы получить сведения о удержаниях и политиках хранения Microsoft 365, применяемых к почтовому ящику.

```powershell
Get-Mailbox <username> | FL LitigationHoldEnabled,InPlaceHolds
```

> [!TIP]
> Если в свойстве InPlaceHolds слишком много значений, а не все они отображаются, можно выполнить `Get-Mailbox <username> | Select-Object -ExpandProperty InPlaceHolds` команду для отображения каждого идентификатора GUID в отдельной строке.

В следующей таблице описано, как определить различные типы удержаний на основе значений в свойстве *InPlaceHolds* при запуске командлета **Get-Mailbox** .


|Тип удержания  |Пример значения  |Определение удержания  |
|---------|---------|---------|
|Хранение для судебного разбирательства     |    `True`     |     Удержание для судебного разбирательства включено для почтового ящика, если для свойства *LitigationHoldEnabled* задано значение `True` .    |
|удержание eDiscovery     |  `UniH7d895d48-7e23-4a8d-8346-533c3beac15d`       |   *Свойство InPlaceHolds* содержит GUID всех удержаний, связанных с вариантом обнаружения электронных данных в центре безопасности и соответствия требованиям. Вы можете сказать, что это удержание для обнаружения электронных данных, так как идентификатор GUID начинается с `UniH` префикса (обозначает единое удержание).      |
|Хранение на месте     |     `c0ba3ce811b6432a8751430937152491` <br/> или <br/> `cld9c0a984ca74b457fbe4504bf7d3e00de`  |     Свойство *InPlaceHolds* содержит GUID хранения на месте, который размещается в почтовом ящике. Вы можете указать, что это удержание на месте, так как GUID либо не начинается с префикса, либо начинается с `cld` префикса.     |
|Политика хранения Microsoft 365, специально примененная к почтовому ящику     |    `mbxcdbbb86ce60342489bff371876e7f224:1` <br/> или <br/> `skp127d7cf1076947929bf136b7a2a8c36f:3`     |     Свойство InPlaceHolds содержит идентификаторы GUID для определенной политики хранения местоположения, применяемой к почтовому ящику. Вы можете определить политики хранения, так как идентификатор GUID начинается с `mbx` `skp` префикса или. `skp`Префикс указывает на то, что политика хранения применяется к беседам Skype для бизнеса в почтовом ящике пользователя.    |
|Исключено из политики хранения Microsoft 365 в масштабе всей Организации     |   `-mbxe9b52bf7ab3b46a286308ecb29624696`      |     Если почтовый ящик исключен из политики хранения Microsoft 365 в масштабе всей Организации, идентификатор GUID политики хранения, из которого исключен почтовый ящик, отображается в свойстве InPlaceHolds и определяется `-mbx` префиксом.    |

### <a name="get-organizationconfig"></a>Get — OrganizationConfig
Если при запуске командлета **Get-Mailbox** свойство *InPlaceHolds* не задано, для почтового ящика также могут быть применены одна или несколько политик хранения Microsoft 365 на уровне Организации. Выполните следующую команду в Exchange Online PowerShell, чтобы получить список идентификаторов GUID для политик хранения Microsoft 365 на уровне Организации.

```powershell
Get-OrganizationConfig | FL InPlaceHolds
```

> [!TIP]
> Если в свойстве InPlaceHolds слишком много значений, а не все они отображаются, можно выполнить `Get-OrganizationConfig | Select-Object -ExpandProperty InPlaceHolds` команду для отображения каждого идентификатора GUID в отдельной строке.

В следующей таблице описываются различные типы удержаний на уровне Организации и способы идентификации каждого типа на основе идентификаторов GUID, которые содержатся в свойстве *InPlaceHolds* при запуске командлета **Get-OrganizationConfig** .


|Тип удержания  |Пример значения  |Описание  |
|---------|---------|---------|
|Политики хранения Microsoft 365, применяемые к почтовым ящикам Exchange, общедоступным папкам Exchange и обсуждениям Teams    |      `mbx7cfb30345d454ac0a989ab3041051209:2`   |   Политики хранения на уровне Организации, применяемые к почтовым ящикам Exchange, общедоступным папкам Exchange и разговорам 1xN в Microsoft Teams, определяются с помощью идентификаторов GUID, которые начинаются с `mbx` префикса. Примечание 1xN сеансы хранятся в почтовом ящике отдельных участников чата.      |
|Политика хранения Microsoft 365, применяемая к сообщениям канала групп Майкрософт 365 и групп     |   `grp1a0a132ee8944501a4bb6a452ec31171:3`      |    Политики хранения на уровне Организации, применяемые к группам Microsoft 365 и сообщениям канала в Microsoft Teams, определяются с помощью идентификаторов GUID, которые начинаются с `grp` префикса. Примечание. сообщения канала хранятся в почтовом ящике группы, связанном с командой Майкрософт.     |

Дополнительные сведения о политиках хранения, применяемых к Microsoft Teams, приведены в [статье сведения о политиках хранения для Microsoft Teams](retention-policies-teams.md).

### <a name="understanding-the-format-of-the-inplaceholds-value-for-retention-policies"></a>Общие сведения о формате значения InPlaceHolds для политик хранения

В дополнение к префиксу (MBX, СКП или GRP), идентифицирующему элемент в свойстве InPlaceHolds в качестве политики хранения Microsoft 365, значение также содержит суффикс, который определяет тип действия хранения, настроенного для политики. Например, суффикс действия выделяется полужирным шрифтом в следующих примерах:

   `skp127d7cf1076947929bf136b7a2a8c36f`**: 1**

   `mbx7cfb30345d454ac0a989ab3041051209`**: 2**

   `grp1a0a132ee8944501a4bb6a452ec31171`**: 3**

В следующей таблице описаны три возможных действия при хранении:

|Значение  |Описание  |
|---------|---------|
|**1,1**     | Указывает, что политика хранения настроена на удаление элементов. В политике не сохраняются элементы.        |
|**2**    |    Указывает, что политика хранения настроена для хранения элементов. Политика не удаляет элементы после истечения периода хранения.     |
|**4**     |   Указывает, что политика хранения настроена для хранения элементов, а затем удаляет их по истечении срока хранения.      |

Дополнительные сведения о действиях по хранению приведены в разделе [Сохранение содержимого в течение определенного периода времени](create-retention-policies.md#retaining-content-for-a-specific-period-of-time) .
   
## <a name="step-2-use-the-guid-to-identify-the-hold"></a>Шаг 2: использование GUID для определения удержания

После получения идентификатора GUID для удержания, который применяется к почтовому ящику, следующий шаг заключается в использовании этого идентификатора GUID для идентификации удержания. В следующих разделах показано, как определить имя удержания (и другую информацию) с помощью идентификатора GUID удержания.

### <a name="ediscovery-holds"></a>удержания электронных данных

Выполните следующие команды в консоли безопасности & соответствия требованиям PowerShell, чтобы определить удержание обнаружения электронных данных, которое применяется к почтовому ящику. Используйте идентификатор GUID (не включая префикс Уних) для удержания обнаружения электронных данных, определенного в действии 1. Первая команда создает переменную, которая содержит сведения об удержании. Эта переменная используется в других командах. Вторая команда отображает имя случая обнаружения электронных данных, с которым связано удержание. Третья команда отображает имя удержания и список почтовых ящиков, к которым применяется удержание.

```powershell
$CaseHold = Get-CaseHoldPolicy <hold GUID without prefix>
```

```powershell
Get-ComplianceCase $CaseHold.CaseId | FL Name
```

```powershell
$CaseHold | FL Name,ExchangeLocation
```

Чтобы подключиться к & центра безопасности для центра соответствия требованиям, ознакомьтесь со статьей [Подключение к PowerShell центра безопасности &](https://docs.microsoft.com/powershell/exchange/office-365-scc/connect-to-scc-powershell/connect-to-scc-powershell?view=exchange-ps).

### <a name="in-place-holds"></a>Хранение на месте

Выполните следующую команду в Exchange Online PowerShell, чтобы определить удержание на месте, которое применяется к почтовому ящику. Используйте GUID для хранения на месте, определенного в действии 1. Команда отображает имя удержания и список почтовых ящиков, к которым применяется удержание.

```powershell
Get-MailboxSearch -InPlaceHoldIdentity <hold GUID> | FL Name,SourceMailboxes
```

Если GUID для хранения на месте начинается с `cld` префикса, не забудьте включить префикс при выполнении предыдущей команды.

> [!IMPORTANT]
> Так как мы будем хранить содержимое почтового ящика разными способами, мы сообщаем выбытие на месте в центре администрирования Exchange. Начиная с 1 июля, 2020 вы не сможете создавать новые удержания на месте в Exchange Online. Но вы по-прежнему можете управлять удержаниями на месте в центре администрирования Exchange или с помощью командлета **Set-MailboxSearch** в Exchange Online PowerShell. Тем не менее, начиная с 1 октября 2020, вы не сможете управлять удержаниями на месте. Их можно удалить только в центре администрирования Exchange или с помощью командлета **Remove – MailboxSearch** . Для получения дополнительных сведений о прекращении удержания на месте, ознакомьтесь со статьей [выбытие средств прежних версий электронных данных](legacy-ediscovery-retirement.md).

### <a name="microsoft-365-retention-policies"></a>Политики хранения Microsoft 365

Выполните следующую команду в командной консоли & безопасности (PowerShell) для удостоверения политики хранения Microsoft 365 (для всей организации или определенного расположения), применяемой к почтовому ящику. Используйте идентификатор GUID (не включая префикс MBX, СКП, или элемент GRP или суффикс действия), определенный в шаге 1.

```powershell
Get-RetentionCompliancePolicy <hold GUID without prefix or suffix> -DistributionDetail  | FL Name,*Location
```

## <a name="identifying-mailboxes-on-hold-because-a-retention-label-has-been-applied-to-a-folder-or-item"></a>Идентификация почтовых ящиков на удержании, так как метка хранения была применена к папке или элементу

Когда пользователь применяет метку хранения, настроенную для сохранения контента или сохранения и удаления контента в любой папке или элементе почтового ящика, свойство Mailbox *комплианцетагхолдапплиед* имеет значение **true**. В этом случае почтовый ящик считается заблокированным, как если бы он был включен в удержание для судебного разбирательства или назначено политике хранения Microsoft 365. Если для свойства *комплианцетагхолдапплиед* задано **значение true**, могут возникать следующие действия:

- Если почтовый ящик или учетная запись пользователя удалена, почтовый ящик становится [неактивным почтовым ящиком](inactive-mailboxes-in-office-365.md).
- Вы не можете отключить почтовый ящик (основной или архивный почтовый ящик, если он включен).
- Элементы в почтовом ящике могут храниться дольше, чем ожидалось. Это связано с тем, что почтовый ящик находится на удержании, поэтому ни один из элементов не удаляется без возможности восстановления.

Чтобы просмотреть значение свойства *комплианцетагхолдапплиед* , выполните следующую команду в Exchange Online PowerShell:

```powershell
Get-Mailbox <username> |FL ComplianceTagHoldApplied
```

Дополнительные сведения о метках хранения приведены в статье [метки хранения](retention.md#retention-labels).

## <a name="managing-mailboxes-on-delay-hold"></a>Управление почтовыми ящиками на удержании с задержкой

После удаления заблокированного типа из почтового ящика применяется *Задержка удержания* . Это означает, что фактическое удаление удержания задерживается в течение 30 дней, чтобы предотвратить окончательное удаление данных из почтового ящика. Это позволяет администраторам выполнять поиск или восстановление элементов почтовых ящиков, которые удаляются после удаления удержания. Отложенная задержка помещается в почтовый ящик при следующем обработке почтового ящика помощником для управляемых папок и обнаружено, что удержание было удалено. В частности, при использовании помощника для управляемых папок для почтового ящика применяется задержка отложенного хранения, если для одного из следующих свойств почтового ящика задано **значение true**:

- **Делайхолдапплиед:** Это свойство применяется к контенту, связанному с электронной почтой (созданному пользователями с помощью Outlook и Outlook в Интернете), который хранится в почтовом ящике пользователя.

- **Делайрелеасехолдапплиед:** Это свойство применяется к облачному контенту (созданным такими приложениями, как Microsoft Teams, Microsoft Forms и Microsoft Yammer), которые хранятся в почтовом ящике пользователя. Облачные данные, созданные приложением Майкрософт, обычно хранятся в скрытой папке в почтовом ящике пользователя.
 
 Если для почтового ящика размещается задержка хранения (если для какого-либо из предыдущих свойств задано **значение true**), почтовый ящик по-прежнему считается на хранение неограниченной продолжительности удержания, как если бы почтовый ящик находился на удержании судебного разбирательства. По истечении 30 дней задержка задержки и Microsoft 365 автоматически попытаются удалить отложенную задержку (задав для свойства Делайхолдапплиед или Делайрелеасехолдапплиед **значение false**), чтобы удалить удержание. После того как для любого из этих свойств установлено значение **false**, соответствующие элементы, помеченные для удаления, очищаются при следующем обработке почтового ящика помощником для управляемых папок.

Чтобы просмотреть значения свойств Делайхолдапплиед и Делайрелеасехолдапплиед для почтового ящика, выполните следующую команду в Exchange Online PowerShell.

```powershell
Get-Mailbox <username> | FL *HoldApplied*
```

Чтобы удалить задержку до истечения срока ее действия, можно выполнить одну из следующих команд в Exchange Online PowerShell, в зависимости от того, какое свойство вы хотите изменить: 
 
```powershell
Set-Mailbox <username> -RemoveDelayHoldApplied
```

или
 
```powershell
Set-Mailbox <username> -RemoveDelayReleaseHoldApplied
```

Для использования параметров *ремоведелайхолдапплиед* или *ремоведелайрелеасехолдапплиед* необходимо назначить роль "юридический удержание" в Exchange Online. 

Чтобы удалить отложенную блокировку неактивного почтового ящика, выполните одну из следующих команд в Exchange Online PowerShell:

```powershell
Set-Mailbox <DN or Exchange GUID> -InactiveMailbox -RemoveDelayHoldApplied
```

или

```powershell
Set-Mailbox <DN or Exchange GUID> -InactiveMailbox -RemoveDelayReleaseHoldApplied
```

> [!TIP]
> Для указания неактивного почтового ящика в предыдущей команде необходимо использовать его различающееся имя или значение GUID. Используя одно из этих значений, вы не укажете по ошибке неверный почтовый ящик. 

Дополнительные сведения об использовании этих параметров для управления задержкой содержатся в разделе [Set/Mailbox](https://docs.microsoft.com/powershell/module/exchange/set-mailbox).

При управлении почтовым ящиком при задержке необходимо учитывать следующие моменты.

- Если для свойства Делайхолдапплиед или Делайрелеасехолдапплиед задано значение **true** и удален почтовый ящик (или соответствующая учетная запись пользователя), почтовый ящик становится неактивным почтовым ящиком. Это связано с тем, что почтовый ящик считается заблокированным, если любое свойство имеет значение **true**, и при удалении почтового ящика в неактивном почтовом ящике результаты удержания не отображаются. Чтобы удалить почтовый ящик и не сделать его неактивным, необходимо задать для обоих свойств **значение false**.

- Как указано выше, почтовый ящик считается заблокированным для длительного удержания, если для свойства Делайхолдапплиед или Делайрелеасехолдапплиед задано значение **true**. Однако это не означает, что *все* содержимое почтового ящика сохраняется. Это зависит от значения, которое задается для каждого свойства. Например, предположим, что оба свойства имеют значение **true** , так как удержания удаляются из почтового ящика. После этого удаляется только задержка задержки, которая применяется к облачным данным, не относящимся к Outlook (с помощью параметра *ремоведелайрелеасехолдапплиед* ). В следующий раз, когда помощник для управляемых папок обрабатывает почтовый ящик, элементы, помеченные для удаления, не удаляются. Элементы Outlook, помеченные для удаления, не будут очищены, так как для свойства Делайхолдапплиед по-прежнему задано **значение true**. Кроме того, обратное тоже справедливо: Если для Делайхолдапплиед задано значение **false** , а для делайрелеасехолдапплиед задано **значение true**, удаляются только элементы Outlook, отмеченные для удаления.

## <a name="next-steps"></a>Дальнейшие действия

Определив удержания, которые применяются к почтовому ящику, можно выполнить такие задачи, как изменение длительности хранения, временное или окончательное удаление удержания или исключение неактивного почтового ящика из политики хранения Microsoft 365. Дополнительные сведения о выполнении задач, связанных с удержаниями, можно найти в следующих статьях:

- Выполните команду [Set – RetentionCompliancePolicy – аддексчанжелокатионексцептион \<user mailbox> ](https://docs.microsoft.com/powershell/module/exchange/set-retentioncompliancepolicy?view=exchange-ps) в консоли безопасности & соответствия требованиям в PowerShell, чтобы исключить почтовый ящик из политики хранения Microsoft 365 в масштабе всей Организации. Эту команду можно использовать только для политик хранения, значение свойства *ExchangeLocation* которых равно `All` .

- Выполните команду [Set-Mailbox-ексклудефроморгхолдс \<hold GUID without prefix or suffix> ](https://docs.microsoft.com/powershell/module/exchange/set-mailbox?view=exchange-ps) в Exchange Online PowerShell, чтобы исключить неактивный почтовый ящик из политики хранения Microsoft 365 в масштабе всей Организации.

- [Изменение срока хранения неактивного почтового ящика](change-the-hold-duration-for-an-inactive-mailbox.md)

- [Удаление неактивного почтового ящика](delete-an-inactive-mailbox.md)

- [Удаление элементов в папке "Элементы с возможностью восстановления" облачных почтовых ящиков на удержании](delete-items-in-the-recoverable-items-folder-of-mailboxes-on-hold.md)
