---
title: Как определить тип удержания, примененного для почтового ящика Exchange Online
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
ms.collection: M365-security-compliance
localization_priority: Normal
search.appverid:
- MET150
ms.assetid: 6057daa8-6372-4e77-a636-7ea599a76128
ms.custom:
- seo-marvel-apr2020
description: Узнайте, как определить различные типы удержания, которые можно поместить на почтовый ящик Exchange Online в Microsoft 365.
ms.openlocfilehash: c0f5d11066169181b524632c7a1340c54f0061f0
ms.sourcegitcommit: 33afa334328cc4e3f2474abd611c1411adabd39f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/07/2020
ms.locfileid: "48370339"
---
# <a name="how-to-identify-the-type-of-hold-placed-on-an-exchange-online-mailbox"></a>Как определить тип удержания, примененного для почтового ящика Exchange Online

В этой статье объясняется, как определить режимы сбоя, помещенные на почтовые ящики Exchange Online в Microsoft 365.

Microsoft 365 предлагает несколько способов, с которыми ваша организация может предотвратить окончательное удаление содержимого почтовых ящиков. Это позволяет организации хранить контент для соблюдения нормативных требований или во время юридических и других расследований. Вот список функций хранения (также называемых удержанием) в Office 365:

- **[Судебное удержание:](create-a-litigation-hold.md)** Режимы, применяемые к почтовым ящикам пользователей в Exchange Online.

- **[Удержание для eDiscovery:](create-ediscovery-holds.md)** Содержит, связанные с основным делом eDiscovery в Центре безопасности и соответствия требованиям. К почтовым ящикам пользователей и к соответствующим почтовым ящикам для групп Microsoft 365 и Microsoft Teams можно применять операции eDiscovery.

- **[Удержание на месте:](https://docs.microsoft.com/Exchange/security-and-compliance/create-or-remove-in-place-holds)** Удержания, применяемые к почтовым ящикам пользователей с помощью средства In-Place eDiscovery & Hold в Центре администрирования Exchange в Exchange Online.

- **[Политики хранения Microsoft 365:](retention.md)** Можно настроить для сохранения (или сохранения и удаления) содержимого в почтовых ящиках пользователей в Exchange Online и в соответствующем почтовом ящике для групп Microsoft 365 и Microsoft Teams. Вы также можете создать политику хранения для сохранения бесед Skype для бизнеса, которые хранятся в почтовых ящиках пользователей.

  Существует два типа политик хранения Microsoft 365, которые могут быть назначены почтовым ящикам.

    - **Конкретные политики хранения расположения:** Это политики, которые назначены расположениям контента определенных пользователей. Используйте для получения сведений о политиках хранения, которые назначены определенным почтовым ящикам, с помощью cmdlet **Get-Mailbox** в Exchange Online PowerShell. Дополнительные сведения об этом типе политики хранения см. в разделе ["Политика"](create-retention-policies.md#a-policy-with-specific-inclusions-or-exclusions) с определенными включениями или исключениями из документации по политике хранения.

    - **Политики хранения для всей организации:** Это политики, которые назначены всем расположениям контента в организации. Чтобы получить сведения о политиках хранения для всей организации, используйте в Exchange Online PowerShell cmdlet **Get-OrganizationConfig.** Дополнительные сведения об этом типе политики хранения см. в разделе ["Политика"](create-retention-policies.md#a-policy-that-applies-to-entire-locations) политики, применяемой ко всем расположениям, из документации по политике хранения.

- **Метки хранения [Microsoft 365:](retention.md)** если пользователь применяет метку хранения Microsoft 365 (настроенную для хранения  или хранения и удаления содержимого) к любой папке или элементу в почтовом ящике, к почтовому ящику применяется удержание, как если бы почтовый ящик был помещен на хранение для судебного разбирательства или назначен политике хранения Microsoft 365. Дополнительные сведения см. в разделе "Определение почтовых ящиков на удержании", так как метка хранения применена к папке или разделу элемента в этой статье. [](#identifying-mailboxes-on-hold-because-a-retention-label-has-been-applied-to-a-folder-or-item)

Для управления почтовыми ящиками на удержании может потребоваться определить тип удержания, который помещается на почтовый ящик, чтобы можно было выполнять такие задачи, как изменение срока хранения, временное или окончательное снятие удержания или исключение почтового ящика из политики хранения Microsoft 365. В таких случаях первым шагом является определение типа удержания для почтового ящика. Так как для одного почтового ящика можно поместить несколько удержаний (и удержаний разных типов), необходимо определить все удержания, размещенные на почтовом ящике, если вы хотите удалить или изменить удержание.

## <a name="step-1-obtain-the-guid-for-holds-placed-on-a-mailbox"></a>Шаг 1. Получение GUID для приодержки почтового ящика

Вы можете выполнить следующие два cmdlet в Exchange Online PowerShell, чтобы получить GUID приоритетов, которые размещаются в почтовом ящике. Получив GUID, используйте его для определения конкретного удержания в шаге 2. Удержание для судебного разбирательства не определено guID. Для почтового ящика либо включено, либо отключено судебное разбирательства.

- **Get-Mailbox:** Используйте этот cmdlet, чтобы определить, включено ли хранение для судебного разбирательства для почтового ящика, и получить КОДЫ ДЛЯ удержаний eDiscovery, удержаний In-Place и политик хранения Microsoft 365, которые специально назначены почтовому ящику. В выходных данных этого cmdlet также будет указано, был ли почтовый ящик явно исключен из политики хранения для всей организации.

- **Get-OrganizationConfig:** Используйте этот cmdlet для получения кодовGUI для политик хранения на всей организации.

Сведения о том, как подключиться к Exchange Online PowerShell, см. в статье [Подключение к Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).

### <a name="get-mailbox"></a>Get-Mailbox

Чтобы получить сведения об удержаниях и политиках хранения Microsoft 365, примененных к почтовому ящику, запустите следующую команду.

```powershell
Get-Mailbox <username> | FL LitigationHoldEnabled,InPlaceHolds
```

> [!TIP]
> Если в свойстве InPlaceHolds слишком много значений и отображаются не все из них, можно выполнить команду, чтобы отобразить `Get-Mailbox <username> | Select-Object -ExpandProperty InPlaceHolds` каждый GUID в отдельной строке.

В следующей таблице описано, как определить различные типы удержаний на основе значений в свойстве *InPlaceHolds* при запуске **cmdlet Get-Mailbox.**


|Тип удержания  |Пример значения  |Определение удержания  |
|---------|---------|---------|
|Хранение для судебного разбирательства     |    `True`     |     Для почтового ящика включено судебное удержание, если для свойства *LitigationHoldEnabled* установлено такое же `True` свойство.    |
|Удержание для eDiscovery     |  `UniH7d895d48-7e23-4a8d-8346-533c3beac15d`       |   Свойство *InPlaceHolds содержит* GUID любого удержания, связанного с делом eDiscovery в Центре безопасности и соответствия требованиям. Вы можете сказать, что это удержание для eDiscovery, так как GUID начинается с префикса (который обозначает единое `UniH` удержание).      |
|Хранение на месте     |     `c0ba3ce811b6432a8751430937152491` <br/> или <br/> `cld9c0a984ca74b457fbe4504bf7d3e00de`  |     Свойство *InPlaceHolds* содержит GUID In-Place удержания, которое помещено в почтовый ящик. Вы можете сказать, что это In-Place, так как GUID либо не начинается с префикса, либо начинается с `cld` префикса.     |
|Политика хранения Microsoft 365, специально примененная к почтовому ящику     |    `mbxcdbbb86ce60342489bff371876e7f224:1` <br/> или <br/> `skp127d7cf1076947929bf136b7a2a8c36f:3`     |     Свойство InPlaceHolds содержит GUID любой конкретной политики хранения расположения, применяемой к почтовому ящику. Политики хранения можно определить, так как GUID начинается с `mbx` `skp` префикса или префикса. Префикс указывает, что политика хранения применяется к беседам Skype для бизнеса в почтовом ящике `skp` пользователя.    |
|Исключено из политики хранения Microsoft 365 для всей организации     |   `-mbxe9b52bf7ab3b46a286308ecb29624696`      |     Если почтовый ящик исключен из политики хранения Microsoft 365 для всей организации, GUID политики хранения, из которую исключается почтовый ящик, отображается в свойстве InPlaceHolds и задан по `-mbx` префиксу.    |

### <a name="get-organizationconfig"></a>Get-OrganizationConfig
Если при запускелета **Get-Mailbox** свойство *InPlaceHolds* пустое, к почтовому ящику может быть применена одна или несколько политик хранения Microsoft 365 для всей организации. Чтобы получить список GUID для политик хранения Microsoft 365 для всей организации, запустите следующую команду в Exchange Online PowerShell.

```powershell
Get-OrganizationConfig | FL InPlaceHolds
```

> [!TIP]
> Если в свойстве InPlaceHolds слишком много значений и отображаются не все из них, можно выполнить команду, чтобы отобразить `Get-OrganizationConfig | Select-Object -ExpandProperty InPlaceHolds` каждый GUID в отдельной строке.

В следующей таблице описаны различные типы удержаний на всей организации и идентифицировать каждый тип на основе кодовGUID, содержащихся в свойстве *InPlaceHolds,* при запуске cmdlet **Get-OrganizationConfig.**


|Тип удержания  |Пример значения  |Описание  |
|---------|---------|---------|
|Политики хранения Microsoft 365, применяемые к почтовым ящикам Exchange, общедоступным папок Exchange и чатам Teams    |      `mbx7cfb30345d454ac0a989ab3041051209:2`   |   Политики хранения для всей организации, применяемые к почтовым ящикам Exchange, общедоступным папок Exchange и чатам 1xN в Microsoft Teams, идентифицированы с помощью GUID, которые начинаются с `mbx` префикса. Примечание. Чаты 1xN хранятся в почтовом ящике отдельных участников чата.      |
|Политика хранения Microsoft 365, примененная к группам Microsoft 365 и сообщениям каналов Teams     |   `grp1a0a132ee8944501a4bb6a452ec31171:3`      |    Политики хранения на всей организации, применяемые к группам и сообщениям каналов Microsoft 365 в Microsoft Teams, идентифицированы с помощью GUID, которые начинаются с `grp` префикса. Сообщения канала заметок хранятся в почтовом ящике группы, связанном с командой Microsoft Team.     |

Дополнительные сведения о политиках хранения, применяемых к Microsoft Teams, см. в дополнительных сведениях о политиках хранения [для Microsoft Teams.](retention-policies-teams.md)

### <a name="understanding-the-format-of-the-inplaceholds-value-for-retention-policies"></a>Формат значения InPlaceHolds для политик хранения

Помимо префикса (MBX, skp или grp), который идентифицирует элемент в свойстве InPlaceHolds как политику хранения Microsoft 365, значение также содержит суффикс, который определяет тип действия хранения, настроенного для политики. Например, суффикс действия выделен полужирным шрифтом в следующих примерах:

   `skp127d7cf1076947929bf136b7a2a8c36f`**:1**

   `mbx7cfb30345d454ac0a989ab3041051209`**:2**

   `grp1a0a132ee8944501a4bb6a452ec31171`**:3**

В следующей таблице определены три возможных действия хранения:

|Значение  |Описание  |
|---------|---------|
|**1**     | Указывает, что политика хранения настроена на удаление элементов. Политика не сохраняет элементы.        |
|**2**    |    Указывает, что политика хранения настроена на хранение элементов. Политика не удаляет элементы по истечении срока хранения.     |
|**3**     |   Указывает, что политика хранения настроена на удержание элементов и их удаление по истечении срока хранения.      |

Дополнительные сведения о действиях хранения см. в разделе ["Хранение содержимого](create-retention-policies.md#retaining-content-for-a-specific-period-of-time) за определенный период времени".
   
## <a name="step-2-use-the-guid-to-identify-the-hold"></a>Шаг 2. Определение удержания с помощью GUID

После получения GUID для удержания, примененного к почтовому ящику, необходимо использовать этот GUID для определения удержания. В следующих разделах покажите, как определить имя удержания (и другие сведения) с помощью GUID удержания.

### <a name="ediscovery-holds"></a>Удержание данных, созданных с помощью обращения обнаружения электронных данных

Чтобы определить удержан & ие при обнаружении электронных данных, примененного к почтовому ящику, в PowerShell Центра безопасности и соответствия требованиям, запустите следующие команды. Используйте GUID (не включая префикс UniH) для удержания eDiscovery, которое вы определили в шаге 1. Первая команда создает переменную, которая содержит сведения об удержании. Эта переменная используется в других командах. Вторая команда отображает имя дела eDiscovery, с помощью которого связано удержание. Третья команда отображает имя удержания и список почтовых ящиков, к которые применяется удержание.

```powershell
$CaseHold = Get-CaseHoldPolicy <hold GUID without prefix>
```

```powershell
Get-ComplianceCase $CaseHold.CaseId | FL Name
```

```powershell
$CaseHold | FL Name,ExchangeLocation
```

Чтобы подключиться к PowerShell Центра & соответствия требованиям, см. &  [PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-scc-powershell)Центра безопасности и соответствия требованиям.

### <a name="in-place-holds"></a>Хранение на месте

Чтобы определить удержание In-Place, примененного к почтовому ящику, в Exchange Online PowerShell запустите следующую команду. Используйте GUID для удержания In-Place, которое вы определили в шаге 1. Команда отображает имя удержания и список почтовых ящиков, к которые применяется удержание.

```powershell
Get-MailboxSearch -InPlaceHoldIdentity <hold GUID> | FL Name,SourceMailboxes
```

Если GUID для In-Place удержания начинается с префикса, обязательно включайте префикс при запуске `cld` предыдущей команды.

> [!IMPORTANT]
> По мере того как мы продолжаем вкладывать средства в различные способы сохранения содержимого почтовых ящиков, мы объявляем о завершении In-Place в Центре администрирования Exchange (EAC). С 1 июля 2020 г. вы не сможете создавать новые In-Place в Exchange Online. Но вы по-прежнему сможете управлять In-Place в EAC или с помощью cmdlet **Set-MailboxSearch** в Exchange Online PowerShell. Однако с 1 октября 2020 г. вы не сможете управлять In-Place. Их можно удалить только в EAC или с помощью **cmdlet Remove-MailboxSearch.** Дополнительные сведения об отоимлении In-Place, см. в поддомене "Вымещать устаревшие средства [eDiscovery".](legacy-ediscovery-retirement.md)

### <a name="microsoft-365-retention-policies"></a>Политики хранения Microsoft 365

Запустите следующую команду в PowerShell Центра безопасности и соответствия & для идентификации политики хранения Microsoft 365 (для всей организации или определенного расположения), применяемой к почтовому ящику. Используйте GUID (не включая префикс MBX, skp или grp или суффикс действия), который вы определили на шаге 1.

```powershell
Get-RetentionCompliancePolicy <hold GUID without prefix or suffix> -DistributionDetail  | FL Name,*Location
```

## <a name="identifying-mailboxes-on-hold-because-a-retention-label-has-been-applied-to-a-folder-or-item"></a>Определение почтовых ящиков на удержании, так как метка хранения применена к папке или элементу

Всякий раз, когда пользователь применяет метку хранения, настроенную для хранения содержимого или сохранения и удаления содержимого в любой папке или элементе в почтовом ящике, свойству *complianceTagHoldApplied* почтового ящика задается **true.** В этом случае почтовый ящик считается на удержании, как если бы он был помещен на хранение для судебного разбирательства или назначен политике хранения Microsoft 365. Если *свойству ComplianceTagHoldApplied* присвоено **true,** могут произойти следующие события:

- При удалении почтового ящика или учетной записи пользователя он становится [неактивным.](inactive-mailboxes-in-office-365.md)
- Вы не можете отключить почтовый ящик (основной или архивный, если он включен).
- Элементы в почтовом ящике могут храниться дольше, чем ожидалось. Это происходит потому, что почтовый ящик находится на удержании и поэтому никакие элементы не удаляются окончательно (удаляются).

Чтобы просмотреть значение свойства *ComplianceTagHoldApplied,* запустите следующую команду в Exchange Online PowerShell:

```powershell
Get-Mailbox <username> |FL ComplianceTagHoldApplied
```

Дополнительные сведения о метах хранения см. [в подписях хранения.](retention.md#retention-labels)

## <a name="managing-mailboxes-on-delay-hold"></a>Управление почтовыми ящиками при удержании задержки

После удаления любого типа удержания из почтового ящика применяется *удержание* задержки. Это означает, что фактическое удаление удержания откладывается на 30 дней, чтобы предотвратить окончательное удаление (удаление) данных из почтового ящика. Это дает администраторам возможность искать или восстанавливать элементы почтового ящика, которые будут удалены после снятия удержания. Удержание задержки помещается на почтовый ящик при следующей обработке почтового ящика помощником для управляемых папок и обнаружении того, что удержание было удалено. В частности, удержание задержки применяется к почтовому ящику, когда помощник для управляемых папок задает для одного из следующих свойств почтового ящика **true:**

- **DelayHoldApplied:** Это свойство применяется к содержимому, связанному с электронной почтой (созданным пользователями Outlook и Outlook в Интернете), который хранится в почтовом ящике пользователя.

- **DelayReleaseHoldApplied:** Это свойство применяется к облачному содержимому (которое создается приложениями, не относя такими приложениями Outlook, как Microsoft Teams, Microsoft Forms и Microsoft Yammer), хранимым в почтовом ящике пользователя. Облачные данные, созданные приложением Майкрософт, обычно хранятся в скрытой папке в почтовом ящике пользователя.
 
 Если для почтового ящика заложено удержание задержки (если для одного из предыдущих свойств установлено **true),** почтовый ящик по-прежнему считается на удержании в течение неограниченного срока, как если бы почтовый ящик удерживался для судебного разбирательства. По истечении 30 дней срок удержания истекает, и Microsoft 365 автоматически попытается удалить удержание задержки (задав для свойства DelayHoldApplied или DelayReleaseHoldApplied свойство **False),** чтобы удержание было удалено. После того как для любого из этих свойств будет установлено **false,** соответствующие элементы, помеченные для удаления, будут удалены при следующей обработке почтового ящика помощником для управляемых папок.

Чтобы просмотреть значения свойств DelayHoldApplied и DelayReleaseHoldApplied для почтового ящика, запустите следующую команду в Exchange Online PowerShell.

```powershell
Get-Mailbox <username> | FL *HoldApplied*
```

Чтобы удалить удержание перед истечении срока действия, можно выполнить одну (или обе) следующие команды в Exchange Online PowerShell в зависимости от свойства, которое вы хотите изменить: 
 
```powershell
Set-Mailbox <username> -RemoveDelayHoldApplied
```

или
 
```powershell
Set-Mailbox <username> -RemoveDelayReleaseHoldApplied
```

Чтобы использовать *параметры RemoveDelayHoldApplied* или *RemoveDelayReleaseHoldApplied,* вам должна быть назначена роль удержания по юридическим основаниям в Exchange Online. 

Чтобы удалить удержание задержки для неактивного почтового ящика, в Exchange Online PowerShell запустите одну из следующих команд:

```powershell
Set-Mailbox <DN or Exchange GUID> -InactiveMailbox -RemoveDelayHoldApplied
```

или

```powershell
Set-Mailbox <DN or Exchange GUID> -InactiveMailbox -RemoveDelayReleaseHoldApplied
```

> [!TIP]
> Лучший способ указать неактивный почтовый ящик в предыдущей команде — использовать его различающейся имя или значение GUID Exchange. Используя одно из этих значений, вы не укажете по ошибке неверный почтовый ящик. 

Дополнительные сведения об использовании этих параметров для управления задержками см. в сообщении [Set-Mailbox.](https://docs.microsoft.com/powershell/module/exchange/set-mailbox)

При управлении почтовым ящиком с удержанием задержки следует иметь в виду следующее:

- Если свойству DelayHoldApplied или DelayReleaseHoldApplied присвоено имя **True,** а почтовый ящик (или соответствующая учетная запись пользователя) удаляется, почтовый ящик становится неактивным. Это происходит потому, что почтовый ящик считается на удержании, если для любого из свойств установлено свойство **True,** а удаление почтового ящика при удержании приводит к неактивному почтовому ящику. Чтобы удалить почтовый ящик и не сделать его неактивным, необходимо установить для обоих свойств **false.**

- Как было сказано ранее, почтовый ящик считается на удержании в течение неограниченного срока, если для свойства DelayHoldApplied или DelayReleaseHoldApplied установлено **true.** Однако это не означает, что *все* содержимое почтового ящика сохраняется. Это зависит от значения, установленного для каждого свойства. Например, предположим, что оба свойства  имеют true, так как из почтового ящика удаляются удерживает. Затем удаляется только удержание задержки, примененное к облачным данным, не относящегося к Outlook (с помощью параметра *RemoveDelayReleaseHoldApplied).* При следующей обработке почтового ящика помощником для управляемых папок элементы, не относящиеся к Outlook, помечались для удаления. Все элементы Outlook, помеченные для удаления, не будут удалены, так как для свойства DelayHoldApplied по-прежнему установлено свойство **True.** Обратное также верно: если для DelayHoldApplied за установлено false, а для DelayReleaseHoldApplied — **true,** то будут списываться только элементы Outlook, помеченные для удаления. 

## <a name="next-steps"></a>Дальнейшие действия

После определения удержаний, применяемых к почтовому ящику, можно выполнять такие задачи, как изменение срока удержания, временное или окончательное снятие удержания или исключение неактивного почтового ящика из политики хранения Microsoft 365. Дополнительные сведения о выполнении задач, связанных с удерживаниями, см. в одном из следующих разделов:

- Запустите команду [Set-RetentionCompliancePolicy -Identity \<Policy Name> -AddExchangeLocationException \<user mailbox> ](https://docs.microsoft.com/powershell/module/exchange/set-retentioncompliancepolicy) в PowerShell Центра безопасности и & соответствия требованиям, чтобы исключить почтовый ящик из политики хранения Microsoft 365 для всей организации. Эту команду можно использовать только для политик хранения, у которых значение свойства *ExchangeLocation* равно `All` .

- Чтобы исключить неактивный почтовый ящик из политики хранения Microsoft 365 для всей организации, запустите команду [Set-Mailbox -ExcludeFromOrgHolds \<hold GUID without prefix or suffix> ](https://docs.microsoft.com/powershell/module/exchange/set-mailbox) в Exchange Online PowerShell.

- [Изменение срока хранения неактивного почтового ящика](change-the-hold-duration-for-an-inactive-mailbox.md)

- [Удаление неактивного почтового ящика](delete-an-inactive-mailbox.md)

- [Удаление элементов в папке "Элементы с возможностью восстановления" облачных почтовых ящиков на удержании](delete-items-in-the-recoverable-items-folder-of-mailboxes-on-hold.md)
