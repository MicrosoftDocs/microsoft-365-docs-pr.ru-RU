---
title: Как определить тип удержания, примененного для почтового ящика Exchange Online
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
ms.collection: M365-security-compliance
localization_priority: Normal
search.appverid:
- MET150
ms.assetid: 6057daa8-6372-4e77-a636-7ea599a76128
ms.custom:
- seo-marvel-apr2020
description: Узнайте, как определить различные типы удержания, которые можно поместить на Exchange Online почтовом ящике в Microsoft 365.
ms.openlocfilehash: 0fdfbd4503a4ddffd2ce2dd97c6af42684aea293
ms.sourcegitcommit: 27b2b2e5c41934b918cac2c171556c45e36661bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "50917539"
---
# <a name="how-to-identify-the-type-of-hold-placed-on-an-exchange-online-mailbox"></a>Как определить тип удержания, примененного для почтового ящика Exchange Online

В этой статье рассказывается о том, как определить вложенные Exchange Online почтовые ящики в Microsoft 365.

Microsoft 365 предлагает несколько способов, с которыми организация может запретить постоянное удаление контента почтовых ящиков. Это позволяет вашей организации сохранять контент для соответствия требованиям или во время юридических и других типов расследований. Вот список функций хранения (также называемых удержаний) в Office 365:

- **[Судебное удержание:](create-a-litigation-hold.md)** Удерживает, которые применяются к почтовым ящикам пользователей в Exchange Online.

- **[удержание электронных обнаружений:](create-ediscovery-holds.md)** Удерживает, связанное с делом core eDiscovery в центре безопасности и соответствия требованиям. Удерживает eDiscovery можно применить к почтовым ящикам пользователей и к соответствующему почтовому ящику для Microsoft 365 групп и Microsoft Teams.

- **[Удержание на месте:](/Exchange/security-and-compliance/create-or-remove-in-place-holds)** Удерживает, которые применяются к почтовым ящикам пользователей с помощью средства In-Place eDiscovery & Hold в центре администрирования Exchange в Exchange Online. 

   > [!NOTE]
   > In-Place, и вы больше не можете создавать In-Place и применять их к почтовым ящикам. Однако In-Place может по-прежнему применяться к почтовым ящикам в организации, поэтому они включены в эту статью. Дополнительные сведения см. в дополнительных сведениях о выходе на пенсию устаревших средств [eDiscovery.](legacy-ediscovery-retirement.md#in-place-ediscovery-and-in-place-holds-in-the-exchange-admin-center)

- **[Microsoft 365 политики хранения:](retention.md)** Можно настроить для сохранения (или сохранения и удаления) контента в почтовых ящиках пользователей в Exchange Online и в соответствующем почтовом ящике для Microsoft 365 групп и Microsoft Teams. Вы также можете создать политику хранения, чтобы сохранить Skype для бизнеса беседы, которые хранятся в почтовых ящиках пользователей.

  Существует два типа политик Microsoft 365 хранения, которые могут быть назначены почтовым ящикам.

    - **Конкретные политики хранения расположения:** Это политики, которые назначены расположениям контента определенных пользователей. Для получения сведений о политиках хранения, присвоенных определенным почтовым ящикам, в Exchange Online PowerShell используется комлет **Get-Mailbox.** Дополнительные сведения о политике хранения этого типа см. в разделе [Политика A](create-retention-policies.md#a-policy-with-specific-inclusions-or-exclusions) с конкретными включениями или исключениями из документации по политике хранения.

    - **Политики хранения на всей организации:** Это политики, которые назначены всем расположениям контента в организации. Для получения сведений о политиках хранения в организации в Exchange Online PowerShell используется комлет **Get-OrganizationConfig.** Дополнительные сведения об этом типе политики хранения см. в разделе [Политика A,](create-retention-policies.md#a-policy-that-applies-to-entire-locations) применяемая ко всем расположениям из документации по политике хранения.

- **[Microsoft 365](retention.md)** метки хранения. Если пользователь применяет метку хранения Microsoft 365 (которая настроена для сохранения содержимого или  сохранения и удаления контента) к любой папке или элементу в почтовом ящике, на почтовый ящик помещается удержание, как если бы почтовый ящик был помещен на хранение судебного разбирательства или назначен политике хранения Microsoft 365. Дополнительные сведения см. в разделе [Определение](#identifying-mailboxes-on-hold-because-a-retention-label-has-been-applied-to-a-folder-or-item) почтовых ящиков на удержании, так как метка хранения была применена к папке или разделу элементов в этой статье.

Чтобы управлять почтовыми ящиками в удержании, может потребоваться определить тип удержания, размещенного на почтовом ящике, чтобы можно было выполнять такие задачи, как изменение длительности хранения, временное или постоянное удаление удержания или исключение почтового ящика из политики хранения Microsoft 365. В этих случаях первым шагом является определение типа удержания, размещенного на почтовом ящике. А так как на одном почтовом ящике можно разместить несколько удержаний (и различные типы удержаний), необходимо определить все удержания, размещенные на почтовом ящике, если вы хотите удалить или изменить удержание.

## <a name="step-1-obtain-the-guid-for-holds-placed-on-a-mailbox"></a>Шаг 1. Получение GUID для удерживается в почтовом ящике

Вы можете запустить следующие два cmdlets в Exchange Online PowerShell, чтобы получить GUID удерживает, которые размещены на почтовом ящике. После получения GUID он используется для определения определенного удержания в шаге 2. Удержание судебного разбирательства не определено GUID. Для почтового ящика включаем или отключаем тяжбы.

- **Get-Mailbox:** Используйте этот комдлет, чтобы определить, включено ли удержание судебного разбирательства для почтового ящика, и чтобы получить GUID-коды для хранения электронных данных, In-Place удержаний и Microsoft 365 политик хранения, которые специально назначены почтовому ящику. Выход этого комлета также указывает, был ли почтовый ящик явно исключен из политики хранения по всей организации.

- **Get-OrganizationConfig:** Используйте этот кодлет для получения GUID-кодов для политик хранения для всей организации.

Сведения о том, как подключиться к Exchange Online PowerShell, см. в статье [Подключение к Exchange Online PowerShell](/powershell/exchange/connect-to-exchange-online-powershell).

### <a name="get-mailbox"></a>Get-Mailbox

Запустите следующую команду, чтобы получить сведения о политиках хранения Microsoft 365, применяемых к почтовому ящику.

```powershell
Get-Mailbox <username> | FL LitigationHoldEnabled,InPlaceHolds
```

> [!TIP]
> Если в свойстве InPlaceHolds слишком много значений и не все из них отображаются, можно запустить команду для отображения каждого GUID в `Get-Mailbox <username> | Select-Object -ExpandProperty InPlaceHolds` отдельной строке.

В следующей таблице описывается определение различных типов удержаний на основе значений в свойстве *InPlaceHolds* при запуске комлета **Get-Mailbox.**

|Тип удержания  |Пример значения  |Определение удержания  |
|---------|---------|---------|
|Хранение для судебного разбирательства     |    `True`     |     Удержание судебного разбирательства включено для почтового ящика, если задано свойство *LitigationHoldEnabled.* `True`    |
|удержание электронных обнаружений     |  `UniH7d895d48-7e23-4a8d-8346-533c3beac15d`       |   Свойство *InPlaceHolds содержит* GUID любого удержания, связанного с делом об обнаружении электронных данных в центре безопасности и соответствия требованиям. Вы можете сказать, что это удержание для проверки электронных обнаружений, так как GUID начинается с префикса (который обозначает `UniH` единое удержание).      |
|Хранение на месте     |     `c0ba3ce811b6432a8751430937152491` <br/> или <br/> `cld9c0a984ca74b457fbe4504bf7d3e00de`  |     Свойство *InPlaceHolds* содержит GUID In-Place удержания, размещенного на почтовом ящике. Вы можете сказать, что это In-Place, так как GUID либо не начинается с префикса, либо начинается с `cld` префикса.     |
|Microsoft 365 политики хранения, специально примененной к почтовому ящику     |    `mbxcdbbb86ce60342489bff371876e7f224:1` <br/> или <br/> `skp127d7cf1076947929bf136b7a2a8c36f:3`     |     Свойство InPlaceHolds содержит GUID-интерфейсы любой определенной политики хранения расположения, применяемой к почтовому ящику. Политики хранения можно определить, так как GUID начинается с `mbx` `skp` префикса или префикса. Префикс указывает, что политика хранения применяется Skype для бизнеса бесед в почтовом `skp` ящике пользователя.    |
|Исключено из политики хранения Microsoft 365 всей организации     |   `-mbxe9b52bf7ab3b46a286308ecb29624696`      |     Если почтовый ящик исключен из политики хранения Microsoft 365 всей организации, guID для политики хранения, из которую исключается почтовый ящик, отображается в свойстве InPlaceHolds и идентифицирована `-mbx` префиксом.    |

### <a name="get-organizationconfig"></a>Get-OrganizationConfig
Если свойство *InPlaceHolds* пусто при запуске комлета **Get-Mailbox,** к почтовому ящику по-прежнему может применяться одна или несколько политик хранения Microsoft 365 организации. Запустите следующую команду в Exchange Online PowerShell, чтобы получить список GUID-интерфейсов для политик хранения Microsoft 365 организации.

```powershell
Get-OrganizationConfig | FL InPlaceHolds
```

> [!TIP]
> Если в свойстве InPlaceHolds слишком много значений и не все из них отображаются, можно запустить команду для отображения каждого GUID в `Get-OrganizationConfig | Select-Object -ExpandProperty InPlaceHolds` отдельной строке.

В следующей таблице описываются различные типы удерживания для всей организации и определение каждого типа на основе GUID-кодов, содержащихся в свойстве *InPlaceHolds* при запуске **cmdlet Get-OrganizationConfig.**

|Тип удержания  |Пример значения  |Описание  |
|---------|---------|---------|
|Microsoft 365 политики хранения, применяемые Exchange почтовых ящиков, Exchange общедоступных папок и Teams чатов    |      `mbx7cfb30345d454ac0a989ab3041051209:2`   |   Политики хранения для всех организаций, применяемые Exchange почтовых ящиков, Exchange общедоступных папок и 1xN-чатов в Microsoft Teams, идентифицированы GUID-интерфейсами, которые начинаются с `mbx` префикса. Чаты Примечание 1xN хранятся в почтовом ящике отдельных участников чата.      |
|Microsoft 365 для Microsoft 365 групп и Teams каналов     |   `grp1a0a132ee8944501a4bb6a452ec31171:3`      |    Политики хранения на всей организации, применяемые Microsoft 365 групп и сообщений каналов в Microsoft Teams, идентифицированы GUID-интерфейсами, которые начинаются с `grp` префикса. Сообщения канала примечание хранятся в групповом почтовом ящике, связанном с командой Майкрософт.     |

Дополнительные сведения о политиках хранения, применяемых к Microsoft Teams, см. в дополнительных сведениях о политиках хранения для [Microsoft Teams.](retention-policies-teams.md)

### <a name="understanding-the-format-of-the-inplaceholds-value-for-retention-policies"></a>Понимание формата значения InPlaceHolds для политик хранения

Помимо префикса (mbx, skp или grp), который определяет элемент в свойстве InPlaceHolds как политику хранения Microsoft 365, это значение также содержит суффикс, который определяет тип действия хранения, настроенный для политики. Например, в следующих примерах суффикс действий выделяется полужирным шрифтом:

   `skp127d7cf1076947929bf136b7a2a8c36f`**:1**

   `mbx7cfb30345d454ac0a989ab3041051209`**:2**

   `grp1a0a132ee8944501a4bb6a452ec31171`**:3**

В следующей таблице определены три возможных действия хранения:

|Значение  |Описание  |
|---------|---------|
|**1**     | Указывает, что политика хранения настроена для удаления элементов. Политика не сохраняет элементы.        |
|**2**    |    Указывает, что политика хранения настроена для хранения элементов. Политика не удаляет элементы по истечении срока хранения.     |
|**3**     |   Указывает, что политика хранения настроена для хранения элементов и их удаления по истечении срока хранения.      |

Дополнительные сведения о действиях хранения см. в разделе [Сохранение контента для определенного периода](create-retention-policies.md#retaining-content-for-a-specific-period-of-time) времени.
   
## <a name="step-2-use-the-guid-to-identify-the-hold"></a>Шаг 2. Использование GUID для определения удержания

После получения GUID для удержания, который применяется к почтовому ящику, следующим шагом будет использование этого GUID для идентификации удержания. В следующих разделах покажите, как определить имя удержания (и другие сведения) с помощью GUID удержания.

### <a name="ediscovery-holds"></a>Удержание данных, созданных с помощью обращения обнаружения электронных данных

Запустите следующие команды в центре & PowerShell, чтобы определить удержание электронных данных, которое применяется к почтовому ящику. Используйте GUID (не включая префикс UniH) для удержания электронных обнаружений, которое было определено в шаге 1. 

Чтобы подключиться к центру & безопасности PowerShell, Подключение в центре & [PowerShell.](/powershell/exchange/connect-to-scc-powershell)

Первая команда создает переменную, которая содержит сведения о удержании. Эта переменная используется в других командах. Вторая команда отображает имя связанного с удержанием случая электронных разыскных открытий. Третья команда отображает имя удержания и список почтовых ящиков, к которые применяется удержание.

```powershell
$CaseHold = Get-CaseHoldPolicy <hold GUID without prefix>
```

```powershell
Get-ComplianceCase $CaseHold.CaseId | FL Name
```

```powershell
$CaseHold | FL Name,ExchangeLocation
```

### <a name="in-place-holds"></a>Хранение на месте

Запустите следующую команду в Exchange Online PowerShell, чтобы определить In-Place удержание, которое применяется к почтовому ящику. Используйте GUID для удержания In-Place, который был определен в шаге 1. Команда отображает имя удержания и список почтовых ящиков, к которые применяется удержание.

```powershell
Get-MailboxSearch -InPlaceHoldIdentity <hold GUID> | FL Name,SourceMailboxes
```

Если GUID для In-Place удержания начинается с префикса, обязательно включайте префикс при запуске `cld` предыдущей команды.

> [!IMPORTANT]
> По мере того как мы продолжаем вкладывать средства в различные способы сохранения контента почтовых ящиков, мы объявляем о завершении In-Place держит в центре администрирования Exchange (EAC). С 1 июля 2020 г. вы не сможете создавать новые In-Place в Exchange Online. Но вы все равно сможете управлять In-Place в EAC или с помощью **cmdlet Set-MailboxSearch** в Exchange Online PowerShell. Однако с 1 октября 2020 г. вы не сможете управлять In-Place holds. Удалить их можно будет только в EAC или с помощью **cmdlet Remove-MailboxSearch.** Дополнительные сведения об уходе из In-Place содержится в см. в In-Place устаревших средств [eDiscovery.](legacy-ediscovery-retirement.md)

### <a name="microsoft-365-retention-policies"></a>Microsoft 365 политики хранения

Запустите следующую команду в Центре & безопасности PowerShell, чтобы установить Microsoft 365 хранения (для всей организации или определенного расположения), применяемого к почтовому ящику. Используйте GUID (не включая префикс mbx, skp или grp или суффикс действия), который вы определили в шаге 1.

```powershell
Get-RetentionCompliancePolicy <hold GUID without prefix or suffix> -DistributionDetail  | FL Name,*Location
```

## <a name="identifying-mailboxes-on-hold-because-a-retention-label-has-been-applied-to-a-folder-or-item"></a>Определение почтовых ящиков на удержании, так как метка хранения была применена к папке или элементу

Всякий раз, когда пользователь применяет метку хранения, настроенную для хранения контента или сохранения, а затем удаления контента в любой папке или элементе в почтовом ящике, свойство *ComplianceTagHoldApplied* для почтового ящика задалось **true.** В этом случае почтовый ящик считается удержанным, как если бы он был помещен в удержание судебного разбирательства или назначен политике хранения Microsoft 365 хранения. Когда свойство *ComplianceTagHoldApplied* настроено на **True,** могут возникать следующие вещи:

- Если почтовый ящик или учетная запись пользователя удалена, почтовый ящик становится [неактивным почтовым ящиком.](inactive-mailboxes-in-office-365.md)
- Отключение почтового ящика (основного почтового ящика или архивного почтового ящика, если включено, не удастся).
- Элементы в почтовом ящике могут храниться дольше, чем ожидалось. Это происходит потому, что почтовый ящик находится на удержании и поэтому никакие элементы не удаляются (удаляются).

Чтобы просмотреть значение свойства *ComplianceTagHoldApplied,* запустите следующую команду в Exchange Online PowerShell:

```powershell
Get-Mailbox <username> |FL ComplianceTagHoldApplied
```

Дополнительные сведения о метки хранения см. в см. [в нем.](retention.md#retention-labels)

## <a name="managing-mailboxes-on-delay-hold"></a>Управление почтовыми ящиками при удержании задержки

После удаления любого типа удержания из почтового ящика применяется *удержание* задержки. Это означает, что фактическое удаление удержания откладывается на 30 дней, чтобы предотвратить удаление (удаление) данных из почтового ящика. Это дает администраторам возможность поиска или восстановления элементов почтовых ящиков, которые будут удалены после удаления удержания. Удержание задержки помещается в почтовый ящик при следующем обработке помощником управляемых папок почтового ящика и обнаружении удаления удержания. В частности, удержание задержки применяется к почтовому ящику, когда помощник управляемых папок задает одно из следующих свойств почтовых ящиков **true:**

- **DelayHoldApplied:** Это свойство относится к контенту, связанному с электронной почтой (созданным пользователями с Outlook и Outlook в Интернете), хранимым в почтовом ящике пользователя.

- **DelayReleaseHoldApplied:** Это свойство применяется к облачному контенту (генерируемому не Outlook приложениями, такими как Microsoft Teams, Microsoft Forms и Microsoft Yammer), хранимым в почтовом ящике пользователя. Облачные данные, созданные приложением Майкрософт, обычно хранятся в скрытой папке в почтовом ящике пользователя.

При удержании задержки в почтовом ящике (если для любого из предыдущих свойств установлено **true),** почтовый ящик по-прежнему считается удержанным в течение неограниченного срока удержания, как если бы почтовый ящик был на удержании судебного разбирательства. По истечении 30 дней срок задержки истекает, и Microsoft 365 будет автоматически пытаться удалить удержание задержки (установив свойство DelayHoldApplied или DelayReleaseHoldApplied false), чтобы удержание было удалено. После того как любой из этих свойств задают **false,** соответствующие элементы, помеченные для удаления, будут удалены при следующей обработке почтового ящика помощником управляемых папок.

Чтобы просмотреть значения свойств DelayHoldApplied и DelayReleaseHoldApplied для почтового ящика, запустите следующую команду в Exchange Online PowerShell.

```powershell
Get-Mailbox <username> | FL *HoldApplied*
```

Чтобы удалить удержание задержки до истечения срока действия, можно выполнить одну (или обе) следующие команды в Exchange Online PowerShell в зависимости от свойства, которое необходимо изменить:

```powershell
Set-Mailbox <username> -RemoveDelayHoldApplied
```

Или

```powershell
Set-Mailbox <username> -RemoveDelayReleaseHoldApplied
```

Для использования параметров *RemoveDelayHoldApplied* или *RemoveDelayReleaseHoldApplied* вам должна быть назначена роль legal Hold в Exchange Online. 

Чтобы удалить удержание задержки на неактивном почтовом ящике, запустите одну из следующих команд в Exchange Online PowerShell:

```powershell
Set-Mailbox <DN or Exchange GUID> -InactiveMailbox -RemoveDelayHoldApplied
```

Или

```powershell
Set-Mailbox <DN or Exchange GUID> -InactiveMailbox -RemoveDelayReleaseHoldApplied
```

> [!TIP]
> Лучший способ указать неактивный почтовый ящик в предыдущей команде — использовать его значение Exchange GUID. Используя одно из этих значений, вы не укажете по ошибке неверный почтовый ящик. 

Дополнительные сведения об использовании этих параметров для управления задержками см. в [списке Set-Mailbox.](/powershell/module/exchange/set-mailbox)

При управлении почтовым ящиком при удержании задержки следует помнить следующие вещи:

- Если свойство DelayHoldApplied или DelayReleaseHoldApplied настроено на **True** и почтовый ящик (или соответствующая учетная запись пользователя) удаляется, почтовый ящик становится неактивным почтовым ящиком. Это происходит потому, что почтовый ящик считается удержанным, если для любого свойства установлено **true,** и удаление почтового ящика при удержании приводит к неактивному почтовому ящику. Чтобы удалить почтовый ящик и не сделать его неактивным, необходимо установить оба свойства **false**.

- Как уже говорилось ранее, почтовый ящик считается отложенным на неограниченный срок удержания, если свойство DelayHoldApplied или DelayReleaseHoldApplied настроено на **True**. Однако это не означает, *что* все содержимое в почтовом ящике сохраняется. Это зависит от значения, за установленного для каждого свойства. Например, предположим, что оба свойства настроены как **True,** так как из почтового ящика удаляются удерживает. Затем удаляется только удержание задержки, применяемая к облачным данным Outlook (с помощью *параметра RemoveDelayReleaseHoldApplied).* При следующем обработке помощником управляемых папок почтового ящика Outlook элементы, помеченные для удаления. Все Outlook, помеченные для удаления, не будут удалены, так как свойство DelayHoldApplied по-прежнему настроено на **True.** Кроме того, верно и обратное: если delayHoldApplied задает false, а DelayReleaseHoldApplied — **True,** то будет удалено только Outlook элементов, помеченных для удаления. 

## <a name="next-steps"></a>Дальнейшие действия

После определения удержаний, применяемых к почтовому ящику, можно выполнить такие задачи, как изменение продолжительности удержания, временное или постоянное удаление удержания или исключение неактивного почтового ящика из политики хранения Microsoft 365 хранения. Дополнительные сведения о выполнении задач, связанных с удерживаниями, см. в одном из следующих разделов:

- Запустите команду [Set-RetentionCompliancePolicy \<Policy Name> -Identity -AddExchangeLocationException \<user mailbox> ](/powershell/module/exchange/set-retentioncompliancepolicy) в центре безопасности & PowerShell, чтобы исключить почтовый ящик из политики хранения Microsoft 365 всей организации. Эта команда может использоваться только для политик хранения, где значение свойства *ExchangeLocation* равно `All` .

- [Изменение срока хранения неактивного почтового ящика](change-the-hold-duration-for-an-inactive-mailbox.md)

- [Удаление неактивного почтового ящика](delete-an-inactive-mailbox.md)

- [Удаление элементов в папке "Элементы с возможностью восстановления" облачных почтовых ящиков на удержании](delete-items-in-the-recoverable-items-folder-of-mailboxes-on-hold.md)