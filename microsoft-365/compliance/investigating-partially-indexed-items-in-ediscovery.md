---
title: Изучение частично индексных элементов в eDiscovery
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
audience: Admin
ms.topic: reference
ms.service: O365-seccomp
localization_priority: Normal
ms.collection: M365-security-compliance
search.appverid:
- MOE150
- MET150
ms.assetid: 4e8ff113-6361-41e2-915a-6338a7e2a1ed
ms.custom:
- seo-marvel-apr2020
description: Узнайте, как управлять частично индексными элементами (также называемыми неиндексуалными элементами) из Exchange, SharePoint и OneDrive для бизнеса организации.
ms.openlocfilehash: c24fb2d9b633181538d76cf35e27dae1824b311d
ms.sourcegitcommit: f000358c01a8006e5749a86b256300ee3a73174c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/24/2021
ms.locfileid: "51994808"
---
# <a name="investigating-partially-indexed-items-in-ediscovery"></a>Изучение частично индексных элементов в eDiscovery

Поиск по обнаружению электронных данных, который вы Microsoft 365 центра соответствия требованиям, автоматически включает частично индексные элементы в предполагаемые результаты поиска при выполнении поиска. Частично индексация элементов Exchange почтовых ящиков и документов на сайтах SharePoint и OneDrive для бизнеса, которые по каким-то причинам не были полностью индексироваться для поиска. Большинство сообщений электронной почты и документов сайта успешно индексироваться, поскольку они подпадают под ограничения индексации [для сообщений электронной почты](limits-for-content-search.md#indexing-limits-for-email-messages). Однако некоторые элементы могут превышать эти ограничения индексации и будут частично индексироваться. Вот другие причины, по которым элементы не могут индексироваться для поиска и возвращаются в качестве частично индексных элементов при запуске поиска по обнаружению электронных обнаружений:
  
- Сообщения электронной почты имеют присоединенный файл без допустимой обработки, например файлов изображений; это самая распространенная причина частично индексации элементов электронной почты.

- В сообщение электронной почты вложено слишком много файлов.

- Размер файла, вложенного в сообщение электронной почты, превышает допустимый.

- Тип файла поддерживает индексирование, но произошла ошибка индексирования определенного файла.

Несмотря на то, что он изменяется, большинство клиентов организаций имеют менее 1% контента по объему и менее 12% контента по размеру, который частично индексировали. Разница между объемом и размером заключается в том, что более крупные файлы имеют более высокую вероятность содержать содержимое, которое не может быть полностью проиндексироваться.
  
## <a name="why-does-the-partially-indexed-item-count-change-for-a-search"></a>Почему для поиска меняется частично индексация элементов?

После запуска поиска по обнаружению электронных данных общее число и размер частично индексированных элементов в поисковых расположениях перечислены в статистике результатов поиска, отображаемой в подробной статистике поиска. Обратите внимание,  *что*  в статистике поиска эти элементы называются неиндексуалами. Вот несколько вещей, которые влияют на количество частично индексных элементов, возвращаемого в результатах поиска:
  
- Если элемент частично проиндексировали и соответствует запросу поиска, он включается как в число (и размер) элементов результатов поиска, так и частично индексные элементы. Однако при экспорте результатов этого же поиска элемент включается только с набором результатов поиска; он не включен в качестве частично индексного элемента.

- Частично индексированные элементы, расположенные на сайтах SharePoint и  OneDrive, не включаются в оценку частично индексированных элементов, отображаемую в подробной статистике поиска. Однако частично индексируемые элементы можно экспортировать при экспорте результатов поиска об обнаружении электронных обнаружений. Например, если искать только сайты, предполагаемое число частично индексных элементов будет нулевым.
  
## <a name="calculating-the-ratio-of-partially-indexed-items-in-your-organization"></a>Вычисление соотношения частично индексных элементов в организации

Чтобы понять, как организация подвержена частично индексации элементов, можно выполнить поиск всего контента во всех почтовых ящиках (с помощью пустого запроса на ключевое слово). В следующем примере ниже 56 208 (4830 МБ) полностью индексировали элементы и 470 (316 МБ) частично индексировали элементы.
  
![Пример статистики поиска, показывающая частично индексные элементы](../media/0f6a5cf7-4c98-44a0-a0dd-5aed67124641.png)
  
Процент частично индексных элементов можно определить с помощью следующих вычислений.
  
 **Для вычисления соотношения частично индексных элементов в организации:**

`(Total number of partially indexed items/Total number of items) x 100`

`(470/56,208) x 100 = 0.84%`

С помощью результатов поиска из предыдущего примера частично индексируется 0,84% всех элементов почтовых ящиков.
  
 **Чтобы рассчитать процент от размера частично индексных элементов в организации:**

`(Size of all partially indexed items/Size of all items) x 100`

`(316 MB/4830 MB) x 100 = 6.54%`

Таким образом, в предыдущем примере 6,54% от общего размера элементов почтовых ящиков из частично индексных элементов. Как уже говорилось ранее, большинство клиентов организаций имеют менее 1% контента по объему и менее 12% контента по размеру, который частично индексировали.

## <a name="working-with-partially-indexed-items"></a>Работа с частично индексными элементами

В случаях, когда необходимо частично изучить элементы, чтобы проверить, что [](export-a-content-search-report.md) они не содержат релевантные сведения, можно экспортировать отчет о поиске контента, содержащий сведения о частично индексируемом элементе. При экспорте отчета о поиске контента обязательно выберите один из вариантов экспорта, который включает частично индексируемые элементы.
  
![Выберите второй или третий вариант экспорта частично индексных элементов](../media/624a62b4-78f7-4329-ab5d-e62e3b369885.png)
  
При экспорте результатов поиска электронных данных или отчета поиска с помощью одного из этих вариантов экспорт включает отчет с именем Unindexed Items.csv. В этом отчете содержится большая часть той же информации, что и ResultsLog.csv файл; однако, файл Items.csv Unindexed также включает два поля, связанные с частично индексными элементами: **Теги** ошибок и **Свойства ошибок.** В этих полях содержатся сведения об ошибке индексации для каждого частично индексного элемента. Использование сведений в этих двух полях поможет определить, влияет ли ошибка индексации на конкретное исследование. В этом случае можно выполнить целенаправленный поиск, получить и экспортировать определенные сообщения электронной почты и SharePoint или OneDrive, чтобы проверить их, чтобы определить, имеют ли они отношение к вашему расследованию. Инструкции пошаговым образом см. в инструкции [Подготовка CSV-файла](csv-file-for-an-id-list-content-search.md)для целевого поиска в Office 365.

> [!NOTE]
> Файл Единой Items.csv также содержит поля с именем **Тип ошибки** и **сообщение об ошибке.** Это устаревшие поля, содержащие сведения, аналогичные сведениям  в полях **Теги** ошибок и Свойства ошибок, но с менее подробными сведениями. Можно смело игнорировать эти устаревшие поля.
  
## <a name="errors-related-to-partially-indexed-items"></a>Ошибки, связанные с частично индексациями элементов

Теги ошибок состоит из двух частей информации: ошибки и типа файла. Например, в этой паре типа ошибки/файла:

```text
 parseroutputsize_xls
```

 `parseroutputsize` является ошибкой `xls` и является типом файла, в который произошла ошибка. В тех случаях, когда тип файла не был распознана или тип файла не применяется к ошибке, вы увидите значение на месте `noformat` типа файла.
  
Ниже приводится список ошибок индексации и описание возможной причины ошибки.
  
| Тег ошибки | Описание |
|:-----|:-----|
| `attachmentcount` <br/> |В сообщении электронной почты было слишком много вложений, и некоторые из этих вложений не обрабатывались.  <br/> |
| `attachmentdepth` <br/> |Ретривер контента и парсер документов обнаружили слишком много уровней вложений, вложенных в другие вложения. Некоторые из этих вложений не были обработаны.  <br/> |
| `attachmentrms` <br/> |Вложение не удалось декодировать, так как оно было защищено RMS.  <br/> |
| `attachmentsize` <br/> |Файл, прикрепленный к сообщению электронной почты, был слишком большим и не мог быть обработан.  <br/> |
| `indexingtruncated` <br/> |При записи обработанного сообщения электронной почты в индекс одно из индексируемых свойств было слишком большим и было усечено. Усеченные свойства перечислены в поле Свойства ошибок.  <br/> |
| `invalidunicode` <br/> |Сообщение электронной почты содержит текст, который не может быть обработан как допустимый Юникод. Индексация этого элемента может быть неполной.  <br/> |
| `parserencrypted` <br/> |Содержимое вложения или сообщения электронной почты шифруется, Microsoft 365 не удалось расшифровать содержимое.  <br/> |
| `parsererror` <br/> |Неизвестная ошибка произошла при размыве. Как правило, это является результатом ошибки программного обеспечения или сбоя службы.  <br/> |
| `parserinputsize` <br/> |Вложение было слишком большим для обработки размерщика, и его обработка не была выполнена или не выполнена.  <br/> |
| `parsermalformed` <br/> |Вложение было неправильно обработано и не могло быть обработано с помощью parser. Этот результат может быть обусловлен старыми форматами файлов, файлами, созданными несовместимым программным обеспечением, или вирусами, которые делают вид, что они не являются заявленными.  <br/> |
| `parseroutputsize` <br/> |Вывод при размыве вложения был слишком большим и его пришлось усечено.  <br/> |
| `parserunknowntype` <br/> |Вложение имеет тип файла, который Microsoft 365 не удалось обнаружить.  <br/> |
| `parserunsupportedtype` <br/> |Вложение имеет тип файла, который можно Office 365, но его размыв не поддерживается.  <br/> |
| `propertytoobig` <br/> |Значение свойства электронной почты в Exchange Store было слишком большим, чтобы получить и сообщение не удалось обрабатывать. Обычно это происходит только с свойством тела сообщения электронной почты.  <br/> |
| `retrieverrms` <br/> |Ретривер контента не смог расшифровать сообщение, защищенное от RMS.  <br/> |
| `wordbreakertruncated` <br/> |Слишком много слов было обнаружено в документе во время индексации. Обработка свойства остановлена при достижении предела, и свойство усечено.  <br/> |

Поля ошибок описывают, на какие поля влияет ошибка обработки, указанная в поле Теги ошибок. Если вы ищете свойство, например или , ошибки в теле сообщения не влияют  `subject`  `participants` на результаты поиска. Это может быть полезно при точном определении того, какие элементы частично индексировать, возможно, потребуется дополнительно изучить.
  
## <a name="using-a-powershell-script-to-determine-your-organizations-exposure-to-partially-indexed-email-items"></a>Использование скрипта PowerShell для определения воздействия организации на частично индексные элементы электронной почты

В следующих действиях покажите, как запустить сценарий PowerShell, который ищет все элементы во всех почтовых ящиках Exchange, а затем создает отчет о соотношении частично индексных элементов электронной почты вашей организации (по количеству и размеру) и отображает количество элементов (и их тип файла) для каждой ошибки индексирования, которая возникает. Чтобы определить ошибку индексирования, используйте описания тегов ошибок в предыдущем разделе.
  
1. Сохраните следующий текст в Windows PowerShell скрипта с помощью суффикса .ps1; например, `PartiallyIndexedItems.ps1` .

   ```powershell
     write-host "**************************************************"
     write-host "     Security & Compliance Center      " -foregroundColor yellow -backgroundcolor darkgreen
     write-host "   eDiscovery Partially Indexed Item Statistics   " -foregroundColor yellow -backgroundcolor darkgreen
     write-host "**************************************************"
     " " 
     # Create a search with Error Tags Refinders enabled
     Remove-ComplianceSearch "RefinerTest" -Confirm:$false -ErrorAction 'SilentlyContinue'
     New-ComplianceSearch -Name "RefinerTest" -ContentMatchQuery "size>0" -RefinerNames ErrorTags -ExchangeLocation ALL
     Start-ComplianceSearch "RefinerTest"
     # Loop while search is in progress
     do{
         Write-host "Waiting for search to complete..."
         Start-Sleep -s 5
         $complianceSearch = Get-ComplianceSearch "RefinerTest"
     }while ($complianceSearch.Status -ne 'Completed')
     $refiners = $complianceSearch.Refiners | ConvertFrom-Json
     $errorTagProperties = $refiners.Entries | Get-Member -MemberType NoteProperty
     $partiallyIndexedRatio = $complianceSearch.UnindexedItems / $complianceSearch.Items
     $partiallyIndexedSizeRatio = $complianceSearch.UnindexedSize / $complianceSearch.Size
     " "
     "===== Partially indexed items ====="
     "         Total          Ratio"
     "Count    {0:N0}{1:P2}" -f $complianceSearch.Items.ToString("N0").PadRight(15, " "), $partiallyIndexedRatio
     "Size(GB) {0:N2}{1:P2}" -f ($complianceSearch.Size / 1GB).ToString("N2").PadRight(15, " "), $partiallyIndexedSizeRatio
     " "
     Write-Host ===== Reasons for partially indexed items =====
     foreach($errorTagProperty in $errorTagProperties)
     {
         $name = $refiners.Entries.($errorTagProperty.Name).Name
         $count = $refiners.Entries.($errorTagProperty.Name).TotalCount
         $frag = $name.Split("{_}")
         $errorTag = $frag[0]
         $fileType = $frag[1]
         if ($errorTag -ne $lastErrorTag)
         {
             $errorTag
         }
         "    " + $fileType + " => " + $count
         $lastErrorTag = $errorTag
     }
   ```

2. [Подключение к интерфейсу PowerShell Центра безопасности и соответствия требованиям](/powershell/exchange/exchange-online-powershell).

3. В центре & безопасности PowerShell перейдите в папку, в которой вы сохранили сценарий на шаге 1, а затем запустите сценарий; Например:

   ```powershell
   .\PartiallyIndexedItems.ps1
   ```

Вот пример вывода, возвращаемой сценарием.
  
![Пример вывода из скрипта, который создает отчет о воздействии организации на частично индексные элементы электронной почты](../media/aeab5943-c15d-431a-bdb2-82f135abc2f3.png)

> [!NOTE]
> Обратите внимание на следующее:
>  
> - Общее число и размер элементов электронной почты, а также отношение организации к частично индексным пунктам электронной почты (по количеству и по размеру).
> 
> - Теги ошибок списка и соответствующие типы файлов, для которых произошла ошибка.
  
## <a name="see-also"></a>См. также

[Частично индексация элементов в eDiscovery](partially-indexed-items-in-content-search.md)