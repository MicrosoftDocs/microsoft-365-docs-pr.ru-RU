---
title: Исследование частично индексных элементов в eDiscovery
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
audience: Admin
ms.topic: reference
ms.service: O365-seccomp
localization_priority: Normal
ms.collection: M365-security-compliance
search.appverid:
- MOE150
- MET150
ms.assetid: 4e8ff113-6361-41e2-915a-6338a7e2a1ed
ms.custom:
- seo-marvel-apr2020
description: Узнайте, как управлять частично индексными элементами (также называемыми неиндексациями) из Exchange, SharePoint и OneDrive для бизнеса в организации.
ms.openlocfilehash: 6a2a1d042c52a445538903fd7db9fc54305e6c13
ms.sourcegitcommit: 0a8b0186cc041db7341e57f375d0d010b7682b7d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "49655453"
---
# <a name="investigating-partially-indexed-items-in-ediscovery"></a>Исследование частично индексных элементов в eDiscovery

Поиск eDiscovery, который вы запустите из Центра соответствия требованиям Microsoft 365, автоматически включает частично индексные элементы в предполагаемые результаты поиска при выполнении поиска. Частично индексные элементы — это элементы почтового ящика Exchange и документы на сайтах SharePoint и OneDrive для бизнеса, которые по какой-то причине не были полностью индексироваться для поиска. Большинство сообщений электронной почты и документов сайта успешно индексироваться, так как они находятся в пределах индексации [для сообщений электронной почты.](limits-for-content-search.md#indexing-limits-for-email-messages) Однако некоторые элементы могут превысить эти ограничения индексации и будут частично индексироваться. Вот другие причины, по которым элементы не могут индексироваться для поиска и возвращаются в качестве частично индексных элементов при поиске при обнаружении электронных данными:
  
- Сообщения электронной почты имеют вложенный файл без допустимой обработки, например файлы изображений; Это наиболее распространенная причина частично индексации элементов электронной почты.

- В сообщение электронной почты вложено слишком много файлов.

- Размер файла, вложенного в сообщение электронной почты, превышает допустимый.

- Тип файла поддерживает индексирование, но произошла ошибка индексирования определенного файла.

Хотя они различаются, в большинстве организаций клиенты имеют менее 1 % контента по объему и менее 12 % контента по размеру, который частично индексировать. Разница между томом и размером заключается в том, что большие файлы с большей вероятностью содержат содержимое, которое не может быть полностью проиндексировать.
  
## <a name="why-does-the-partially-indexed-item-count-change-for-a-search"></a>Почему количество частично индексных элементов меняется для поиска?

После запуска поиска при обнаружении электронных данных общее число и размер частично индексированных элементов в расположениях, в которые был внесен поиск, перечислены в статистике результатов поиска, которая отображается в подробной статистике поиска. Обратите внимание, что они  *называются неndexed элементами*  в статистике поиска. Вот несколько вещей, которые влияют на количество частично индексных элементов, которые возвращаются в результатах поиска:
  
- Если элемент частично индексен и соответствует поисковому запросу, он включается как в число (и размер) элементов результатов поиска, так и в частично индексные элементы. Однако при экспорте результатов того же поиска элемент включается только в набор результатов поиска; он не включается в качестве частично индексного элемента.

- Если вы указываете диапазон дат для поискового запроса (включив его в запрос по ключевому слову или с помощью условия), то любой частично индексированный элемент, не совпадающий с диапазоном дат, не включается в число частично индексных элементов. Частично индексные элементы, которые находятся в пределах диапазона дат, включаются в число индексных элементов.

  > [!NOTE]
  > Частично индексированные элементы, расположенные на сайтах  SharePoint и OneDrive, не включаются в оценку частично индексированных элементов, отображаемую в подробной статистике поиска. Однако при экспорте результатов поиска eDiscovery можно экспортировать частично индексные элементы. Например, если поиск ведется только на сайтах, приблизительный номер частично индексных элементов будет нулем.
  
## <a name="calculating-the-ratio-of-partially-indexed-items-in-your-organization"></a>Вычисление соотношения частично индексных элементов в организации

Чтобы понять, как организация подвержена частично индексации элементов, можно выполнить поиск всего содержимого во всех почтовых ящиках (с помощью пустого запроса по ключевому слову). В следующем примере ниже 56 208 (4830 МБ) полностью индексных элементов и 470 (316 МБ) частично индексных элементов.
  
![Пример статистики поиска с частично индексными элементами](../media/0f6a5cf7-4c98-44a0-a0dd-5aed67124641.png)
  
Процент частично индексных элементов можно определить с помощью следующих вычислений.
  
 **Чтобы вычислить отношение частично индексных элементов в организации:**

`(Total number of partially indexed items/Total number of items) x 100`

`(470/56,208) x 100 = 0.84%`

С помощью результатов поиска из предыдущего примера 0,84 % всех элементов почтовых ящиков индексируется частично.
  
 **Чтобы вычислить процент от размера частично индексных элементов в организации:**

`(Size of all partially indexed items/Size of all items) x 100`

`(316 MB/4830 MB) x 100 = 6.54%`

Таким образом, в предыдущем примере 6,54 % от общего размера элементов почтового ящика из частично индексных элементов. Как было сказано ранее, в большинстве организаций клиенты имеют менее 1 % контента по объему и менее 12 % контента по размеру, который частично индексен.

## <a name="working-with-partially-indexed-items"></a>Работа с частично индексными элементами

В случаях, когда необходимо изучить частично элементы, чтобы проверить, что [](export-a-content-search-report.md) они не содержат релевантную информацию, можно экспортировать отчет о поиске контента, содержащий сведения о частично индексных элементов. При экспорте отчета о поиске контента выберите один из вариантов экспорта, который включает частично индексные элементы.
  
![Выбор второго или третьего варианта экспорта частично индексных элементов](../media/624a62b4-78f7-4329-ab5d-e62e3b369885.png)
  
При экспорте результатов поиска при обнаружении электронных данных или отчета о поиске с помощью одного из этих параметров экспорт включает отчет с именем Unindexed Items.csv. Этот отчет включает большую часть той же информации, что и ResultsLog.csv файла; Однако файл неиндексирования Items.csv также содержит два поля, связанных с частично индексными элементами: **теги** ошибок и свойства **ошибки.** Эти поля содержат сведения об ошибке индексирования для каждого частично индексирования элемента. Использование данных в этих двух полях поможет определить, влияет ли ошибка индексирования на конкретное исследование. В этом случае вы можете выполнить целевой поиск, а также получить и экспортировать определенные сообщения электронной почты, а также документы SharePoint или OneDrive, чтобы проверить их, чтобы определить, релевантны ли они для расследования. Пошаговая инструкция см. в подготовьте CSV-файл для целевого поиска [в Office 365.](csv-file-for-an-id-list-content-search.md)

> [!NOTE]
> Файл Неndexed Items.csv также содержит поля с именами **Error Type** и **Error Message.** Это устаревшие поля, содержащие информацию, аналогичную сведениям в полях **"Теги** ошибок" и "Свойства **ошибки",** но с менее подробными сведениями. Вы можете игнорировать эти устаревшие поля.
  
## <a name="errors-related-to-partially-indexed-items"></a>Ошибки, связанные с частично индексными элементами

Теги ошибок состоит из двух сведений: ошибки и типа файла. Например, в этой паре "ошибка/тип файла":

```text
 parseroutputsize_xls
```

 `parseroutputsize` — это ошибка и тип файла, в который `xls` произошла ошибка. В случаях, когда тип файла не был распознат или тип файла не применяется к ошибке, вы увидите значение, а не `noformat` тип файла.
  
Ниже приводится список ошибок индексирования и описание возможной причины ошибки.
  
| Тег ошибки | Описание |
|:-----|:-----|
| `attachmentcount` <br/> |Сообщение электронной почты было слишком много вложений, и некоторые из этих вложений не были обработаны.  <br/> |
| `attachmentdepth` <br/> |При извлечении контента и разберителе документов обнаружено слишком много уровней вложений, вложенных в другие вложения. Некоторые из этих вложений не были обработаны.  <br/> |
| `attachmentrms` <br/> |Сбой декодирования вложения, так как он был защищен с защитой RMS.  <br/> |
| `attachmentsize` <br/> |Файл, вложенный в сообщение электронной почты, слишком велик и не может быть обработан.  <br/> |
| `indexingtruncated` <br/> |При записи обработанного сообщения электронной почты в индекс одно из индексируемых свойств было слишком большим и было усечено. Усеченные свойства перечислены в поле "Свойства ошибки".  <br/> |
| `invalidunicode` <br/> |Сообщение электронной почты содержало текст, который не удалось обработать как допустимый код Юникод. Индексация для этого элемента может быть неполной.  <br/> |
| `parserencrypted` <br/> |Содержимое вложения или сообщения электронной почты зашифровано, и Microsoft 365 не удалось декодировать содержимое.  <br/> |
| `parsererror` <br/> |При разчете произошла неизвестная ошибка. Как правило, это является результатом ошибки программного обеспечения или сбоя службы.  <br/> |
| `parserinputsize` <br/> |Вложение было слишком большим, чтобы обработать его, а разбиение этого вложения не было выполнено или не было завершено.  <br/> |
| `parsermalformed` <br/> |Вложение было неправильно отформатированно и не может быть обработано с помощью разберегатель. Это может быть вызвано старыми форматами файлов, файлами, созданными несовместимым программным обеспечением, или вирусами, которые утверждают, что они не являются утверждениями.  <br/> |
| `parseroutputsize` <br/> |Выходные данные при разбиение вложения были слишком большими и были усечены.  <br/> |
| `parserunknowntype` <br/> |Вложение имеет тип файла, который не удалось обнаружить в Microsoft 365.  <br/> |
| `parserunsupportedtype` <br/> |Вложение имеет тип файла, который может обнаружить Office 365, но его разбиение не поддерживается.  <br/> |
| `propertytoobig` <br/> |Значение свойства электронной почты в Магазине Exchange было слишком большим, чтобы его можно было извлечь, и сообщение не удалось обработать. Обычно это происходит только со свойством body сообщения электронной почты.  <br/> |
| `retrieverrms` <br/> |Реизвлечения контента не удалось декодировать сообщение, защищенное RMS.  <br/> |
| `wordbreakertruncated` <br/> |Во время индексации в документе было обнаружено слишком много слов. Обработка свойства останавливается при достижении предела, а свойство усечено.  <br/> |

Поля ошибок описывают, на какие поля влияет ошибка обработки, указанная в поле "Теги ошибок". Если вы ищете такие свойства, как или , ошибки в тексте сообщения не повлияет на  `subject`  `participants` результаты поиска. Это может быть полезно при точном определении частично индексных элементов, которые могут потребоваться для дальнейшего изучения.
  
## <a name="using-a-powershell-script-to-determine-your-organizations-exposure-to-partially-indexed-email-items"></a>Использование сценария PowerShell для определения подверженности вашей организации частично индексным электронным письмам

Ниже покажите, как запустить сценарий PowerShell, который выполняет поиск всех элементов во всех почтовых ящиках Exchange, а затем создает отчет о соотношении частично индексных элементов электронной почты в организации (по количеству и размеру) и отображает количество элементов (и их тип файла) для каждой ошибки индексирования. Используйте описания тегов ошибок в предыдущем разделе, чтобы определить ошибку индексирования.
  
1. Сохраните следующий текст в Windows PowerShell сценария с помощью суффикса имени файла PS1; например, `PartiallyIndexedItems.ps1` .

   ```powershell
     write-host "**************************************************"
     write-host "     Security & Compliance Center      " -foregroundColor yellow -backgroundcolor darkgreen
     write-host "   eDiscovery Partially Indexed Item Statistics   " -foregroundColor yellow -backgroundcolor darkgreen
     write-host "**************************************************"
     " " 
     # Create a search with Error Tags Refinders enabled
     Remove-ComplianceSearch "RefinerTest" -Confirm:$false -ErrorAction 'SilentlyContinue'
     New-ComplianceSearch -Name "RefinerTest" -ContentMatchQuery "size>0" -RefinerNames ErrorTags -ExchangeLocation ALL
     Start-ComplianceSearch "RefinerTest"
     # Loop while search is in progress
     do{
         Write-host "Waiting for search to complete..."
         Start-Sleep -s 5
         $complianceSearch = Get-ComplianceSearch "RefinerTest"
     }while ($complianceSearch.Status -ne 'Completed')
     $refiners = $complianceSearch.Refiners | ConvertFrom-Json
     $errorTagProperties = $refiners.Entries | Get-Member -MemberType NoteProperty
     $partiallyIndexedRatio = $complianceSearch.UnindexedItems / $complianceSearch.Items
     $partiallyIndexedSizeRatio = $complianceSearch.UnindexedSize / $complianceSearch.Size
     " "
     "===== Partially indexed items ====="
     "         Total          Ratio"
     "Count    {0:N0}{1:P2}" -f $complianceSearch.Items.ToString("N0").PadRight(15, " "), $partiallyIndexedRatio
     "Size(GB) {0:N2}{1:P2}" -f ($complianceSearch.Size / 1GB).ToString("N2").PadRight(15, " "), $partiallyIndexedSizeRatio
     " "
     Write-Host ===== Reasons for partially indexed items =====
     foreach($errorTagProperty in $errorTagProperties)
     {
         $name = $refiners.Entries.($errorTagProperty.Name).Name
         $count = $refiners.Entries.($errorTagProperty.Name).TotalCount
         $frag = $name.Split("{_}")
         $errorTag = $frag[0]
         $fileType = $frag[1]
         if ($errorTag -ne $lastErrorTag)
         {
             $errorTag
         }
         "    " + $fileType + " => " + $count
         $lastErrorTag = $errorTag
     }
   ```

2. [Подключитесь к Центру безопасности и соответствия требованиям PowerShell](https://go.microsoft.com/fwlink/p/?linkid=627084).

3. В PowerShell & Центра безопасности и соответствия требованиям перейдите в папку, в которой вы сохранили сценарий на шаге 1, а затем запустите сценарий; Например:

   ```powershell
   .\PartiallyIndexedItems.ps1
   ```

Вот пример выходных данных, возвращаемой сценарием.
  
![Пример выходных данных сценария, который создает отчет о риске частичной индексации элементов электронной почты в организации](../media/aeab5943-c15d-431a-bdb2-82f135abc2f3.png)

> [!NOTE]
> Обратите внимание на следующее:
>  
> - Общее количество и размер элементов электронной почты, а также соотношение частично индексных элементов электронной почты в организации (в зависимости от количества и размера).
> 
> - Теги ошибок списка и соответствующие типы файлов, для которых произошла ошибка.
  
## <a name="see-also"></a>См. также

[Частично индексные элементы в eDiscovery](partially-indexed-items-in-content-search.md)
