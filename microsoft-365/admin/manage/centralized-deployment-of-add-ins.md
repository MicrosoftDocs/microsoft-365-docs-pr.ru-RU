---
title: Определите, работает ли централизованное развертывание надстройок для вашей организации
f1.keywords:
- NOCSH
ms.author: kwekua
author: kwekua
manager: scotv
audience: Admin
ms.topic: article
ms.service: o365-administration
localization_priority: Normal
ms.collection:
- M365-subscription-management
- Adm_O365
- Adm_TOC
ms.custom: AdminSurgePortfolio
search.appverid:
- BCS160
- MET150
- MOE150
ms.assetid: b4527d49-4073-4b43-8274-31b7a3166f92
description: Определите, соответствуют ли требованиям клиент и пользователи, чтобы можно было использовать централизованное развертывание для развертывания надстройок Office.
ms.openlocfilehash: 7eb15563ca11e8fcce17dc6b505347475d18641e
ms.sourcegitcommit: 22505ce322f68a2d0ce70d71caf3b0a657fa838a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2021
ms.locfileid: "51860695"
---
# <a name="determine-if-centralized-deployment-of-add-ins-works-for-your-organization"></a>Определите, работает ли централизованное развертывание надстройок для вашей организации

Централизованное развертывание — это рекомендуемый и наиболее насыщенный функцией способ для большинства клиентов развернуть надстройки Office для пользователей и групп в организации. Если вы администратор, используйте это руководство, чтобы определить, соответствуют ли организации и пользователям требования, чтобы можно было использовать централизованное развертывание.

Централизованное развертывание обеспечивает следующие преимущества:
  
- Глобальный администратор может назначить надстройки непосредственно пользователю, нескольким пользователям через группу или всем в организации.
    
- Когда соответствующее приложение Office запускается, надстройка автоматически загружается. Если надстройка поддерживает команды надстройки, надстройка автоматически появляется в ленте в приложении Office.
    
- Надстройки больше не отображаются для пользователей, если администратор выключает или удаляет надстройки, или если пользователь удален из Azure Active Directory или из группы, которую надстройка назначена.

Централизованное развертывание поддерживает три настольные платформы приложений Windows, Mac и Online Office. Централизованное развертывание также поддерживает iOS и Android (только надстройки Outlook Mobile).

Для показа надстройки для клиента для всех пользователей может занять до 24 часов.
  
## <a name="requirements"></a>Требования

Централизованное развертывание надстройок требует, чтобы пользователи использовали корпоративные СКУ Microsoft 365: E3/E5/F3 или бизнес-skUs: Business Basic, Business Standard, Business Premium (и подписывался в Office с помощью их организационного ID), а также имеют почтовые ящики Exchange Online и Active Exchange Online. Каталог подписки должен быть либо в Azure Active Directory, либо федерарно.
Ниже можно просмотреть конкретные требования к Office и Exchange или использовать централизованную проверку совместимости [развертывания.](#centralized-deployment-compatibility-checker)

Централизованное развертывание не поддерживает:
  
- надстройки, ориентированные на Word, Excel или PowerPoint в Office 2013; 
- локальную службу каталогов;
- Развертывание надстройки в почтовом ящике Exchange on-Prem
- развертывание надстроек для SharePoint;  
- Приложения teams
- Развертывание надстройок Component Object Model (COM) или Visual Studio Средства для Office (VSTO).
- Развертывание Microsoft 365, не включаемого в Exchange Online, например SKUs: Microsoft 365 Apps для бизнеса и Microsoft 365 Apps для предприятия.

### <a name="office-requirements"></a>Требования к Office

- Для надстройок Word, Excel и PowerPoint пользователи должны использовать одно из следующих:
  - На устройстве Windows версия 1704 или более поздней версии Microsoft 365 корпоративных СКУ: E3/E5/F3 или бизнес-skUs: Business Basic, Business Standard, Business Premium.
  - На Mac версии 15.34 или более поздней версии.

- Для Outlook пользователи должны использовать один из следующих ниже. 
  - Версия 1701 или более поздней версии корпоративных ССУ Microsoft 365: E3/E5/F3 или бизнес-СКУ: Бизнес Базовый, Бизнес Стандарт, Бизнес Премиум.
  - Версия 1808 или более поздней версии Office профессиональный плюс 2019 или Office Standard 2019.
  - Версия 16.0.4494.1000 или более поздней версии Office профессиональный плюс 2016 (MSI) или Office Standard 2016 (MSI)\*
  - Версия 15.0.4937.1000 или более поздней версии Office профессиональный плюс 2013 (MSI) или Office Standard 2013 (MSI)\*
  - Версия 16.0.9318.1000 или более поздней версии Office 2016 для Mac 
- Версия 2.75.0 или более поздней версии Outlook mobile для iOS 
- Версия 2.2.145 или более поздний мобильный Outlook для Android 
    
    *MSI-версии Outlook показывают надстройки, установленные администратором, в соответствующей ленте Outlook, а не в разделе "Мои надстройки".

### <a name="exchange-online-requirements"></a>Требования Exchange Online

Microsoft Exchange хранит манифесты надстройки в клиенте организации. Администратор, развертывающий надстройки, и пользователи, получающие эти надстройки, должны быть в версии Exchange Online, которая поддерживает проверку подлинности OAuth.
  
Чтобы узнать, какая конфигурация используется, обратитесь к администратору Exchange своей организации. Подключение OAuth можно проверить для каждого пользователя с помощью командлета PowerShell [Test-OAuthConnectivity](/powershell/module/exchange/test-oauthconnectivity). 


### <a name="centralized-deployment-compatibility-checker"></a>Централизованная проверка совместимости развертывания

С помощью централизованной проверки совместимости развертывания можно проверить, настроены ли пользователи клиента на использование централизованного развертывания для Word, Excel и PowerPoint. Средство проверки совместимости не требуется для поддержки Outlook. Скачайте средство проверки совместимости [здесь](https://aka.ms/officeaddindeploymentorgcompatibilitychecker).
  
#### <a name="run-the-compatibility-checker"></a>Запуск проверки совместимости
  
1. Запустите окно с повышенным PowerShell.exe.
    
2. Выполните следующую команду:

   ```powershell
   Import-Module O365CompatibilityChecker
   ```
    
3. Запустите **команду Invoke-CompatabilityCheck:**

   ```powershell
   Invoke-CompatibilityCheck
   ```
   Эта команда подсказывает вам  *_tenantDomain_* (например, *TailspinToysIncorporated.onmicrosoft. </span> com)* и  *_учетные данные TenantAdmin_* (используйте глобальные учетные данные администратора), а затем запрашивает согласие.
    
   > [!NOTE]
   > В зависимости от количества пользователей в клиенте средство завершит проверку в течение нескольких минут или часов. 
  
По завершении работы средство создаст выходной файл в формате с разделителями-запятыми (CSV). По умолчанию файл сохранен **в C:\windows\system32.** Выходной файл содержит такие сведения:
  
- имя пользователя;
    
- ИД пользователя (электронный адрес пользователя);
    
- подтверждение готовности к централизованному развертыванию, если остальные пункты содержат нужные сведения;
    
- План Office — план Office, для который они лицензированы
    
- подтверждение активации Office, если пользователь активировал пакет Office;
    
- сведения о том, что почтовый ящик поддерживается, если применяется почтовый ящик с поддержкой OAuth.

> [!NOTE]
> Многофакторная проверка подлинности не поддерживается при использовании модуля Central Deployment PowerShell.
  
## <a name="user-and-group-assignments"></a>Назначения для пользователей и групп

В настоящее время функция централизованного развертывания поддерживает большинство групп, поддерживаемых Azure Active Directory, включая группы Microsoft 365, списки рассылки и группы безопасности.
  
> [!NOTE]
> Сейчас группы безопасности без электронной почты не поддерживаются. 
  
Централизованное развертывание поддерживает назначения отдельным пользователям, группам и всем пользователям в клиенте. Централизованное развертывание поддерживает пользователей в группах верхнего уровня или группах без родительских групп, но не пользователей в вложенных группах или группах с родительскими группами.
   
Просмотрите пример ниже, в котором надстройка назначается Регине, Ольге и группе Sales Department. Так как группа West Coast Sales является вложенной, надстройка не назначается Николаю и Максиму.
  
![Схема отдела продаж](../../media/683094bb-1160-4cce-810d-26ef7264c592.png)

   
### <a name="find-out-if-a-group-contains-nested-groups"></a>Проверка наличия вложенных групп в группе

Самый простой способ проверить, содержит ли группа вложенные группы,  посмотреть ее карточку контакта в Outlook. Если вы введите имя группы в поле **To** электронной почты, а затем выберите имя группы, когда оно разрешится, оно покажет, содержит ли оно пользователей или вложенные группы. В примере ниже на вкладке **Участники** карточки контакта Outlook видно, что в группе Test Group нет пользователей и есть две подгруппы. 
  
![Вкладка участников контактной карты Outlook](../../media/d9db88c4-d752-426c-a480-b11a5b3adcd6.png)
  
Подключив группу, вы также можете выполнить обратную проверку и узнать, входит ли она в состав другой. В примере ниже на вкладке **Членство** карточки контакта Outlook видно, что группа Sub Group 1 входит в группу Test Group. 
  
![Вкладка членство контактной карты Outlook](../../media/a9f9b6ab-9c19-4822-9e3d-414ca068c42f.png)
  
Кроме того, вы можете выполнять запросы и находить списки групп, входящих в состав определенной группы, с помощью API Graph Azure Active Directory. Дополнительные сведения см. в статье [Действия с группами | Справка по API Graph](/previous-versions/azure/ad/graph/api/groups-operations).
  
### <a name="contacting-microsoft-for-support"></a>Обращение в службу поддержки Майкрософт

Если у вас или ваших пользователей возникают проблемы с загрузкой надстройки при использовании приложений Office для интернета (Word,[](../contact-support-for-business-products.md)Excel и т.д.), которые были развернуты централизованно, вам может потребоваться обратиться в службу поддержки Майкрософт (узнайте, как). В билете поддержки укайте следующие сведения об среде Microsoft 365.
  
|**Платформа**|**Данные отладки**|
|:-----|:-----|
|Office  <br/> | Журналы Charles/Fiddler  <br/>  Идентификатор клиента ( [инструкции по его определению](https://docs.microsoft.com/onedrive/find-your-office-365-tenant-id))  <br/>  CorrelationID. Просмотреть источник одной из страниц office и найти значение Correlation ID и отправить его в поддержку:  <br/>`<input name=" **wdCorrelationId**" type="hidden" value=" **{BC17079E-505F-3000-C177-26A8E27EB623}**">`  <br/>  `<input name="user_id" type="hidden" value="1003bffd96933623"></form>`  <br/> |
|Классические клиенты (Windows, Mac)  <br/> | Журналы Charles/Fiddler  <br/>  Сборка номеров клиентского приложения (желательно в качестве скриншота из **File/Account)**  <br/> |
