---
title: Определите, работает ли централизованное развертывание надстройок для вашей организации
f1.keywords:
- NOCSH
ms.author: kwekua
author: kwekua
manager: scotv
audience: Admin
ms.topic: article
ms.service: o365-administration
localization_priority: Normal
ms.collection:
- M365-subscription-management
- Adm_O365
- Adm_TOC
ms.custom: AdminSurgePortfolio
search.appverid:
- BCS160
- MET150
- MOE150
ms.assetid: b4527d49-4073-4b43-8274-31b7a3166f92
description: Определите, соответствуют ли требованиям клиент и пользователи, чтобы можно было использовать централизованное развертывание для развертывания Office надстройки.
ms.openlocfilehash: 5d6f225acb56d1ec092046297d708444bb8d93d2
ms.sourcegitcommit: 48195345b21b409b175d68acdc25d9f2fc4fc5f1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/30/2021
ms.locfileid: "53227960"
---
# <a name="determine-if-centralized-deployment-of-add-ins-works-for-your-organization"></a>Определите, работает ли централизованное развертывание надстройок для вашей организации

Централизованное развертывание — это рекомендуемый и наиболее насыщенный функцией способ для большинства клиентов развертывать надстройки Office пользователям и группам в вашей организации. Если вы администратор, используйте это руководство, чтобы определить, соответствуют ли организации и пользователям требования, чтобы можно было использовать централизованное развертывание.

Централизованное развертывание обеспечивает следующие преимущества:

- Глобальный администратор может назначить надстройки непосредственно пользователю, нескольким пользователям через группу или всем в организации.

- Когда соответствующее приложение Office, надстройка автоматически загружается. Если надстройка поддерживает команды надстройки, надстройка автоматически появляется в ленте в Office приложении.

- Надстройки больше не отображаются для пользователей, если администратор отключит или удаляет надстройки, или если пользователь удален из Azure Active Directory или из группы, которую надстройка назначена.

Централизованное развертывание поддерживает три настольные платформы Windows, Mac и Online Office приложения. Централизованное развертывание также поддерживает iOS и Android (Outlook только мобильные надстройки).

Для показа надстройки для клиента для всех пользователей может занять до 24 часов.

## <a name="before-you-begin"></a>Прежде чем начать

Централизованное развертывание надстройок требует, чтобы пользователи использовали Microsoft 365 корпоративный skUs: E3/E5/F3 или бизнес-skUs: Business Basic, Business Standard, Business Premium (и подписывался в Office с помощью их организационного ID), а также Exchange Online и активных Exchange Online почтовых ящиков. Каталог подписки должен быть либо в каталоге, либо в федерате, чтобы Azure Active Directory.
Вы можете просмотреть конкретные требования для Office и Exchange ниже или использовать централизованную проверку совместимости [развертывания.](#centralized-deployment-compatibility-checker)

Централизованное развертывание не поддерживает:

- надстройки, ориентированные на Word, Excel или PowerPoint в Office 2013;
- локальную службу каталогов;
- Развертывание надстройки в Exchange почтового ящика on-Prem
- развертывание надстроек для SharePoint;
- Teams приложения
- Развертывание компонентной объектной модели (COM) или набор средств Visual Studio для Office (VSTO) надстройки.
- Развертывание Microsoft 365, которые не включают Exchange Online, такие как SKUs: Приложения Microsoft 365 для бизнеса и Приложения Microsoft 365 для Enterprise.

### <a name="office-requirements"></a>Office Требования

- Для word, Excel и PowerPoint надстройки пользователи должны использовать одно из следующих:
  - На устройстве Windows версии 1704 или более поздней версии Microsoft 365 корпоративный skUs: E3/E5/F3 или бизнес-skUs: Business Basic, Business Standard, Business Premium.
  - На Mac версии 15.34 или более поздней версии.

- Для Outlook пользователи должны использовать один из следующих ниже.
  - Версия 1701 или более поздний Microsoft 365 корпоративный skUs: E3/E5/F3 или бизнес-skUs: Business Basic, Business Standard, Business Premium.
  - Версия 1808 или более поздней версии Office профессиональный плюс 2019 или Office стандартный 2019.
  - Версия 16.0.4494.1000 или более поздней версии Office профессиональный плюс 2016 (MSI) или Office стандартный 2016 (MSI)\*
  - Версия 15.0.4937.1000 или более поздней версии Office профессиональный плюс 2013 (MSI) или Office стандартный 2013 (MSI)\*
  - Версия 16.0.9318.1000 или более поздней версии Office 2016 для Mac
- Версия 2.75.0 или более поздней версии Outlook для iOS
- Версия 2.2.145 или более поздней версии Outlook для Android

    *MSI-версии Outlook показывают надстройки, установленные администратором, в соответствующей ленте Outlook, а не в разделе "Мои надстройки".

### <a name="exchange-online-requirements"></a>Exchange Online требования

Microsoft Exchange хранит манифесты надстройки в клиенте организации. Администратор, развертывающий надстройки, и пользователи, получающие эти надстройки, должны быть в версии Exchange Online, которая поддерживает проверку подлинности OAuth.

Чтобы узнать, какая конфигурация используется, обратитесь к администратору Exchange своей организации. Подключение OAuth можно проверить для каждого пользователя с помощью командлета PowerShell [Test-OAuthConnectivity](/powershell/module/exchange/test-oauthconnectivity).


### <a name="centralized-deployment-compatibility-checker"></a>Централизованная проверка совместимости развертывания

С помощью централизованной проверки совместимости развертывания можно проверить, настроены ли пользователи клиента на использование централизованного развертывания для word, Excel и PowerPoint. Средство проверки совместимости не требуется для поддержки Outlook. Скачать [проверку совместимости](https://aka.ms/officeaddindeploymentorgcompatibilitychecker).

#### <a name="run-the-compatibility-checker"></a>Запуск проверки совместимости

1. Запустите окно с повышенным PowerShell.exe.

2. Выполните следующую команду:

   ```powershell
   Import-Module O365CompatibilityChecker
   ```

3. Запустите **команду Invoke-CompatabilityCheck:**

   ```powershell
   Invoke-CompatibilityCheck
   ```
   Эта команда подсказывает вам  *_tenantDomain_* (например, *TailspinToysIncorporated.onmicrosoft. </span> com)* и  *_учетные данные TenantAdmin_* (используйте глобальные учетные данные администратора), а затем запрашивает согласие.

   > [!NOTE]
   > В зависимости от количества пользователей в клиенте средство завершит проверку в течение нескольких минут или часов.

По завершении работы средство создаст выходной файл в формате с разделителями-запятыми (CSV). По умолчанию файл сохранен **в C:\windows\system32.** Выходной файл содержит такие сведения:

- имя пользователя;

- ИД пользователя (электронный адрес пользователя);

- подтверждение готовности к централизованному развертыванию, если остальные пункты содержат нужные сведения;

- Office плана — план Office лицензирован для

- подтверждение активации Office, если пользователь активировал пакет Office;

- сведения о том, что почтовый ящик поддерживается, если применяется почтовый ящик с поддержкой OAuth.

> [!NOTE]
> Многофакторная проверка подлинности не поддерживается при использовании модуля Central Deployment PowerShell. Модуль работает только с базовой проверкой подлинности.

## <a name="user-and-group-assignments"></a>Назначения для пользователей и групп

В настоящее время функция централизованного развертывания поддерживает большинство групп, поддерживаемых Azure Active Directory, включая группы Microsoft 365, списки рассылки и группы безопасности.

> [!NOTE]
> Сейчас группы безопасности без электронной почты не поддерживаются.

Централизованное развертывание поддерживает назначения отдельным пользователям, группам и всем пользователям в клиенте. Централизованное развертывание поддерживает пользователей в группах верхнего уровня или группах без родительских групп, но не пользователей в вложенных группах или группах с родительскими группами.

Просмотрите пример ниже, в котором надстройка назначается Регине, Ольге и группе Sales Department. Так как группа West Coast Sales является вложенной, надстройка не назначается Николаю и Максиму.

![Схема отдела продаж](../../media/683094bb-1160-4cce-810d-26ef7264c592.png)


### <a name="find-out-if-a-group-contains-nested-groups"></a>Проверка наличия вложенных групп в группе

Самый простой способ проверить, содержит ли группа вложенные группы,  посмотреть ее карточку контакта в Outlook. Если вы введите имя группы в поле **To** электронной почты, а затем выберите имя группы, когда оно разрешится, оно покажет, содержит ли оно пользователей или вложенные группы. В примере ниже на вкладке **Участники** карточки контакта Outlook видно, что в группе Test Group нет пользователей и есть две подгруппы.

![Вкладка участников Outlook контактной карточки](../../media/d9db88c4-d752-426c-a480-b11a5b3adcd6.png)

Подключив группу, вы также можете выполнить обратную проверку и узнать, входит ли она в состав другой. В примере ниже на вкладке **Членство** карточки контакта Outlook видно, что группа Sub Group 1 входит в группу Test Group.

![Вкладка членство Outlook контактной карточки](../../media/a9f9b6ab-9c19-4822-9e3d-414ca068c42f.png)

Кроме того, вы можете выполнять запросы и находить списки групп, входящих в состав определенной группы, с помощью API Graph Azure Active Directory. Дополнительные сведения см. в статье [Действия с группами | Справка по API Graph](/previous-versions/azure/ad/graph/api/groups-operations).

### <a name="contacting-microsoft-for-support"></a>Обращение в службу поддержки Майкрософт

Если у вас или ваших пользователей возникают проблемы с загрузкой надстройки при использовании Office приложений для Интернета (Word, Excel и т.д.), которые были развернуты централизованно, вам может потребоваться обратиться в службу поддержки Майкрософт[(узнайте,](../../business-video/get-help-support.md)как). Укайте следующую информацию о Microsoft 365 среде в билете поддержки.

|**Платформа**|**Данные отладки**|
|:-----|:-----|
|Кабинет  <br/> | Журналы Charles/Fiddler  <br/>  ID клиента[(узнайте, как)](/onedrive/find-your-office-365-tenant-id)  <br/>  CorrelationID. Просмотреть источник одной из страниц office и найти значение Correlation ID и отправить его в поддержку:  <br/>`<input name=" **wdCorrelationId**" type="hidden" value=" **{BC17079E-505F-3000-C177-26A8E27EB623}**">`  <br/>  `<input name="user_id" type="hidden" value="1003bffd96933623"></form>`  <br/> |
|Классические клиенты (Windows, Mac)  <br/> | Журналы Charles/Fiddler  <br/>  Сборка номеров клиентского приложения (желательно в качестве скриншота из **File/Account)**  <br/> |

## <a name="related-content"></a>См. также:

[Развертывание надстройок в центре администрирования](../manage/manage-deployment-of-add-ins.md) (статья)\
[Управление надстройкими в центре администрирования](manage-addins-in-the-admin-center.md) (статья)\
[Централизованный faQ](../manage/centralized-deployment-faq.md) развертывания (статья)\
[Обновление Microsoft 365 для бизнес-пользователей](../setup/upgrade-users-to-latest-office-client.md) до Office клиента (статья)
 